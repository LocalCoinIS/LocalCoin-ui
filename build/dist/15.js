(window.webpackJsonp=window.webpackJsonp||[]).push([[15,34],{102:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(490),o=a.n(s),i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={animateEnter:!1},e.timer=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),i(t,[{key:"componentDidMount",value:function(){this.enableAnimation()}},{key:"resetAnimation",value:function(){this.setState({animateEnter:!1}),this.enableAnimation()}},{key:"enableAnimation",value:function(){var e=this;this.timer=setTimeout(function(){e.timer&&e.setState({animateEnter:!0})},2e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){return this.props.children?r.a.createElement(o.a,{className:this.props.className,component:this.props.component,transitionName:this.props.transitionName,transitionEnterTimeout:this.props.enterTimeout,transitionEnter:this.state.animateEnter,transitionLeave:!1},this.props.children):r.a.createElement(this.props.component)}}]),t}();l.defaultProps={component:"span",enterTimeout:2e3},t.a=l},115:function(e,t,a){"use strict";var n=a(73),r=a(6),s=a.n(r),o=a(24),i=a(123),l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.assets=s.a.Map(),e.asset_symbol_to_id={},e.searchTerms={},e.lookupResults=[],e.assetsLoading=!1,e.bindListeners({onGetAssetList:i.a.getAssetList,onLookupAsset:i.a.lookupAsset}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n["a"]),l(t,[{key:"onGetAssetList",value:function(e){var t=this;if(!e)return!1;this.assetsLoading=e.loading,e.assets&&e.assets.forEach(function(a){for(var n=0;n<e.dynamic.length;n++)if(e.dynamic[n].id===a.dynamic_asset_data_id){a.dynamic=e.dynamic[n];break}if(a.bitasset_data_id){a.market_asset=!0;for(n=0;n<e.bitasset_data.length;n++)if(e.bitasset_data[n].id===a.bitasset_data_id){a.bitasset_data=e.bitasset_data[n];break}}else a.market_asset=!1;t.assets=t.assets.set(a.id,a),t.asset_symbol_to_id[a.symbol]=a.id})}},{key:"onLookupAsset",value:function(e){this.searchTerms[e.searchID]=e.symbol,this.lookupResults=e.assets}}]),t}();t.a=o.a.createStore(c,"AssetStore")},123:function(e,t,a){"use strict";var n=a(24),r=a(19),s=a(5),o=a(96),i=a(143),l=a(13),c=a(4),u=a(179),p=a.n(u),m=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var d={},h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return m(e,[{key:"fundPool",value:function(e,t,a,n){var r=o.a.new_transaction(),i=s.a.get_asset_precision(t.get("precision"));return r.add_type_operation("asset_fund_fee_pool",{fee:{amount:0,asset_id:"1.3.0"},from_account:e,asset_id:a.get("id"),amount:n*i}),function(e){return l.a.process_transaction(r,null,!0).then(function(){e(!0)}).catch(function(t){console.log("[AssetActions.js:150] ----- fundPool error -----\x3e",t),e(!1)})}}},{key:"updateFeedProducers",value:function(e,t,a){var n=o.a.new_transaction();return n.add_type_operation("asset_update_feed_producers",{fee:{amount:0,asset_id:"1.3.0"},issuer:e,asset_to_update:t.get("id"),new_feed_producers:a}),function(e){return l.a.process_transaction(n,null,!0).then(function(){e(!0)}).catch(function(t){console.log("[AssetActions.js:150] ----- updateFeedProducers error -----\x3e",t),e(!1)})}}},{key:"claimPoolFees",value:function(e,t,a){var n=o.a.new_transaction(),r=s.a.get_asset_precision(t.get("precision"));return n.add_type_operation("asset_claim_fees",{fee:{amount:0,asset_id:0},issuer:e,amount_to_claim:{asset_id:t.get("id"),amount:a*r}}),function(e){return l.a.process_transaction(n,null,!0).then(function(t){e(!0)}).catch(function(t){console.log("[AssetActions.js:150] ----- claimFees error -----\x3e",t),e(!1)})}}},{key:"createAsset",value:function(e,t,a,n,r,i,u,m,d){console.log("create asset:",t,"flags:",a,"isBitAsset:",i,"bitasset_opts:",m);var h=o.a.new_transaction(),f=s.a.get_asset_precision(t.precision);p.a.config({DECIMAL_PLACES:t.precision});var b=new p.a(t.max_supply).times(f).toString(),g=new p.a(t.max_market_fee||0).times(f).toString(),_=s.a.get_asset_precision(c.b.getAsset(r.base.asset_id).get("precision")),y={fee:{amount:0,asset_id:0},issuer:e,symbol:t.symbol,precision:parseInt(t.precision,10),common_options:{max_supply:b,market_fee_percent:100*t.market_fee_percent||0,max_market_fee:g,issuer_permissions:n,flags:a,core_exchange_rate:{base:{amount:r.base.amount*_,asset_id:r.base.asset_id},quote:{amount:r.quote.amount*f,asset_id:"1.3.1"}},whitelist_authorities:[],blacklist_authorities:[],whitelist_markets:[],blacklist_markets:[],description:d,extensions:null},is_prediction_market:u,extensions:null};return i&&(y.bitasset_opts=m),h.add_type_operation("asset_create",y),function(e){return l.a.process_transaction(h,null,!0).then(function(t){e(!0)}).catch(function(t){console.log("[AssetActions.js:150] ----- createAsset error -----\x3e",t),e(!1)})}}},{key:"updateAsset",value:function(e,t,a,n,r,i,u,m,d,h,f,b,g,_,y){var v=o.a.new_transaction();if(y){var k=s.a.get_asset_precision(r.get("precision"));p.a.config({DECIMAL_PLACES:r.get("precision")});var E=new p.a(a.max_supply).times(k).toString(),w=new p.a(a.max_market_fee||0).times(k).toString(),C=c.b.getAsset(n.quote.asset_id),S=s.a.get_asset_precision(C.get("precision")),x=c.b.getAsset(n.base.asset_id),A=s.a.get_asset_precision(x.get("precision")),O=new p.a(n.quote.amount).times(S).toString(),N=new p.a(n.base.amount).times(A).toString();console.log("auths:",b);var P={fee:{amount:0,asset_id:0},asset_to_update:r.get("id"),extensions:r.get("extensions"),issuer:e,new_issuer:t,new_options:{max_supply:E,max_market_fee:w,market_fee_percent:100*a.market_fee_percent,description:f,issuer_permissions:u,flags:i,whitelist_authorities:b.whitelist_authorities.toJS(),blacklist_authorities:b.blacklist_authorities.toJS(),whitelist_markets:b.whitelist_markets.toJS(),blacklist_markets:b.blacklist_markets.toJS(),extensions:r.getIn(["options","extensions"]),core_exchange_rate:{quote:{amount:O,asset_id:n.quote.asset_id},base:{amount:N,asset_id:n.base.asset_id}}}};e!==t&&t||delete P.new_issuer,v.add_type_operation("asset_update",P)}if(console.log("bitasset_opts:",d,"original_bitasset_opts:",h),m&&(d.feed_lifetime_sec!==h.feed_lifetime_sec||d.minimum_feeds!==h.minimum_feeds||d.force_settlement_delay_sec!==h.force_settlement_delay_sec||d.force_settlement_offset_percent!==h.force_settlement_offset_percent||d.maximum_force_settlement_volume!==h.maximum_force_settlement_volume||d.short_backing_asset!==h.short_backing_asset)){var T={fee:{amount:0,asset_id:0},asset_to_update:r.get("id"),issuer:e,new_options:d};v.add_type_operation("asset_update_bitasset",T)}return console.log("feedProducers:",g,"originalFeedProducers:",_),m&&!s.a.are_equal_shallow(g,_)&&v.add_type_operation("asset_update_feed_producers",{fee:{amount:0,asset_id:"1.3.0"},issuer:e,asset_to_update:r.get("id"),new_feed_producers:g}),l.a.process_transaction(v,null,!0).then(function(e){return!0}).catch(function(e){return console.log("[AssetActions.js:150] ----- updateAsset error -----\x3e",e),!1})}},{key:"issueAsset",value:function(e,t,a,n,r){i.a.issue_asset(e,t,a,n,r)}},{key:"getAssetList",value:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=e+"_"+t;return function(o){if(!d[s]){var i;if(d[s]=!0,o({loading:!0}),i=r.Apis.instance().db_api().exec("list_assets",[e,t]).then(function(e){var t=[],a=[];e.forEach(function(e){c.b._updateObject(e,!1),a.push(e.dynamic_asset_data_id),e.bitasset_data_id&&t.push(e.bitasset_data_id)});var n=r.Apis.instance().db_api().exec("get_objects",[a]),i=t.length>0?r.Apis.instance().db_api().exec("get_objects",[t]):null;Promise.all([n,i]).then(function(t){return delete d[s],o({assets:e,dynamic:t[0],bitasset_data:t[1],loading:!1}),e&&e.length})}).catch(function(e){console.log("Error in AssetActions.getAssetList: ",e),o({loading:!1}),delete d[s]}),n){["BRIDGE","GDEX","RUDEX","OPEN","WIN"].forEach(function(t){a.getAssetList(t+"."+e,10)})}return i}}}},{key:"lookupAsset",value:function(e,t){var a=c.b.getAsset(e);return a?{assets:[a],searchID:t,symbol:e}:function(a){setTimeout(function(){var n=c.b.getAsset(e);n&&a({assets:[n],searchID:t,symbol:e})},200)}}},{key:"reserveAsset",value:function(e,t,a){var n=o.a.new_transaction();return n.add_type_operation("asset_reserve",{fee:{amount:0,asset_id:0},amount_to_reserve:{amount:e,asset_id:t},payer:a,extensions:[]}),l.a.process_transaction(n,null,!0).then(function(e){return!0}).catch(function(e){return console.log("[AssetActions.js:150] ----- reserveAsset error -----\x3e",e),!1})}}]),e}();t.a=n.a.createActions(h)},273:function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(0),r=a.n(n),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){function t(){return i(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,r.a.Component),o(t,[{key:"onPaste",value:function(e){var t=e.clipboardData.getData("text"),a=t.match(/\./g);(a?a.length:0)>1&&e.preventDefault(),parseFloat(t)!=t&&e.preventDefault()}},{key:"onKeyPress",value:function(e){if(!e.nativeEvent.ctrlKey){"."===e.key&&""===e.target.value&&(e.target.value="0");var t=e.target.value+e.key,a=t.match(/\./g),n=a?a.length:0;"."===e.key&&n>1&&e.preventDefault(),parseFloat(t)!=t&&e.preventDefault(),this.props.onKeyPress&&this.props.onKeyPress(e)}}}]),t}(),p=function(e){function t(){return i(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return c(t,u),o(t,[{key:"componentWillReceiveProps",value:function(e){this.props.value&&!e.value&&(this.refs.input.value="")}},{key:"render",value:function(){return r.a.createElement("input",s({ref:"input",type:"text"},this.props,{onPaste:this.onPaste.bind(this),onKeyPress:this.onKeyPress.bind(this)}))}}]),t}();t.b=p},312:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(10),o=a(15),i=a(9),l=a(1),c=a.n(l),u=a(44),p=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),p(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"page-404"},r.a.createElement("div",{className:"page-404-container"},r.a.createElement("div",{className:"page-404-logo"},r.a.createElement("img",{src:u.logoLight,height:"50px",width:"50px",alt:"Logo"})),r.a.createElement("div",{className:"page-404-title"},r.a.createElement(c.a,{content:"page404.page_not_found_title"})),r.a.createElement("div",{className:"page-404-subtitle"},r.a.createElement(c.a,{content:"page404."+this.props.subtitle})),r.a.createElement("div",{className:"page-404-button-back"},r.a.createElement(s.b,{to:"/"},r.a.createElement(c.a,{component:"button",className:"btn large inverted flat",content:"page404.home"})))))}}]),t}();m.defaultProps={subtitle:"page_not_found_subtitle"},t.default=m=Object(o.connect)(m,{listenTo:function(){return[i.a]},getProps:function(){return{theme:i.a.getState().settings.get("themes")}}})},313:function(e,t,a){"use strict";a.d(t,"a",function(){return A});var n=a(0),r=a.n(n),s=a(18),o=a(11),i=a(17),l=a(65),c=a(5),u=a(15),p=a(35),m=a(1),d=a.n(m),h=a(3),f=a.n(h),b=a(47),g=a.n(b),_=a(369),y=a(45),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},k=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function E(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var x=function(e){function t(e){return w(this,t),C(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return S(t,_["a"]),k(t,[{key:"componentDidMount",value:function(){g.a.rebuild()}},{key:"shouldComponentUpdate",value:function(e){return function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,a,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"shouldComponentUpdate",this).call(this,e)||!c.a.are_equal_shallow(e.pulsate,this.props.pulsate)||e.toAsset!==this.props.toAsset||e.fromAsset!==this.props.fromAsset||e.amount!==this.props.amount}},{key:"getValue",value:function(){var e=this.props,t=e.amount,a=e.toAsset,n=e.fromAsset,r=e.fullPrecision,s=e.marketStats,o=e.coreAsset;return y.a.convertValue(t,a,n,s,o,r)}},{key:"render",value:function(){var e=this.props,t=e.amount,a=e.toAsset,n=e.fromAsset,o=e.fullPrecision,i=E(e,["amount","toAsset","fromAsset","fullPrecision"]),l=a.get("id"),u=a.get("symbol");o||(t=c.a.get_asset_amount(t,n));var p=this.getValue();return p||0===p?r.a.createElement(s.a,v({noPrefix:!0,amount:p,asset:l,decimalOffset:-1!==u.indexOf("BTC")?4:this.props.fullDecimals?0:this.props.noDecimals?a.get("precision"):a.get("precision")-2},i)):r.a.createElement("div",{className:"tooltip inline-block","data-place":"bottom","data-tip":f.a.translate("tooltip.no_price"),style:{fontSize:"0.9rem"}},r.a.createElement(d.a,{content:"account.no_price"}))}}]),t}();x.defaultProps={fullPrecision:!0,noDecimals:!1,fullDecimals:!1,hide_asset:!1},x=Object(l.a)(x,{propNames:["toAsset","fromAsset","coreAsset"],defaultProps:{toAsset:"1.3.0",coreAsset:"1.3.0"}});var A=function(e){function t(){return w(this,t),C(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,r.a.Component),k(t,[{key:"render",value:function(){var e=this.props,t=e.refCallback,a=E(e,["refCallback"]);return r.a.createElement(x,v({},a,{ref:t}))}}]),t}();A=Object(u.connect)(A,{listenTo:function(){return[p.a]},getProps:function(){return{marketStats:p.a.getState().allMarketStats}}});var O=function(e){function t(){return w(this,t),C(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,r.a.Component),k(t,[{key:"render",value:function(){var e=this.props,t=e.balance,a=E(e,["balance"]),n=!!t.getIn(["balance","amount"]),s=Number(n?t.getIn(["balance","amount"]):t.get("balance")),o=n?t.getIn(["balance","asset_id"]):t.get("asset_type");return isNaN(s)?r.a.createElement("span",null,"--"):r.a.createElement(A,v({amount:s,fromAsset:o,noDecimals:!0},a))}}]),t}();O.propTypes={balance:o.a.ChainObject.isRequired},O=Object(i.a)(O,{keep_updating:!0})},339:function(e,t,a){"use strict";var n=a(89),r=a(0),s=a.n(r),o=a(6),i=a.n(o),l=a(53),c=a.n(l),u=a(5),p=a(1),m=a.n(p),d=a(31),h=a(15),f=a(18),b=a(65),g=a(11),_=a(17),y=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.a.Component),y(t,[{key:"render",value:function(){return this.props.account?s.a.createElement("span",null,this.props.account.get("name")):null}}]),t}();v.propTypes={account:g.a.ChainObject.isRequired},v.defaultProps={autosubscribe:!1};var k=Object(_.a)(v),E=a(14),w=a(32),C=a(7),S=a(2),x=a.n(S),A=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var O=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.statsInterval=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.a.Component),A(t,[{key:"_onClick",value:function(e){"/market/"+e!==this.context.router.location.pathname&&(w.a.switchMarket(),this.context.router.push("/market/"+e))}},{key:"componentDidMount",value:function(){w.a.getMarketStats(this.props.base,this.props.quote),this.statsChecked=new Date,this.statsInterval=setInterval(w.a.getMarketStats.bind(this,this.props.base,this.props.quote),35e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.statsInterval)}},{key:"shouldComponentUpdate",value:function(e){return!u.a.are_equal_shallow(e,this.props)}},{key:"_onStar",value:function(e,t,a){a.preventDefault(),this.props.starred?C.a.removeStarMarket(e,t):C.a.addStarMarket(e,t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.quote,n=t.base,r=(t.noSymbols,t.stats),o=t.starred;if(!a||!n)return null;var i=a.get("symbol")+"_"+n.get("symbol"),l=a.get("symbol")+"/"+n.get("symbol"),c=this.props.getDynamicObject(a.get("dynamic_asset_data_id")),p=this.props.getDynamicObject(n.get("dynamic_asset_data_id")),m=u.a.convertPrice(a,n),d={};this.props.leftAlign&&(d.textAlign="left");var h="button outline",b=null;this.props.compact&&(h+=" no-margin",b={marginBottom:0,fontSize:"0.75rem",padding:"4px 10px",borderRadius:"0px",letterSpacing:"0.05rem"});var g=this.props.columns.map(function(t){switch(t.name){case"star":var d=o?"gold-star":"grey-star";return s.a.createElement("td",{onClick:e._onStar.bind(e,a.get("symbol"),n.get("symbol")),key:t.index},s.a.createElement(E.a,{className:d,name:"fi-star",title:"icons.fi_star.symbol"}));case"vol":var g=r?r.volumeBase:0;return s.a.createElement("td",{onClick:e._onClick.bind(e,i),className:"text-right",key:t.index},u.a.format_volume(g));case"change":var _=u.a.format_number(r&&r.change?r.change:0,2),y="0.00"===_?"":_>0?"change-up":"change-down";return s.a.createElement("td",{onClick:e._onClick.bind(e,i),className:"text-right "+y,key:t.index},_+"%");case"marketName":return s.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},s.a.createElement("div",{className:h,style:b},l));case"market":var v=e.props.name;try{void 0!==v.props&&(v=v.props.children[0].props.name+"/"+v.props.children[2].props.name)}catch(e){}return s.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},v);case"price":var w=r&&r.price?r.price.toReal():r&&r.close&&r.close.quote.amount&&r.close.base.amount?u.a.get_asset_price(r.close.quote.amount,a,r.close.base.amount,n,!0):u.a.get_asset_price(m.quote.amount,a,m.base.amount,n,!0),C=6;return-1!==["BTC","OPEN.BTC","TRADE.BTC","GOLD","SILVER"].indexOf(n.get("symbol"))&&(C=8),s.a.createElement("td",{onClick:e._onClick.bind(e,i),className:"text-right",key:t.index},u.a.format_number(w,w>1e3?0:w>10?2:C));case"quoteSupply":return s.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},c?s.a.createElement(f.a,{style:{fontWeight:"bold"},amount:parseInt(c.get("current_supply"),10),asset:a.get("id")}):null);case"baseSupply":return s.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},p?s.a.createElement(f.a,{style:{fontWeight:"bold"},amount:parseInt(p.get("current_supply"),10),asset:n.get("id")}):null);case"issuer":return s.a.createElement("td",{onClick:e._onClick.bind(e,i),key:t.index},s.a.createElement(k,{account:a.get("issuer")}));case"add":return s.a.createElement("td",{style:{textAlign:"right"},key:t.index,onClick:e.props.onCheckMarket.bind(e,i)},s.a.createElement("input",{type:"checkbox",checked:!!e.props.isChecked||e.props.isDefault,disabled:e.props.isDefault,"data-tip":e.props.isDefault?"This market is a default market and cannot be removed":null}));case"remove":return s.a.createElement("td",{key:t.index,className:"clickable",onClick:e.props.removeMarket},s.a.createElement("span",{style:{marginBottom:"6px",marginRight:"6px",zIndex:999},className:"text float-right remove"},"–"))}}).sort(function(e,t){return e.key>t.key}),_="clickable";return this.props.current&&(_+=" activeMarket"),s.a.createElement("tr",{className:_,style:d},g)}}]),t}();O.defaultProps={noSymbols:!1},O.contextTypes={router:x.a.object.isRequired};var N=Object(b.a)(O,{propNames:["quote","base"],defaultProps:{tempComponent:"tr"},withDynamic:!0}),P=a(9),T=a(35),j=a(115),q=a(21),I=a(123),F=a(8),B=a.n(F),M=a(4),R=a(3),L=a.n(R),D=a(162),z=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var V=function(e){function t(){return U(this,t),W(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return H(t,s.a.Component),z(t,[{key:"render",value:function(){return 0!==this.props.assets.length&&this.props.value?s.a.createElement(D.a,{entries:this.props.assets.map(function(e){return e&&e.get("symbol")}).filter(function(e){return!!e}),values:this.props.assets.reduce(function(e,t){return t&&t.get("symbol")&&(e[t.get("symbol")]=t),e},{}),singleEntry:this.props.assets[0]?s.a.createElement(f.a,{asset:this.props.assets[0].get("id"),amount:0,hide_amount:!0}):null,value:"",onChange:this.props.onChange}):null}}]),t}();V.propTypes={value:x.a.string,onChange:x.a.func},V=Object(b.a)(V,{asList:!0});var J=function(e){function t(){return U(this,t),W(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return H(t,s.a.Component),z(t,[{key:"getAsset",value:function(){return this.props.asset}},{key:"getError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.assetInput,t=this.props.error;return t||!e||this.getNameType(e)||(t=L.a.translate("explorer.asset.invalid",{name:e})),t}},{key:"getNameType",value:function(e){return e?M.d.is_valid_symbol_error(e,!0)?null:"symbol":null}},{key:"onInputChanged",value:function(e){var t=e.target.value.trim().substr(0,16).toUpperCase();this.props.onChange&&t!==this.props.assetInput&&this.props.onChange(t)}},{key:"onKeyDown",value:function(e){13===e.keyCode&&(this.onFound(e),this.onAction(e))}},{key:"componentDidMount",value:function(){this.props.onFound&&this.props.asset&&this.props.onFound(this.props.asset)}},{key:"componentWillReceiveProps",value:function(e){this.props.onFound&&e.asset!==this.props.asset&&this.props.onFound(e.asset)}},{key:"onFound",value:function(e){e.preventDefault(),!this.props.onFound||this.getError()||this.props.disableActionButton||this.props.asset&&this.props.onFound(this.props.asset)}},{key:"onAssetSelect",value:function(e){e&&(this.props.onFound(e),this.props.onChange(e.get("symbol")))}},{key:"onAction",value:function(e){e.preventDefault(),!this.props.onAction||this.getError()||this.props.disableActionButton||this.props.asset&&this.props.onAction(this.props.asset)}},{key:"render",value:function(){var e=this.props,t=e.disabled,a=e.noLabel,n=this.getError(),r=void 0;t||(this.props.asset?r=this.props.asset.get("symbol"):!n&&this.props.assetInput&&(n=L.a.translate("explorer.asset.not_found",{name:this.props.assetInput})));var o=B()("button btn large outline",{disabled:!this.props.asset||n||this.props.disableActionButton});return s.a.createElement("div",{className:"asset-selector",style:this.props.style},s.a.createElement("div",null,s.a.createElement("div",{className:"header-area"},n||a?null:s.a.createElement("label",{className:"right-label"},"  ",s.a.createElement("span",null,r)),s.a.createElement(m.a,{component:"label",content:this.props.label})),s.a.createElement("div",{className:"input-area"},s.a.createElement("div",{className:"inline-label input-wrapper"},s.a.createElement("input",{style:this.props.inputStyle,disabled:this.props.disabled,type:"text",value:this.props.assetInput||"",placeholder:this.props.placeholder||L.a.translate("explorer.assets.symbol"),ref:"user_input",onChange:this.onInputChanged.bind(this),onKeyDown:this.onKeyDown.bind(this),tabIndex:this.props.tabIndex}),s.a.createElement("div",{className:"form-label select floating-dropdown"},this.props.asset?s.a.createElement(V,{ref:this.props.refCallback,value:this.props.asset.get("symbol"),assets:i.a.List(this.props.assets),onChange:this.onAssetSelect.bind(this)}):null),this.props.children,this.props.onAction?s.a.createElement("button",{className:o,style:{marginLeft:10},onClick:this.onAction.bind(this)},s.a.createElement(m.a,{content:this.props.action_label})):null)),s.a.createElement("div",{className:"error-area",style:{paddingBottom:"10px"}},s.a.createElement("span",{style:{wordBreak:"break-all"}},n))))}}]),t}();J.propTypes={label:x.a.string,error:x.a.string,placeholder:x.a.string,onChange:x.a.func,onFound:x.a.func,assetInput:x.a.string,asset:g.a.ChainAsset,tabIndex:x.a.number,disableActionButton:x.a.string},J.defaultProps={disabled:!1};var G=Object(_.a)(J),K=a(39),Q=a(25),Y=a.n(Q),X=a(55),Z=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var $=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={backingAsset:"",error:!1,valid:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.a.Component),Z(t,[{key:"_onMoveUp",value:function(e){var t=this.props.quotes.findIndex(function(t){return t===e});C.a.modifyPreferedBases({oldIndex:t,newIndex:t-1})}},{key:"_onMoveDown",value:function(e){var t=this.props.quotes.findIndex(function(t){return t===e});C.a.modifyPreferedBases({oldIndex:t,newIndex:t+1})}},{key:"_onRemove",value:function(e){var t=this.props.quotes.findIndex(function(t){return t===e});t>=0&&C.a.modifyPreferedBases({remove:t})}},{key:"_onAdd",value:function(e){-1===this.props.quotes.findIndex(function(t){return t===e.get("symbol")})&&C.a.modifyPreferedBases({add:e.get("symbol")})}},{key:"_onInputBackingAsset",value:function(e){this.setState({backingAsset:e.toUpperCase(),error:null})}},{key:"_onFoundBackingAsset",value:function(e){e&&(this.props.quotes.includes(e.get("symbol"))?this.setState({error:"Asset already being used",isValid:!1}):this.setState({isValid:!0}))}},{key:"render",value:function(){var e=this,t=this.state.error,a=this.props.quotes.size;return s.a.createElement(X.a,{id:"quote_selection",overlay:!0,modalHeader:"exchange.quote_selection",noLogo:!0},s.a.createElement("section",{className:"block-list no-border-bottom"},s.a.createElement("table",{className:"table"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null),s.a.createElement("th",null,s.a.createElement(m.a,{content:"account.quote"})),s.a.createElement("th",{style:{textAlign:"center"}},s.a.createElement(m.a,{content:"exchange.move_down"})),s.a.createElement("th",{style:{textAlign:"center"}},s.a.createElement(m.a,{content:"exchange.move_up"})),s.a.createElement("th",{style:{textAlign:"center"}},s.a.createElement(m.a,{content:"exchange.remove"})))),s.a.createElement("tbody",null,this.props.quotes.map(function(t,n){return s.a.createElement("tr",{key:t},s.a.createElement("td",null,n+1),s.a.createElement("td",null,t),s.a.createElement("td",{className:"text-center"},n!==a-1&&s.a.createElement(E.a,{onClick:e._onMoveDown.bind(e,t),name:"chevron-down",className:"clickable"})),s.a.createElement("td",{className:"text-center"},0!==n&&s.a.createElement(E.a,{onClick:e._onMoveUp.bind(e,t),name:"chevron-down",className:"clickable rotate180"})),s.a.createElement("td",{className:"text-center"},a>1&&s.a.createElement(E.a,{onClick:e._onRemove.bind(e,t),name:"cross-circle",className:"clickable"})))}))),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("div",null,s.a.createElement(G,{label:"exchange.custom_quote",onChange:this._onInputBackingAsset.bind(this),asset:this.state.backingAsset,assetInput:this.state.backingAsset,tabIndex:1,style:{width:"100%",paddingRight:"10px"},onFound:this._onFoundBackingAsset.bind(this),onAction:this._onAdd.bind(this),action_label:"exchange.add_quote",disableActionButton:!!t,noLabel:!0}),s.a.createElement("div",{className:"error-area"},t))))}}]),t}(),ee=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),te=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function re(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var se=new Date,oe=function(e){function t(e){ae(this,t);var a=ne(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state=a._getInitialState(e),a}return re(t,s.a.Component),te(t,[{key:"_getInitialState",value:function(e){var t=!!e.findMarketTab||e.viewSettings.get("myMarketsBase_"+e.index);return{open:void 0===t||t,inverseSort:e.viewSettings.get("myMarketsInvert",!0),sortBy:e.viewSettings.get("myMarketsSort","volume"),inputValue:""}}},{key:"componentWillReceiveProps",value:function(e){e.findMarketTab!==this.props.findMarketTab&&this.setState(this._getInitialState(e))}},{key:"shouldComponentUpdate",value:function(e,t){return!e.markets||!this.props.markets||(!u.a.are_equal_shallow(t,this.state)||!u.a.are_equal_shallow(e.markets,this.props.markets)||e.starredMarkets!==this.props.starredMarkets||e.marketStats!==this.props.marketStats||e.userMarkets!==this.props.userMarkets)}},{key:"_inverseSort",value:function(){C.a.changeViewSetting({myMarketsInvert:!this.state.myMarketsInvert}),this.setState({inverseSort:!this.state.inverseSort})}},{key:"_changeSort",value:function(e){var t=this.getCookie("gt_get_sort"),a=new Date;a.setFullYear(a.getFullYear()+1),"vol-true"!=t&&"name-true"!=t&&"name-false"!=t||"volume"!=e?"vol-false"!=t&&null!=t||"volume"!=e||(this.setCookie("gt_get_sort","vol-true",{expires:a.toGMTString()}),this._inverseSort()):this.setCookie("gt_get_sort","vol-false",{expires:a.toGMTString()}),"name-true"!=t&&"vol-true"!=t&&"vol-false"!=t||"name"!=e?"name-false"!=t&&null!=t||"name"!=e||(this.setCookie("gt_get_sort","name-true",{expires:a.toGMTString()}),this._inverseSort()):this.setCookie("gt_get_sort","name-false",{expires:a.toGMTString()}),e!==this.state.sortBy?(C.a.changeViewSetting({myMarketsSort:e}),this.setState({sortBy:e})):this._inverseSort()}},{key:"_onToggle",value:function(e){if(!this.props.findMarketTab){var t=!this.state.open;this.setState({open:t});var a={};a["myMarketsBase_"+this.props.index]=t,C.a.changeViewSetting(a)}}},{key:"_onToggleUserMarket",value:function(e){var t=e.split("_"),a=ee(t,2),n=a[0],r=a[1],s=!this.props.userMarkets.get(e);C.a.setUserMarket(n,r,s)}},{key:"setCookie",value:function(e,t,a){var n=(a=a||{}).expires;if("number"==typeof n&&n){var r=new Date;r.setTime(r.getTime()+1e3*n),n=a.expires=r}n&&n.toUTCString&&(a.expires=n.toUTCString());var s=e+"="+(t=encodeURIComponent(t));for(var o in a){s+="; "+o;var i=a[o];!0!==i&&(s+="="+i)}document.cookie=s}},{key:"getCookie",value:function(e){var t=document.cookie,a=e+"=",n=t.indexOf("; "+a),r=null;if(-1==n){if(0!=(n=t.indexOf(a)))return null;r=document.cookie.indexOf(";",n)}else n+=2,-1==(r=document.cookie.indexOf(";",n))&&(r=t.length);return decodeURI(t.substring(n+a.length,r)).replace(/"/g,"")}},{key:"render",value:function(){var e=this,t=this.props,a=t.columns,n=t.markets,r=t.base,o=t.marketStats,i=t.starredMarkets,l=t.current,c=this.state,u=c.sortBy,p=c.inverseSort,d=c.open;if(!n||!n.length)return null;var h=a.map(function(t){switch(t.name){case"market":var a="",n=e.getCookie("gt_get_sort");return"name"!=e.state.sortBy||"name-false"!=n&&null!=n?"name"==e.state.sortBy&&"name-true"==n&&(a=s.a.createElement("span",null,"▼")):a=s.a.createElement("span",null,"▲"),s.a.createElement("th",{key:t.name,className:"clickable",onClick:e._changeSort.bind(e,"name")},s.a.createElement(m.a,{content:"exchange.market"}),a);case"vol":var r="",o=e.getCookie("gt_get_sort");return"volume"!=e.state.sortBy||"vol-false"!=o&&null!=o?"volume"==e.state.sortBy&&"vol-true"==o&&(r=s.a.createElement("span",null,"▲")):r=s.a.createElement("span",null,"▼"),s.a.createElement("th",{key:t.name,className:"clickable",onClick:e._changeSort.bind(e,"volume"),style:{textAlign:"right"}},s.a.createElement(m.a,{content:"exchange.vol_short"}),r);case"price":return s.a.createElement("th",{key:t.name,style:{textAlign:"right"}},s.a.createElement(m.a,{content:"exchange.price"}));case"quoteSupply":return s.a.createElement("th",{key:t.name},s.a.createElement(m.a,{content:"exchange.base_supply"}));case"baseSupply":return s.a.createElement("th",{key:t.name},s.a.createElement(m.a,{content:"exchange.quote_supply"}));case"change":var i="";return"change"==e.state.sortBy&&e.state.inverseSort?i=s.a.createElement("span",null,"▲"):"change"==e.state.sortBy&&(i=s.a.createElement("span",null,"▼")),s.a.createElement("th",{key:t.name,className:"clickable",onClick:e._changeSort.bind(e,"change"),style:{textAlign:"right"}},s.a.createElement(m.a,{content:"exchange.change"}),i);case"issuer":return s.a.createElement("th",{key:t.name},s.a.createElement(m.a,{content:"explorer.assets.issuer"}));case"add":return s.a.createElement("th",{key:t.name,style:{textAlign:"right"}},s.a.createElement(m.a,{content:"account.perm.confirm_add"}));default:return s.a.createElement("th",{key:t.name})}}),f=n.map(function(t){return e.props.onlyLiquid&&o.get(t.id)&&0==o.get(t.id).volumeBase?null:s.a.createElement(N,{key:t.id,name:"others"===r?s.a.createElement("span",null,s.a.createElement(q.a,{name:t.quote}),":",s.a.createElement(q.a,{name:t.base})):s.a.createElement(q.a,{dataPlace:"left",name:t.quote}),quote:t.quote,base:t.base,columns:a,leftAlign:!0,compact:!0,noSymbols:!0,stats:o.get(t.id),starred:i.has(t.id),current:l===t.id,isChecked:e.props.userMarkets.has(t.id),isDefault:e.props.defaultMarkets&&e.props.defaultMarkets.has(t.id),onCheckMarket:e._onToggleUserMarket.bind(e),location:e.props.location,history:e.props.history})}).filter(function(e){return null!==e}).sort(function(t,a){var n=t.key.split("_"),r=a.key.split("_"),s=o.get(n[0]+"_"+n[1]),i=o.get(r[0]+"_"+r[1]),l=e.getCookie("gt_get_sort");switch(u){case"name":return"name-false"==l?p=!1:"name-true"==l&&(p=!0),n[0]>r[0]?p?-1:1:n[0]<r[0]?p?1:-1:n[1]>r[1]?p?-1:1:n[1]<r[1]?p?1:-1:0;case"volume":var c=s,m=i;if(s&&i){var d=s.volumeBase?s.volumeBase:0,h=i.volumeBase?i.volumeBase:0;return"vol-false"==l||null==l?h-d:d-h}return c=c?c.volumeBase:0,m=m?m.volumeBase:0,"vol-false"==l||null==l?m-c:c-m;case"change":return s&&i?p?i.change-s.change:s.change-i.change:0}});return s.a.createElement("div",{style:{paddingRight:10}},d?s.a.createElement("table",{className:"table table-hover text-right"},s.a.createElement("thead",null,s.a.createElement("tr",null,h)),f&&f.length?s.a.createElement("tbody",null,f):null):null)}}]),t}();oe.defaultProps={maxRows:20,onlyLiquid:!1};var ie=function(e){function t(e){ae(this,t);var a=ne(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.clearInput=function(e){a.setState({myMarketFilter:""})},a.handleSearchUpdate=function(e){a.setState({myMarketFilter:e.target.value&&e.target.value.toUpperCase()})},a.state={inverseSort:e.viewSettings.get("myMarketsInvert",!0),sortBy:e.viewSettings.get("myMarketsSort","volume"),activeTab:e.viewSettings.get("favMarketTab","my-market"),activeMarketTab:e.viewSettings.get("activeMarketTab",0),lookupQuote:null,lookupBase:null,inputValue:"",minWidth:"100%",findBaseInput:"USD",activeFindBase:"USD"},a._onInputName=a._onInputName.bind(a),a._setMinWidth=a._setMinWidth.bind(a),a.getAssetList=Object(n.a)(I.a.getAssetList.defer,150),a}return re(t,s.a.Component),te(t,[{key:"shouldComponentUpdate",value:function(e,t){return"find-market"===this.state.activeTab||"find-market"!==t.activeTab||e.searchAssets.size||this._lookupAssets("OPEN.",!0),!(i.a.is(e.searchAssets,this.props.searchAssets)&&i.a.is(e.markets,this.props.markets)&&i.a.is(e.starredMarkets,this.props.starredMarkets)&&i.a.is(e.defaultMarkets,this.props.defaultMarkets)&&i.a.is(e.marketStats,this.props.marketStats)&&u.a.are_equal_shallow(t,this.state)&&e.current===this.props.current&&e.minWidth===this.props.minWidth&&e.preferredBases===this.props.preferredBases&&e.onlyStars===this.props.onlyStars&&e.onlyLiquid===this.props.onlyLiquid&&e.assetsLoading===this.props.assetsLoading&&e.userMarkets===this.props.userMarkets)}},{key:"componentWillMount",value:function(){if(this.props.setMinWidth&&window.addEventListener("resize",this._setMinWidth,{capture:!1,passive:!0}),this.props.currrent){var e=this.props.current.split("_")[1],t=this.props.preferredBases.findIndex(function(t){return t===e});-1!==t&&t!==this.state.activeMarketTab&&this.setState({activeMarketTab:t})}}},{key:"componentDidMount",value:function(){var e=this.refs.favorites;c.a.initialize(e),this._setMinWidth(),"find-market"===this.state.activeTab&&this._lookupAssets("OPEN.",!0)}},{key:"componetWillUnmount",value:function(){this.props.setMinWidth&&window.removeEventListener("resize",this._setMinWidth)}},{key:"_setMinWidth",value:function(){this.props.setMinWidth&&this.refs.favorites&&"my-market"===this.props.activeTab&&this.state.minWidth!==this.refs.favorites.offsetWidth&&this.setState({minWidth:this.refs.favorites.offsetWidth})}},{key:"componentDidUpdate",value:function(){if(this.refs.favorites){var e=this.refs.favorites;c.a.update(e)}}},{key:"_inverseSort",value:function(){C.a.changeViewSetting({myMarketsInvert:!this.state.myMarketsInvert}),this.setState({inverseSort:!this.state.inverseSort})}},{key:"_changeSort",value:function(e){var t=this.getCookie("gt_get_sort"),a=new Date;a.setFullYear(a.getFullYear()+1),"vol-true"==t&&"volume"==e?this.setCookie("gt_get_sort","vol-false",{expires:a.toGMTString()}):"vol-false"!=t&&null!=t||"volume"!=e||(this.setCookie("gt_get_sort","vol-true",{expires:a.toGMTString()}),this._inverseSort()),e!==this.state.sortBy?(C.a.changeViewSetting({myMarketsSort:e}),this.setState({sortBy:e})):this._inverseSort()}},{key:"_goMarkets",value:function(){this.context.router.push("/markets")}},{key:"_changeTab",value:function(e){C.a.changeViewSetting({favMarketTab:e}),this.setState({activeTab:e}),this._setMinWidth()}},{key:"_onInputName",value:function(e){var t=e.target.value.trim().toUpperCase(),a=!M.d.is_valid_symbol_error(t,!0);if(this.setState({inputValue:t}),t&&t.length>=3&&!a)return this.setState({assetNameError:!0});this.setState({assetNameError:!1}),this._lookupAssets(t)}},{key:"_lookupAssets",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e||""===e){var a=new Date,n=e.toUpperCase().split(":"),r=n[0],s=2===n.length?n[1]:null;if(this.setState({lookupQuote:r,lookupBase:s}),C.a.changeViewSetting.defer({marketLookupInput:e.toUpperCase()}),this.state.lookupQuote!==r||t){if(r.length<1||a-se<=250)return!1;this.getAssetList(r,50)}else if(s&&this.state.lookupBase!==s){if(s.length<1||a-se<=250)return!1;this.getAssetList(s,50)}}}},{key:"toggleActiveMarketTab",value:function(e){C.a.changeViewSetting({activeMarketTab:e}),this.setState({activeMarketTab:e})}},{key:"_onInputBaseAsset",value:function(e){this.setState({findBaseInput:e.toUpperCase(),error:null})}},{key:"_onFoundBaseAsset",value:function(e){e&&this.setState({activeFindBase:e.get("symbol")})}},{key:"render",value:function(){var e=this,t=this.props,n=t.starredMarkets,r=t.defaultMarkets,o=t.marketStats,l=t.columns,c=t.searchAssets,u=t.assetsLoading,p=t.preferredBases,h=(t.core,t.current),f=t.viewSettings,b=t.onlyStars,g=t.userMarkets,_=this.state,y=_.activeMarketTab,v=_.activeTab,k=_.lookupQuote,E=_.lookupBase,S=s.a.createElement("tr",null),x="my-market"===v,A=p.map(function(e){return e});x||(p=(p=p.clear()).push(this.state.activeFindBase));var O={},N=[];k||(k="OPEN."),x||(y=0),c.filter(function(e){return E&&E.length?0===e.symbol.indexOf(E):-1!==e.symbol.indexOf(k)}).forEach(function(e){E&&E.length?0===e.symbol.indexOf(E)&&N.push(e.symbol):p.includes(e.symbol)&&e.symbol.length>=k.length&&e.symbol.length<k.length+3&&N.push(e.symbol)}),N=(N=N.concat(p.filter(function(e){return!E||!E.length||0===e.indexOf(E)}).toArray())).filter(function(e){return!(E&&E.length>1)||0===e.indexOf(E)});var P=[];c.size&&c.filter(function(e){try{if(e.options.description){var t=JSON.parse(e.options.description);if("visible"in t&&!t.visible)return!1}}catch(e){}return-1!==e.symbol.indexOf(k)&&e.symbol.length>=k.length}).forEach(function(e){N.forEach(function(t){var a=e.symbol+"_"+t;t!==e.symbol&&P.push([a,{quote:e.symbol,base:t}])})}),P=P.filter(function(e){return!E||e[1].quote===k}),P=i.a.Map(P);var T=x?r:P;x&&g.size&&g.forEach(function(e,t){T=T.set(t,e)}),T.size>0&&(S=T.filter(function(t){if(x){var a=t.quote+"_"+t.base;return e.state.myMarketFilter?-1!==a.indexOf(e.state.myMarketFilter):!(b&&!n.has(a))}return!(k.length<1)&&-1!==t.quote.indexOf(k)}).map(function(e){var t=e.quote+"_"+e.base;return p.includes(e.base)?(O[e.base]||(O[e.base]=[]),O[e.base].push({id:t,quote:e.quote,base:e.base}),null):{id:t,quote:e.quote,base:e.base}}).filter(function(e){return null!==e}).take(x?100:20).toArray());var j=S&&S.length,q="mymarkets-header clickable",I=B()(q,{inactive:!x}),F=B()(q,{inactive:x}),M={minWidth:this.state.minWidth,minHeight:"6rem"},R=a(3);return s.a.createElement("div",{className:this.props.className+" explorer_markets",style:this.props.style},s.a.createElement("div",{style:this.props.headerStyle,className:"grid-block shrink left-orderbook-header bottom-header"},s.a.createElement("div",{ref:"myMarkets",className:I,onClick:this._changeTab.bind(this,"my-market"),"data-intro":R.translate("walkthrough.my_markets_tab")},s.a.createElement(m.a,{content:"exchange.market_name"})),s.a.createElement("div",{className:F,onClick:this._changeTab.bind(this,"find-market"),"data-intro":R.translate("walkthrough.find_markets_tab")},s.a.createElement(m.a,{content:"exchange.more"}))),this.props.controls?s.a.createElement("div",{className:"small-12 medium-6",style:{padding:"1rem 0"}},this.props.controls?s.a.createElement("div",{style:{paddingBottom:"0.5rem"}},this.props.controls):null):null,x?s.a.createElement("div",{className:"grid-block vertical shrink",style:{width:"100%",textAlign:"left",padding:"0.5rem 0.5rem"}},s.a.createElement("div",null,s.a.createElement("label",{style:{margin:"0px 0 0"}},s.a.createElement("input",{style:{position:"relative",top:3},className:"no-margin",type:"checkbox",checked:this.props.onlyLiquid,onChange:function(){C.a.changeViewSetting({onlyLiquid:!e.props.onlyLiquid})}}),s.a.createElement("span",{style:{paddingLeft:"0.4rem"}},s.a.createElement(m.a,{content:"exchange.show_only_liquid"}))),s.a.createElement("label",{style:{margin:"0px 0 0"}},s.a.createElement("input",{style:{position:"relative",top:3},className:"no-margin",type:"checkbox",checked:this.props.onlyStars,onChange:function(){w.a.toggleStars()}}),s.a.createElement("span",{style:{paddingLeft:"0.4rem"}},s.a.createElement(d.a,{string:"exchange.show_only_star_formatter",keys:[{type:"icon",value:"fi-star",className:"gold-star",arg:"star_icon"}]})))),s.a.createElement("div",{className:"search-wrapper"},s.a.createElement("form",null,s.a.createElement("input",{autoComplete:"off",style:{fontSize:"0.9rem",height:"inherit",position:"relative",top:5,padding:2},type:"text",className:"no-margin market-filter-input",placeholder:L.a.translate("exchange.filter"),maxLength:"16",name:"focus",required:"required",value:this.state.myMarketFilter,onChange:this.handleSearchUpdate}),s.a.createElement("button",{className:"clear-text",type:"reset",onClick:this.clearInput})))):s.a.createElement("div",{style:{width:"100%",textAlign:"left",padding:"0.5rem 0.5rem"}},s.a.createElement("table",null,s.a.createElement("tbody",null,s.a.createElement("tr",{style:{width:"100%"}},s.a.createElement("td",null,s.a.createElement(G,{onAssetSelect:this._onFoundBaseAsset.bind(this),assets:A,onChange:this._onInputBaseAsset.bind(this),asset:this.state.findBaseInput,assetInput:this.state.findBaseInput,tabIndex:1,style:{width:"100%",paddingBottom:"1.5rem"},onFound:this._onFoundBaseAsset.bind(this),label:"exchange.quote",noLabel:!0,inputStyle:{fontSize:"0.9rem"}}))),s.a.createElement("tr",{style:{width:"100%"}},s.a.createElement("td",null,s.a.createElement("label",null,s.a.createElement(m.a,{content:"account.user_issued_assets.name"}),":"),s.a.createElement("input",{style:{fontSize:"0.9rem",position:"relative",top:1},type:"text",value:this.state.inputValue,onChange:this._onInputName,placeholder:L.a.translate("exchange.search"),maxLength:"16",tabIndex:2,ref:"findSearchInput"}),this.state.assetNameError?s.a.createElement("div",{className:"error-area",style:{paddingTop:10}},s.a.createElement("span",{style:{wordBreak:"break-all"}},s.a.createElement(m.a,{content:"explorer.asset.invalid",name:this.state.inputValue}))):null))))),s.a.createElement("ul",{className:"mymarkets-tabs"},p.map(function(t,a){return t?s.a.createElement("li",{key:t,onClick:e.toggleActiveMarketTab.bind(e,a),className:B()("mymarkets-tab",{active:y===a})},s.a.createElement("span",null,t)):null}),x&&j?s.a.createElement("li",{key:"others",style:{textTransform:"uppercase"},onClick:this.toggleActiveMarketTab.bind(this,p.size+1),className:B()("mymarkets-tab",{active:y===p.size+1})},s.a.createElement(m.a,{content:"exchange.others"})):null,x&&s.a.createElement("li",{key:"quote_edit",style:{textTransform:"uppercase"},onClick:function(){Y.a.publish("quote_selection","open")},className:"mymarkets-tab"}," + ")),s.a.createElement("div",{style:M,className:"table-container grid-block vertical mymarkets-list explorer-markets",ref:"favorites"},u?s.a.createElement("div",{style:{position:"absolute",paddingTop:"3rem",textAlign:"center",width:"100%"}},s.a.createElement(K.a,{type:"three-bounce"})):null,p.filter(function(e){return e===p.get(y)}).map(function(t,a){return s.a.createElement(oe,{userMarkets:e.props.userMarkets,defaultMarkets:e.props.defaultMarkets,index:a,allowChange:!1,key:t,current:h,starredMarkets:n,marketStats:o,viewSettings:f,columns:x?l:e.props.findColumns||l,markets:O[t],base:t,maxRows:x?20:10,findMarketTab:!x,location:e.props.location,history:e.props.history,onlyLiquid:e.props.onlyLiquid&&x})}),y===p.size+1&&x&&j?s.a.createElement(oe,{userMarkets:this.props.userMarkets,index:p.size,current:h,starredMarkets:n,marketStats:o,viewSettings:f,columns:l,markets:S,base:"others",maxRows:x?20:10,findMarketTab:!x,location:this.props.location,history:this.props.history}):null),s.a.createElement($,{quotes:this.props.preferredBases}))}}]),t}();ie.propTypes={core:g.a.ChainAsset.isRequired},ie.defaultProps={activeTab:"my-market",core:"1.3.0",setMinWidth:!1},ie.contextTypes={router:x.a.object.isRequired},ie=Object(_.a)(ie);var le=function(e){function t(){return ae(this,t),ne(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return re(t,s.a.Component),te(t,[{key:"render",value:function(){return s.a.createElement(ie,this.props)}}]),t}();t.a=Object(h.connect)(le,{listenTo:function(){return[P.a,T.a,j.a]},getProps:function(){return{starredMarkets:P.a.getState().starredMarkets,onlyLiquid:P.a.getState().viewSettings.get("onlyLiquid",!1),defaultMarkets:P.a.getState().defaultMarkets,viewSettings:P.a.getState().viewSettings,preferredBases:P.a.getState().preferredBases,marketStats:T.a.getState().allMarketStats,userMarkets:P.a.getState().userMarkets,searchAssets:j.a.getState().assets,onlyStars:T.a.getState().onlyStars,assetsLoading:j.a.getState().assetsLoading}}})},343:function(e,t){e.exports={midnightTheme:{bidColor:"#50D2C2",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#E3745B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#6BA583",negativeColor:"#DB0000",strokeColor:"#FFFF00",primaryText:"#00195b",volumeColor:"#848484",tooltipBackgroundColor:"rgba(0, 0, 0, 0.4)",tooltipColor:"#fff",tooltipFillColor:"#fff",axisLabelsColor:"#fff",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#FFFFFF",bgColor:"#191a1f",textColor:"#00195b"},darkTheme:{bidColor:"#6BA583",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#E3745B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#258A14",negativeColor:"#DB0000",strokeColor:"#FFFF00",primaryText:"#00195b",volumeColor:"#848484",tooltipBackgroundColor:"rgba(0, 0, 0, 0.4)",tooltipColor:"#fff",tooltipFillColor:"#fff",axisLabelsColor:"#fff",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#FFFFFF",bgColor:"#2a2a2a",textColor:"#ffffff"},lightTheme:{bidColor:"#258A14",bidFillColor:"rgba(80, 210, 194, 0.5)",askColor:"#EA340B",askFillColor:"rgba(227, 116, 91, 0.5)",callColor:"#BBBF2B",settleColor:"rgba(125, 134, 214, 1)",settleFillColor:"rgba(125, 134, 214, 0.5)",positiveColor:"#528c0a",negativeColor:"rgba(225, 66, 74, 1)",strokeColor:"#000000",primaryText:"#242424",volumeColor:"#848484",tooltipBackgroundColor:"rgba(255,255,255, 0.9)",tooltipColor:"#000",tooltipFillColor:"#000",axisLabelsColor:"#000",axisLineColor:"rgba(200, 200, 200, 0.3)",indicatorLineColor:"#848484",bgColor:"#fff",textColor:"#3d3d3d"}}},553:function(e,t,a){"use strict";(function(e){var n=a(89),r=a(0),s=a.n(r),o=a(25),i=a.n(o),l=a(55),c=a(1),u=a.n(c),p=a(20),m=a(5),d=a(17),h=a(11),f=a(23),b=a(47),g=a.n(b),_=a(3),y=a.n(_),v=a(43),k=a(238),E=a(14),w=a(39),C=a(51),S=a(21),x=a(4),A=a(273),O=(a(26),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}),N=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var q=function(t){function a(e){P(this,a);var t=T(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.state={toAddress:v.a.getLast(e.walletType),withdrawValue:"",amountError:null,symbol:e.asset.get("symbol"),to_withdraw:new p.a({asset_id:e.asset.get("id"),precision:e.asset.get("precision")}),fee_asset_id:"1.3.0",feeStatus:{},loading:!1,emptyAddressDeposit:!1},t._validateAddress(t.state.toAddress,e),t.addDepositAddress=t.addDepositAddress.bind(t),t._checkFeeStatus=t._checkFeeStatus.bind(t),t._checkBalance=t._checkBalance.bind(t),t._getCurrentBalance=t._getCurrentBalance.bind(t),t._getFee=t._getFee.bind(t),t._updateFee=Object(n.a)(t._updateFee.bind(t),250),t}return j(a,A["a"]),N(a,[{key:"componentWillMount",value:function(){this._getDepositAddress(),this._updateFee(),this._checkFeeStatus()}},{key:"componentWillReceiveProps",value:function(e){e.asset&&this.props.asset&&e.asset.get("id")!==this.props.asset.get("id")&&this.setState({to_withdraw:new p.a({asset_id:e.asset.get("id"),precision:e.asset.get("precision")}),gateFee:e.asset.get("gateFee"),intermediateAccount:e.asset.get("intermediateAccount"),symbol:e.asset.get("symbol"),memo:"",withdrawValue:"",receive_address:null,toAddress:v.a.getLast(e.walletType)},this._getDepositAddress)}},{key:"_getDepositAddress",value:function(){if(this.props.backingCoinType){var e=Object(v.h)({coin:"open."+this.props.backingCoinType.toLowerCase(),account:this.props.account,stateCallback:this.addDepositAddress});e?this.setState({receive_address:e}):Object(v.i)(this._getDepositObject())}}},{key:"_getDepositObject",value:function(){return{inputCoinType:this.props.backingCoinType.toLowerCase(),outputCoinType:this.props.symbol.toLowerCase(),outputAddress:this.props.sender.get("name"),stateCallback:this.addDepositAddress}}},{key:"requestDepositAddressLoad",value:function(){this.setState({loading:!0,emptyAddressDeposit:!1}),Object(v.i)(this._getDepositObject())}},{key:"addDepositAddress",value:function(e){e.error&&("no_address"===e.error.message?this.setState({emptyAddressDeposit:!0}):this.setState({emptyAddressDeposit:!1})),this.setState({receive_address:e,loading:!1})}},{key:"componentDidUpdate",value:function(){g.a.rebuild()}},{key:"onSubmit",value:function(t){if(t.preventDefault(),0===this.state.to_withdraw.getAmount())return this.setState({amountError:"transfer.errors.pos"});if(this.props.intermediateAccount){var a=this._getFee(),n=this._getGateFee(),r=this.state.to_withdraw.clone(),s=r.clone(this._getCurrentBalance().get("balance"));r.plus(n),s.lt(r)&&(r=this.state.to_withdraw.clone()),f.a.transfer(this.props.sender.get("id"),this.props.intermediateAccount,this.state.to_withdraw.getAmount(),this.state.to_withdraw.asset_id,this.props.backingCoinType.toLowerCase()+":"+this.state.toAddress+(this.state.memo?":"+new e(this.state.memo,"utf-8"):""),null,a.asset_id)}}},{key:"_updateAmount",value:function(){var e=this._getFee(),t=this._getCurrentBalance(),a=new p.a({amount:t?t.get("balance"):0,asset_id:this.props.asset.get("id"),precision:this.props.asset.get("precision")});a.asset_id===e.asset_id&&a.minus(e),this.state.to_withdraw.setAmount({sats:a.getAmount()}),this.setState({withdrawValue:a.getAmount({real:!0}),amountError:null},this._checkBalance)}},{key:"_checkFeeStatus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.sender;if(t){var a=["1.3.0",this.state.to_withdraw.asset_id],n={},r=[];a.forEach(function(a){r.push(Object(C.b)({accountID:t.get("id"),feeID:a,options:["price_per_kbyte"],data:{type:"memo",content:e.props.backingCoinType.toLowerCase()+":"+e.state.toAddress+(e.state.memo?":"+e.state.memo:"")}}))}),Promise.all(r).then(function(t){a.forEach(function(e,a){n[e]=t[a]}),m.a.are_equal_shallow(e.state.feeStatus,n)||e.setState({feeStatus:n}),e._checkBalance()}).catch(function(e){console.error(e)})}}},{key:"_updateFee",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.fee_asset_id;if(!this.props.sender)return null;Object(C.b)({accountID:this.props.sender.get("id"),feeID:t,options:["price_per_kbyte"],data:{type:"memo",content:this.props.backingCoinType.toLowerCase()+":"+this.state.toAddress+(this.state.memo?":"+this.state.memo:"")}}).then(function(t){var a=t.fee,n=t.hasBalance,r=t.hasPoolBalance;e.setState({feeAmount:a,hasBalance:n,hasPoolBalance:r,error:!n||!r},e._checkFeeStatus)})}},{key:"_getCurrentBalance",value:function(){var e=this;return this.props.balances.find(function(t){return t&&t.get("asset_type")===e.props.asset.get("id")})}},{key:"_checkBalance",value:function(){var e=this.state,t=e.feeAmount,a=e.to_withdraw,n=this.props.asset,r=this._getCurrentBalance();if(r&&t){var s=Object(C.a)(a.getAmount({real:!0}),n,this._getFee(),r,this._getGateFee());if(null!==s)return this.state.balanceError!==!s&&this.setState({balanceError:!s}),s}}},{key:"_getFee",value:function(){var e={getAmount:function(){return 0},asset_id:this.state.fee_asset_id};if(!this.state.feeStatus||!this.state.feeAmount)return e;var t=this.state.feeStatus["1.3.0"],a=this.state.feeStatus[this.state.to_withdraw.asset_id];return t&&t.hasBalance?t.fee:t&&!t.hasBalance&&a&&a.hasBalance?a.fee:t?t.fee:e}},{key:"_onInputAmount",value:function(e){try{this.state.to_withdraw.setAmount({real:parseFloat(e.target.value||0)}),this.setState({withdrawValue:e.target.value,amountError:null},this._checkBalance)}catch(e){console.error("err:",e)}}},{key:"_onInputTo",value:function(e){var t=e.target.value.trim();this.setState({withdraw_address_check_in_progress:!0,withdraw_address_selected:t,validAddress:null,toAddress:t}),this._validateAddress(t)}},{key:"_onMemoChanged",value:function(e){this.setState({memo:e.target.value},this._updateFee)}},{key:"_validateAddress",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;Object(v.j)({url:"",walletType:a.walletType,newAddress:e}).then(function(a){t.state.toAddress===e&&t.setState({withdraw_address_check_in_progress:!1,validAddress:!!a})}).catch(function(e){console.error("Error when validating address:",e)})}},{key:"_openRegistrarSite",value:function(e){e.preventDefault(),window.open(SettingsStore.site_registr,"_blank").opener=null}},{key:"_getGateFee",value:function(){var e=this.props,t=e.gateFee,a=e.asset;return new p.a({real:parseFloat(t?t.replace(",",""):0),asset_id:a.get("id"),precision:a.get("precision")})}},{key:"_renderWithdraw",value:function(){var e=this.state.amountError,t=m.a.replaceName(this.props.asset).name,a=1,n=this.props.supportsMemos,r=this._getFee(),o=this._getGateFee(),i=this.state.feeStatus[r.asset_id],l=x.b.getAsset(r.asset_id),c=i&&!i.hasBalance||this.state.balanceError||!this.state.toAddress||!this.state.withdrawValue;return s.a.createElement("div",null,s.a.createElement("p",null,s.a.createElement(u.a,{content:"gateway.withdraw_funds",asset:t})),this._renderCurrentBalance(),s.a.createElement("div",{className:"SimpleTrade__withdraw-row"},s.a.createElement("label",{className:"left-label"},y.a.translate("modal.withdraw.amount")),s.a.createElement("div",{className:"inline-label input-wrapper"},s.a.createElement("input",{tabIndex:a++,type:"number",min:"0",onKeyPress:this.onKeyPress.bind(this),value:this.state.withdrawValue,onChange:this._onInputAmount.bind(this)}),s.a.createElement("div",{className:"form-label select floating-dropdown"},s.a.createElement("div",{className:"dropdown-wrapper inactive"},s.a.createElement("div",null,t)))),e?s.a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},s.a.createElement(u.a,{content:e})):null,this.state.balanceError?s.a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},s.a.createElement(u.a,{content:"transfer.errors.insufficient"})):null),s.a.createElement("div",{className:"SimpleTrade__withdraw-row"},s.a.createElement("label",{className:"left-label"},y.a.translate("transfer.fee")),s.a.createElement("div",{className:"inline-label input-wrapper"},s.a.createElement("input",{type:"text",disabled:!0,value:r.getAmount({real:!0})}),s.a.createElement("div",{className:"form-label select floating-dropdown"},s.a.createElement("div",{className:"dropdown-wrapper inactive"},s.a.createElement("div",null,l?s.a.createElement(S.a,{name:l.get("symbol")}):null)))),i&&!i.hasBalance?s.a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},s.a.createElement(u.a,{content:"transfer.errors.insufficient"})):null),s.a.createElement("div",{className:"SimpleTrade__withdraw-row"},s.a.createElement("label",{className:"left-label"},y.a.translate("gateway.fee")),s.a.createElement("div",{className:"inline-label input-wrapper"},s.a.createElement("input",{type:"text",disabled:!0,value:o.getAmount({real:!0})}),s.a.createElement("div",{className:"form-label select floating-dropdown"},s.a.createElement("div",{className:"dropdown-wrapper inactive"},s.a.createElement("div",null,s.a.createElement(S.a,{name:this.props.asset.get("symbol")}))))),i&&!i.hasBalance?s.a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},s.a.createElement(u.a,{content:"transfer.errors.insufficient"})):null),s.a.createElement("div",{className:"SimpleTrade__withdraw-row"},s.a.createElement("label",{className:"left-label"},y.a.translate("modal.withdraw.address")),s.a.createElement("div",{className:"inline-label input-wrapper"},s.a.createElement("input",{placeholder:y.a.translate("gateway.withdraw_placeholder",{asset:t}),tabIndex:a++,type:"text",value:this.state.toAddress,onChange:this._onInputTo.bind(this)}),s.a.createElement("div",{className:"form-label select floating-dropdown"},s.a.createElement("div",{className:"dropdown-wrapper inactive"},s.a.createElement("div",{"data-place":"right","data-tip":y.a.translate("tooltip.withdraw_address",{asset:t})},"?")))),!this.state.validAddress&&this.state.toAddress?s.a.createElement("div",{className:"has-error",style:{paddingTop:10}},s.a.createElement(u.a,{content:"gateway.valid_address",coin_type:t})):null),n?s.a.createElement("div",{className:"SimpleTrade__withdraw-row"},s.a.createElement("label",{className:"left-label"},y.a.translate("transfer.memo")),s.a.createElement("div",{className:"inline-label input-wrapper"},s.a.createElement("textarea",{rows:"3",value:this.state.memo,tabIndex:a++,onChange:this._onMemoChanged.bind(this)})),!this.state.validAddress&&this.state.toAddress?s.a.createElement("div",{className:"has-error",style:{paddingTop:10}},s.a.createElement(u.a,{content:"gateway.valid_address",coin_type:t})):null):null,s.a.createElement("div",{className:"button-group SimpleTrade__withdraw-row"},s.a.createElement("button",{tabIndex:a++,className:"button"+(c?" disabled":""),onClick:this.onSubmit.bind(this),type:"submit"},s.a.createElement(u.a,{content:"gateway.withdraw_now"}))))}},{key:"_renderDeposit",value:function(){var e=this.state,t=e.receive_address,a=e.loading,n=e.emptyAddressDeposit,r=m.a.replaceName(this.props.asset).name,o=t&&"memo"in t&&t.memo,i=t&&t.address||"",l=1;return s.a.createElement("div",{className:i?"":"no-overflow"},s.a.createElement("p",null,s.a.createElement(u.a,{unsafe:!0,content:"gateway.add_funds",account:this.props.sender.get("name")})),this._renderCurrentBalance(),s.a.createElement("div",{className:"SimpleTrade__withdraw-row"},s.a.createElement("p",{style:{marginBottom:10},"data-place":"right","data-tip":y.a.translate("tooltip.deposit_tip",{asset:r})},s.a.createElement(u.a,{className:"help-tooltip",content:"gateway.deposit_to",asset:r}),":",s.a.createElement("label",{className:"fz_12 left-label"},s.a.createElement(u.a,{content:"gateway.deposit_notice_delay"}))),i?s.a.createElement("label",null,n?s.a.createElement(u.a,{content:"gateway.please_generate_address"}):s.a.createElement("span",{className:"inline-label"},s.a.createElement("input",{readOnly:!0,type:"text",value:i}),s.a.createElement(k.a,{text:i})," ")):s.a.createElement(w.a,{type:"three-bounce"}),o?s.a.createElement("label",null,s.a.createElement("span",{className:"inline-label"},s.a.createElement("input",{readOnly:!0,type:"text",value:y.a.translate("transfer.memo")+": "+t.memo}),s.a.createElement(k.a,{text:t.memo}))):null,t&&t.error?s.a.createElement("div",{className:"has-error",style:{paddingTop:10}},t.error.message):null),s.a.createElement("div",{className:"button-group SimpleTrade__withdraw-row"},s.a.createElement("button",{tabIndex:l++,className:"button spinner-button-circle",onClick:this.requestDepositAddressLoad.bind(this),type:"submit"},a?s.a.createElement(w.a,{type:"circle"}):null,s.a.createElement(u.a,{content:"gateway.generate_new"}))))}},{key:"_renderCurrentBalance",value:function(){var e=m.a.replaceName(this.props.asset).name,t="deposit"===this.props.action,a=this._getCurrentBalance(),n=a?new p.a({asset_id:a.get("asset_type"),precision:this.props.asset.get("precision"),amount:a.get("balance")}):null,r=t?s.a.createElement("span",{style:{border:"2px solid black",borderLeft:"none"},className:"form-label"},e):s.a.createElement("button",{"data-place":"right","data-tip":y.a.translate("tooltip.withdraw_full"),className:"button",style:{border:"2px solid black",borderLeft:"none"},onClick:this._updateAmount.bind(this,a?parseInt(a.get("balance"),10):0)},s.a.createElement(E.a,{name:"clippy",title:"icons.clippy.withdraw_full"}));return s.a.createElement("div",{className:"SimpleTrade__withdraw-row",style:{fontSize:"1rem"}},s.a.createElement("label",{style:{fontSize:"1rem"}},y.a.translate("gateway.balance_asset",{asset:e}),":",s.a.createElement("span",{className:"inline-label"},s.a.createElement("input",{disabled:!0,style:{color:"black",border:"2px solid black",padding:10,width:"100%"},value:n?n.getAmount({real:!0}):0}),r)))}},{key:"render",value:function(){var e=this.props,t=e.asset,a="deposit"===e.action;if(!t)return null;var n=m.a.replaceName(t).name,r=this.props.isDown?s.a.createElement("div",null,s.a.createElement(u.a,{className:"txtlabel cancel",content:"gateway.unavailable_OPEN",component:"p"})):this.props.isAvailable?a?this._renderDeposit():this._renderWithdraw():s.a.createElement("div",null,s.a.createElement(u.a,{className:"txtlabel cancel",content:"gateway.unavailable",component:"p"}));return s.a.createElement("div",{className:"SimpleTrade__modal"},s.a.createElement("div",{className:"Modal__header"},s.a.createElement("h3",null,s.a.createElement(u.a,{content:a?"gateway.deposit":"modal.withdraw.submit"})," ",n)),s.a.createElement("div",{className:"Modal__divider"}),s.a.createElement("div",{className:"grid-block vertical no-overflow",style:{zIndex:1002,paddingLeft:"2rem",paddingRight:"2rem",paddingTop:"1rem"}},r))}}]),a}();q.propTypes={sender:h.a.ChainAccount.isRequired,asset:h.a.ChainAsset.isRequired,coreAsset:h.a.ChainAsset.isRequired,globalObject:h.a.ChainAsset.isRequired},q.defaultProps={coreAsset:"1.3.0",globalObject:"2.0.0"},q=Object(d.a)(q);var I=function(e){function t(){P(this,t);var e=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={open:!1},e}return j(t,s.a.Component),N(t,[{key:"show",value:function(){var e=this;this.setState({open:!0},function(){i.a.publish(e.props.modalId,"open")})}},{key:"onClose",value:function(){this.setState({open:!1})}},{key:"render",value:function(){return this.state.open?s.a.createElement(l.a,{className:"test",onClose:this.onClose.bind(this),overlay:!0,id:this.props.modalId},this.state.open?s.a.createElement(q,O({},this.props,{open:this.state.open})):null):null}}]),t}();t.a=I}).call(this,a(30).Buffer)},7809:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(35),o=a(12),i=a(115),l=a(9),c=a(92),u=a(164),p=a(63),m=a(50),d=a.n(m),h=a(89),f=a(2),b=a.n(f),g=a(32),_=a(10),y=a(3),v=a.n(y),k=a(53),E=a.n(k),w=a(5),C=a(1),S=a.n(C),x=a(21),A=a(260),O=a.n(A),N=a(102),P=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(function(e){function t(){return T(this,t),j(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return q(t,r.a.Component),P(t,[{key:"render",value:function(){var e=this.props,t=e.baseSymbol,a=e.quoteSymbol;return r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(S.a,{content:"exchange.price"}),r.a.createElement("br",null),t?r.a.createElement("span",{className:"header-sub-title"},"(",r.a.createElement(x.a,{name:t}),"/",r.a.createElement(x.a,{name:a}),")"):null),r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(S.a,{content:"transfer.amount"}),r.a.createElement("br",null),a?r.a.createElement("span",{className:"header-sub-title"},"(",r.a.createElement(x.a,{name:a}),")"):null),r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(S.a,{content:"transaction.settlement_date"}),r.a.createElement("br",null),r.a.createElement("span",{style:{visibility:"hidden"},className:"header-sub-title"},"d"))))}}]),t}()).defaultProps={quoteSymbol:null,baseSymbol:null};var I=function(e){function t(){return T(this,t),j(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return q(t,r.a.Component),P(t,[{key:"render",value:function(){var e=this.props,t=e.base,a=e.quote,n=e.order,s=e.showSymbols,o="1.3.0"==t.get("id")?n.getPrice()/(1+n.offset_percent/1e4):n.getPrice()*(1+n.offset_percent/1e4),i=s?" "+a.get("symbol"):null;return r.a.createElement("tr",{style:{paddingRight:5}},r.a.createElement("td",{style:{textAlign:"right",width:"25%"}},w.a.format_number(o,a.get("precision"))," ",i),r.a.createElement("td",{style:{textAlign:"right",width:"25%"}},w.a.format_number(n[n.isBid()?"amountToReceive":"amountForSale"]().getAmount({real:!0}),a.get("precision"))),r.a.createElement("td",{style:{textAlign:"right",width:"25%"}},w.a.format_number(n[n.isBid()?"amountForSale":"amountToReceive"]().getAmount({real:!0}),t.get("precision"))),r.a.createElement("td",{style:{textAlign:"right",width:"25%"},className:"tooltip","data-tip":new Date(n.settlement_date)},v.a.localize(new Date(n.settlement_date),{type:"date",format:-1!==O()().toLowerCase().indexOf("en-us")?"market_history_us":"market_history"})))}}]),t}();I.defaultProps={showSymbols:!1,invert:!1};var F=function(e){function t(){return T(this,t),j(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return q(t,r.a.Component),P(t,[{key:"shouldComponentUpdate",value:function(e){return e.currentAccount!==this.props.currentAccount||e.orders!==this.props.orders}},{key:"render",value:function(){var e=this.props,t=e.orders,a=e.base,n=e.quote,s=null;if(!(t.size>0&&a&&n))return null;var o=0;return s=t.sort(function(e,t){return e.isBefore(t)?-1:1}).map(function(e){return Date.now()<e.settlement_date?r.a.createElement(I,{key:o++,order:e,base:a,quote:n}):null}).toArray(),r.a.createElement(N.a,{component:"tbody",transitionName:"newrow"},s)}}]),t}();F.defaultProps={base:{},quote:{},orders:{},quoteSymbol:"",baseSymbol:""},F.propTypes={base:b.a.object.isRequired,quote:b.a.object.isRequired,orders:b.a.object.isRequired,quoteSymbol:b.a.string.isRequired,baseSymbol:b.a.string.isRequired};var B=F,M=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var R=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),M(t,[{key:"render",value:function(){var e=this.props,t=e.price,a=e.preFormattedPrice,n=e.quote,s=e.base,o=(e.component,a||w.a.price_to_text(t,n,s));return o.full>=1?r.a.createElement("span",null,r.a.createElement("span",{className:"price-integer"},o.int,"."),o.dec?r.a.createElement("span",{className:"price-integer"},o.dec):null,o.trailing?r.a.createElement("span",{className:"price-decimal"},o.trailing):null):o.full>=.1?r.a.createElement("span",null,r.a.createElement("span",{className:"price-decimal"},o.int,"."),o.dec?r.a.createElement("span",{className:"price-integer"},o.dec):null,o.trailing?r.a.createElement("span",{className:"price-decimal"},o.trailing):null):r.a.createElement("span",null,r.a.createElement("span",{className:"price-decimal"},o.int,"."),o.dec?r.a.createElement("span",{className:"price-decimal"},o.dec):null,o.trailing?r.a.createElement("span",{className:"price-integer"},o.trailing):null)}}]),t}(),L=a(7),D=a(8),z=a.n(D),U=a(14),W=a(4),H=a(20),V=a(313),J=a(65),G=a(15),K=a(75),Q=a(45),Y=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function $(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ee=function(e){function t(e){X(this,t);var a=Z(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));a.statsInterval=null;var n=Q.a.getMarketName(e.base,e.quote).marketName;return a.state={marketName:n},a}return $(t,r.a.Component),Y(t,[{key:"_checkStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{close:{}},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{close:{}};return e.volumeBase!==t.volumeBase||!w.a.are_equal_shallow(e.close&&e.close.base,t.close&&t.close.base)||!w.a.are_equal_shallow(e.close&&e.close.quote,t.close&&t.close.quote)}},{key:"shouldComponentUpdate",value:function(e){return this._checkStats(e.allMarketStats.get(this.state.marketName),this.props.allMarketStats.get(this.state.marketName))||e.base.get("id")!==this.props.base.get("id")||e.quote.get("id")!==this.props.quote.get("id")}},{key:"componentWillMount",value:function(){g.a.getMarketStats(this.props.base,this.props.quote),this.statsChecked=new Date,this.statsInterval=setInterval(g.a.getMarketStats.bind(this,this.props.base,this.props.quote),35e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.statsInterval)}}]),t}(),te=function(e){function t(e){return X(this,t),Z(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return $(t,ee),Y(t,[{key:"shouldComponentUpdate",value:function(e){return function e(t,a,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,a,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"shouldComponentUpdate",this).call(this,e)}},{key:"render",value:function(){var e=this.props.allMarketStats,t=this.state.marketName,a=e.get(t),n=a&&a.price?a.price:null;return r.a.createElement("span",{className:z()("",this.props.className)},n?r.a.createElement(K.a,{base_amount:n.base.amount,base_asset:n.base.asset_id,quote_amount:n.quote.amount,quote_asset:n.quote.asset_id,force_direction:this.props.force_direction,hide_symbols:this.props.hide_symbols}):"n/a")}}]),t}();te=Object(J.a)(te,{propNames:["quote","base"]});var ae=function(e){function t(){return X(this,t),Z(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return $(t,r.a.Component),Y(t,[{key:"render",value:function(){return r.a.createElement(te,this.props)}}]),t}();ae=Object(G.connect)(ae,{listenTo:function(){return[s.a]},getProps:function(){return{allMarketStats:s.a.getState().allMarketStats}}});var ne=a(47),re=a.n(ne),se=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function oe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function le(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ce(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ue={textAlign:"left"},pe=function(e){function t(){return ie(this,t),le(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return ce(t,r.a.Component),se(t,[{key:"render",value:function(){var e=this.props,t=e.baseSymbol,a=e.quoteSymbol,n=e.dashboard,s=e.isMyAccount;return n?r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:ue,colSpan:"5"},r.a.createElement(S.a,{content:"exchange.description"})),r.a.createElement("th",{style:ue},r.a.createElement(S.a,{content:"exchange.price"})),r.a.createElement("th",{style:ue},r.a.createElement(S.a,{content:"exchange.price_market"})),r.a.createElement("th",{style:{textAlign:"right"}},r.a.createElement(S.a,{content:"exchange.value"})),r.a.createElement("th",null,r.a.createElement(S.a,{content:"account.trade"})),s?r.a.createElement("th",{id:"cancelAllOrders",style:{cursor:"pointer"}},r.a.createElement(S.a,{content:"wallet.cancel"})):null)):r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{textAlign:this.props.leftAlign?"left":""}},r.a.createElement(S.a,{className:"header-sub-title",content:"exchange.price"})),r.a.createElement("th",{style:this.props.leftAlign?{textAlign:"left"}:null},t?r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:a})):null),r.a.createElement("th",{style:this.props.leftAlign?{textAlign:"left"}:null},t?r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:t})):null),r.a.createElement("th",{style:{textAlign:this.props.leftAlign?"left":""}},r.a.createElement(S.a,{className:"header-sub-title",content:"transaction.expiration"})),r.a.createElement("th",null)))}}]),t}();pe.defaultProps={quoteSymbol:null,baseSymbol:null};var me=function(e){function t(){return ie(this,t),le(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return ce(t,r.a.Component),se(t,[{key:"shouldComponentUpdate",value:function(e){return e.order.for_sale!==this.props.order.for_sale||e.order.id!==this.props.order.id||e.quote!==this.props.quote||e.base!==this.props.base||e.order.market_base!==this.props.order.market_base}},{key:"render",value:function(){var e=this.props,t=e.base,a=e.quote,n=e.order,s=e.showSymbols,o=e.dashboard,i=e.isMyAccount,l=e.settings,c=n.isBid(),u=n.isCall(),p=u?"orderHistoryCall":c?"orderHistoryBid":"orderHistoryAsk",m=s?r.a.createElement("span",null," "+t.get("symbol")+"/"+a.get("symbol")):null,d=s?" "+t.get("symbol"):null,h=s?" "+a.get("symbol"):null,f=l?l.get("unit"):"1.3.0",b=c?"value positive":"value negative",g=c?"value negative":"value positive";return o?r.a.createElement("tr",{key:n.id,className:"clickable"},r.a.createElement("td",{colSpan:"5",style:ue,onClick:this.props.onFlip},c?r.a.createElement(S.a,{content:"exchange.buy_description",baseAsset:w.a.format_number(n[c?"amountToReceive":"amountForSale"]().getAmount({real:!0}),t.get("precision"),!1),quoteAsset:w.a.format_number(n[c?"amountForSale":"amountToReceive"]().getAmount({real:!0}),a.get("precision"),!1),baseName:r.a.createElement(x.a,{noTip:!0,customClass:b,name:a.get("symbol")}),quoteName:r.a.createElement(x.a,{noTip:!0,customClass:g,name:t.get("symbol")})}):r.a.createElement(S.a,{content:"exchange.sell_description",baseAsset:w.a.format_number(n[c?"amountToReceive":"amountForSale"]().getAmount({real:!0}),t.get("precision"),!1),quoteAsset:w.a.format_number(n[c?"amountForSale":"amountToReceive"]().getAmount({real:!0}),a.get("precision"),!1),baseName:r.a.createElement(x.a,{noTip:!0,customClass:b,name:a.get("symbol")}),quoteName:r.a.createElement(x.a,{noTip:!0,customClass:g,name:t.get("symbol")})})),r.a.createElement("td",{style:ue,onClick:this.props.onFlip},r.a.createElement(K.a,{base_amount:n.sellPrice().base.amount,base_asset:n.sellPrice().base.asset_id,quote_amount:n.sellPrice().quote.amount,quote_asset:n.sellPrice().quote.asset_id,force_direction:t.get("symbol"),hide_symbols:!0})),r.a.createElement("td",{style:ue,onClick:this.props.onFlip},r.a.createElement(ae,{base:t.get("id"),quote:a.get("id"),force_direction:t.get("symbol"),hide_symbols:!0,hide_asset:!0})),r.a.createElement("td",{style:{textAlign:"right"},onClick:this.props.onFlip},r.a.createElement(V.a,{hide_asset:!0,amount:n.amountForSale().getAmount(),fromAsset:n.amountForSale().asset_id,noDecimals:!0,toAsset:f})," ",r.a.createElement(x.a,{name:f})),r.a.createElement("td",null,r.a.createElement(_.b,{to:"/market/"+a.get("symbol")+"_"+t.get("symbol")},r.a.createElement(U.a,{name:"trade",title:"icons.trade.trade",className:"icon-14px"}))),i?r.a.createElement("td",{className:"text-center",style:{padding:"2px 5px"}},u?null:r.a.createElement("span",{style:{marginRight:0},className:"order-cancel"},r.a.createElement("input",{type:"checkbox",className:"orderCancel",onChange:this.props.onCheckCancel}))):null):r.a.createElement("tr",{key:n.id},r.a.createElement("td",{className:p,style:{paddingLeft:10}},r.a.createElement(R,{price:n.getPrice(),base:t,quote:a}),m),r.a.createElement("td",null,w.a.format_number(n[c?"amountToReceive":"amountForSale"]().getAmount({real:!0}),a.get("precision"))," ",h),r.a.createElement("td",null,w.a.format_number(n[c?"amountForSale":"amountToReceive"]().getAmount({real:!0}),t.get("precision"))," ",d),r.a.createElement("td",{style:{width:"25%",textAlign:"right"},className:"tooltip","data-tip":new Date(n.expiration)},u?null:v.a.localize(new Date(n.expiration),{type:"date",format:"short_custom"})),r.a.createElement("td",{className:"text-center",style:{width:"6%"}},u?null:r.a.createElement("a",{style:{marginRight:0},className:"order-cancel",onClick:this.props.onCancel},r.a.createElement(U.a,{name:"cross-circle",title:"icons.cross_circle.cancel_order",className:"icon-14px"}))))}}]),t}();me.defaultProps={showSymbols:!1};var de=function(e){function t(e){ie(this,t);var a=le(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={activeTab:e.activeTab},a._getOrders=a._getOrders.bind(a),a}return ce(t,r.a.Component),se(t,[{key:"componentDidMount",value:function(){var e=this.refs.container;e&&E.a.initialize(e)}},{key:"componentDidUpdate",value:function(){var e=this.refs.container;e&&E.a.update(e)}},{key:"_getOrders",value:function(){var e,t=this.props,a=t.currentAccount,n=t.base,r=t.quote,s=t.feedPrice,o=a.get("orders"),i=a.get("call_orders"),l=n.get("id"),c=r.get("id"),u=(oe(e={},n.get("id"),{precision:n.get("precision")}),oe(e,r.get("id"),{precision:r.get("precision")}),e),p=o.toArray().map(function(e){var t=W.b.getObject(e);if(!t)return null;var a=t.getIn(["sell_price","base","asset_id"]),n=t.getIn(["sell_price","quote","asset_id"]);return a===l&&n===c||a===c&&n===l?new H.d(t.toJS(),u,r.get("id")):void 0}).filter(function(e){return!!e}),m=i.toArray().map(function(e){try{var t=W.b.getObject(e);if(!t)return null;var a=t.getIn(["call_price","base","asset_id"]),n=t.getIn(["call_price","quote","asset_id"]);if(a===l&&n===c||a===c&&n===l)return s?new H.b(t.toJS(),u,r.get("id"),s):null}catch(e){return null}}).filter(function(e){return!!e}).filter(function(e){try{return e.isMarginCalled()}catch(e){return!1}});return p.concat(m)}},{key:"_changeTab",value:function(e){L.a.changeViewSetting({ordersTab:e}),this.setState({activeTab:e});var t=this.refs.container;t.scrollTop=0,E.a.update(t),setTimeout(re.a.rebuild,1e3)}},{key:"render",value:function(){var e=this,t=this.props,a=t.base,n=t.quote,s=t.quoteSymbol,o=t.baseSymbol,i=t.settleOrders,l=this.state.activeTab;if(!a||!n)return null;var c=void 0,u=!!(a.get("bitasset_data_id")&&i.size>0),p=!!(n.get("bitasset_data_id")&&i.size>0);if(l&&(u||p)||(l="my_orders"),"my_orders"==l){var m=this._getOrders(),d=r.a.createElement("tr",null,r.a.createElement("td",{style:{textAlign:"center"},colSpan:"5"},r.a.createElement(S.a,{content:"account.no_orders"}))),h=m.filter(function(e){return e.isBid()}).sort(function(e,t){return t.getPrice()-e.getPrice()}).map(function(t){var s=t.getPrice();return r.a.createElement(me,{price:s,key:t.id,order:t,base:a,quote:n,onCancel:e.props.onCancel.bind(e,t.id)})}),f=m.filter(function(e){return!e.isBid()}).sort(function(e,t){return e.getPrice()-t.getPrice()}).map(function(t){var s=t.getPrice();return r.a.createElement(me,{price:s,key:t.id,order:t,base:a,quote:n,onCancel:e.props.onCancel.bind(e,t.id)})}),b=[];f.length&&(b=b.concat(f)),h.length&&(b=b.concat(h)),b.sort(function(e,t){return e.props.price-t.props.price}),c=r.a.createElement(N.a,{component:"tbody",transitionName:"newrow"},b.length?b:d)}l&&"open_settlement"==l&&(c=r.a.createElement(B,{key:"settle_orders",orders:i,base:a,quote:n,baseSymbol:o,quoteSymbol:s}));var g="mymarkets-header clickable",_=z()(g,{inactive:"my_orders"!==l}),y=z()(g,{inactive:"open_settlement"!==l}),v=u||p?"50%":"100%",k=u||p?"inherit":"none",E="open_settlement"===l?this.props.className+" settle":this.props.className;return r.a.createElement("div",{key:"open_orders",className:E},r.a.createElement("div",{className:"exchange-bordered small-12"},r.a.createElement("div",{className:"grid-block shrink left-orderbook-header"},r.a.createElement("div",{style:{width:v},className:_,onClick:this._changeTab.bind(this,"my_orders")},r.a.createElement(S.a,{content:"exchange.my_orders"})),r.a.createElement("div",{style:{display:k},className:y,onClick:this._changeTab.bind(this,"open_settlement")},r.a.createElement(S.a,{content:"exchange.settle_orders"}))),r.a.createElement("div",{className:"grid-block shrink left-orderbook-header market-right-padding-only"},r.a.createElement("table",{className:"open-orders__headings table order-table text-right fixed-table market-right-padding"},"my_orders"==l?r.a.createElement(pe,{rightAlign:!0,type:"sell",baseSymbol:o,quoteSymbol:s}):r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement(S.a,{className:"header-sub-title",content:"exchange.price"})),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:s}))),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:o}))),r.a.createElement("th",null))))),r.a.createElement("div",{className:"table-container grid-block no-overflow",ref:"container",style:{overflow:"hidden",maxHeight:200,paddingRight:"0.6rem"}},r.a.createElement("table",{className:"open-orders__table table order-table text-right fixed-table market-right-padding"},c))))}}]),t}();de.defaultProps={base:{},quote:{},orders:{},quoteSymbol:"",baseSymbol:""},de.propTypes={base:b.a.object.isRequired,quote:b.a.object.isRequired,orders:b.a.object.isRequired,quoteSymbol:b.a.string.isRequired,baseSymbol:b.a.string.isRequired};var he=a(479),fe=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ge(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ye=function(e){function t(){return be(this,t),ge(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _e(t,r.a.Component),fe(t,[{key:"shouldComponentUpdate",value:function(e){return e.order.market_base===this.props.order.market_base&&(e.order.ne(this.props.order)||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount)}},{key:"render",value:function(){var e=this.props,t=e.order,n=e.quote,s=e.base,o=e.final,i=t.isBid(),l=t.isCall()?"orderHistoryCall":i?"orderHistoryBid":"orderHistoryAsk",c=a(3),u=r.a.createElement(R,{price:t.getPrice(),quote:n,base:s}),p=i?w.a.format_number(t.totalForSale().getAmount({real:!0}),8):w.a.format_number(t.totalToReceive().getAmount({real:!0}),8),m=i?w.a.format_number(t.totalToReceive().getAmount({real:!0}),8):w.a.format_number(t.totalForSale().getAmount({real:!0}),8),d=c.translate("exchange.total")+" "+n.get("symbol")+" "+m+"<br />"+c.translate("exchange.total")+" "+s.get("symbol")+" "+p;return r.a.createElement("div",{onClick:this.props.onClick,className:z()("sticky-table-row order-row vertical-table-cell",{"final-row":o},{"my-order":t.isMine(this.props.currentAccount)})},r.a.createElement("div",{className:"cell left vertical-table-cell vertical-table-cell-one"},w.a.format_number(t[i?"amountForSale":"amountToReceive"]().getAmount({real:!0}),s.get("precision"))),r.a.createElement("div",{className:"cell vertical-table-cell vertical-table-cell-two"},w.a.format_number(t[i?"amountToReceive":"amountForSale"]().getAmount({real:!0}),n.get("precision"))),r.a.createElement("div",{className:"cell "+l+" right vertical-table-cell-three","data-tip":d,"data-html":!0,"data-place":"right"},u))}}]),t}(),ve=function(e){function t(){return be(this,t),ge(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _e(t,r.a.Component),fe(t,[{key:"shouldComponentUpdate",value:function(e){return e.order.ne(this.props.order)||e.position!==this.props.position||e.index!==this.props.index||e.currentAccount!==this.props.currentAccount}},{key:"rmLeftCellActive",value:function(){var e=document.getElementsByTagName("main")[0];e.className.indexOf("left-cell-active")>-1&&(e.className=e.className.replace("left-cell-active",""))}},{key:"componentDidMount",value:function(){this.rmLeftCellActive()}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=a(3),t=this.props,n=t.order,s=t.quote,o=t.base,i=t.position,l=n.isBid(),c=n.isCall()?"orderHistoryCall":l?"orderHistoryBid":"orderHistoryAsk",u=r.a.createElement(R,{price:n.getPrice(),quote:s,base:o}),p=l?w.a.format_number(n.amountToReceive().getAmount({real:!0}),s.get("precision")):w.a.format_number(n.amountForSale().getAmount({real:!0}),s.get("precision")),m=l?w.a.format_number(n.amountForSale().getAmount({real:!0}),o.get("precision")):w.a.format_number(n.amountToReceive().getAmount({real:!0}),o.get("precision")),d=l?w.a.format_number(n.totalForSale().getAmount({real:!0}),8):w.a.format_number(n.totalToReceive().getAmount({real:!0}),8),h=l?w.a.format_number(n.totalToReceive().getAmount({real:!0}),8):w.a.format_number(n.totalForSale().getAmount({real:!0}),8),f=e.translate("exchange.total")+" "+s.get("symbol")+" "+h+"<br />"+e.translate("exchange.total")+" "+o.get("symbol")+" "+d;return r.a.createElement("tr",{onClick:this.props.onClick,className:n.isMine(this.props.currentAccount)?"my-order":""},r.a.createElement("td",{style:{width:"25%"},className:c},u),r.a.createElement("td",null,"left"===i?p:m),r.a.createElement("td",{"data-tip":f,"data-html":!0,"data-place":"right"},"left"===i?m:p))}}]),t}(),ke=function(e){function t(e){be(this,t);var a=ge(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.queryStickyTable=function(e){return a.refs.vertical_sticky_table_up.table.querySelector(e)},a.verticalScrollBar=function(){return a.queryStickyTable("#y-scrollbar")},a.toggleSpreadValue=function(){a.setState({displaySpreadAsPercentage:!a.state.displaySpreadAsPercentage})},a.toggleAutoScroll=function(){var e={autoScroll:!a.state.autoScroll};e.autoScroll||a.setState(e)},a.state={flip:e.flipOrderBook,showAllBids:!1,showAllAsks:!1,rowCount:50,autoScroll:!0},a}return _e(t,r.a.Component),fe(t,[{key:"addLeftCellActive",value:function(){var e=document.getElementsByTagName("main")[0];-1===e.className.indexOf("left-cell-active")&&(e.className+=" left-cell-active")}},{key:"addLeftCellActive",value:function(){var e=document.getElementsByTagName("main")[0];-1===e.className.indexOf("left-cell-active")&&(e.className+=" left-cell-active")}},{key:"updateCeilWith",value:function(){function e(e,t){var a=document.getElementsByClassName(e);for(var n in a)try{a[n].style.width=t+"px"}catch(e){}}function t(e){var t=0,a=document.getElementsByClassName(e);for(var n in a){var r=a[n].offsetWidth;r>t&&(t=r)}return t}var a="vertical-table-cell-one",n="vertical-table-cell-two",r="vertical-table-cell-three",s={one:t(a),two:t(n),three:t(r)};e(a,s.one),e(n,s.two),e(r,s.three);var o=0;try{o=s.one+s.two+s.three-4,document.getElementsByClassName("container-menu-header")[0].style.marginLeft=o+"px"}catch(e){}try{var i="exchange_header_style",l="@media only screen and (min-width: 1000px) { body.localcoin .exchange-layout .grid-block.shrink.no-padding.overflow-visible.top-bar, body.localcoin .exchange-layout .main .grid-block.shrink.no-padding.overflow-visible.top-bar.left-cell-active { width: calc(100% - "+(o+t("right-column"))+"px); }}";if(document.getElementById(i)){document.getElementById(i).innerHTML=l}else{var c=document.createElement("style");c.id=i,c.innerHTML=l,document.getElementsByTagName("head")[0].appendChild(c)}}catch(e){}}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.base.get("id")===this.props.base.get("id")&&e.quote.get("id")===this.props.quote.get("id")||(this.refs.askTransition&&(this.refs.askTransition.resetAnimation(),this.refs.hor_asks&&(this.refs.hor_asks.scrollTop=0),this.refs.hor_bids&&(this.refs.hor_bids.scrollTop=0)),this.refs.bidTransition&&this.refs.bidTransition.resetAnimation(),this.refs.vert_bids&&(this.refs.vert_bids.scrollTop=0),this.props.horizontal||this.setState({autoScroll:!0})),w.a.are_equal_shallow(e.combinedAsks,this.props.combinedAsks)&&w.a.are_equal_shallow(e.combinedBids,this.props.combinedBids)||this.setState({},function(){t.psUpdate()}),this.props.horizontal||this.addLeftCellActive()}},{key:"componentDidUpdate",value:function(){if(!this.props.horizontal){var e=this;document.delayedExecution.add("orderBook_componentDidUpdate",function(){e.updateCeilWith()},100)}}},{key:"componentDidMount",value:function(){if(re.a.rebuild(),document.fastLoader.hide(),this.props.horizontal){var e=this.refs.hor_bids;E.a.initialize(e);var t=this.refs.hor_asks;E.a.initialize(t)}else{var a=this;document.delayedExecution.add("orderBook_componentDidUpdate",function(){a.updateCeilWith(),a.addLeftCellActive()},100);var n=this.refs.vertical_sticky_table_up.table.querySelector("#y-scrollbar");E.a.initialize(n);var r=this.refs.vertical_sticky_table_down.table.querySelector("#y-scrollbar");E.a.initialize(r)}this.upVerticalBlockToEndScroll()}},{key:"componentWillUpdate",value:function(){}},{key:"upVerticalBlockToEndScroll",value:function(){this.props.horizontal||(this.queryStickyTable("#sticky-table-y-wrapper").scrollTop=99999)}},{key:"psUpdate",value:function(){if(this.props.horizontal){var e=this.refs.hor_bids;E.a.update(e);var t=this.refs.hor_asks;E.a.update(t)}else;}},{key:"_flipBuySell",value:function(){L.a.changeViewSetting({flipOrderBook:!this.state.flip}),this.setState({flip:!this.state.flip})}},{key:"_onToggleShowAll",value:function(e){"asks"===e?(this.setState({showAllAsks:!this.state.showAllAsks}),this.state.showAllAsks&&(this.refs.hor_asks.scrollTop=0)):(this.setState({showAllBids:!this.state.showAllBids}),this.state.showAllBids&&(this.refs.hor_bids.scrollTop=0))}},{key:"render",value:function(){var e=this,t=this.props,n=t.combinedBids,s=t.combinedAsks,o=t.highestBid,i=t.lowestAsk,l=t.quote,c=t.base,u=t.totalAsks,p=t.totalBids,m=t.quoteSymbol,d=t.baseSymbol,h=t.horizontal,f=this.state,b=f.showAllAsks,g=f.showAllBids,_=f.rowCount,y=f.displaySpreadAsPercentage,v=!i.sell_price&&!o.sell_price,k=!(!i.sell_price||!o.sell_price)&&(y?(100*(i._real_price/o._real_price-1)).toFixed(2)+"%":r.a.createElement(R,{price:i._real_price-o._real_price,base:c,quote:l})),E=null,C=null;if(c&&l){E=n.map(function(t,a){if(!(a>100))return h?r.a.createElement(ve,{index:a,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:e.props.onClick.bind(e,t),base:c,quote:l,position:e.state.flip?"left":"right",currentAccount:e.props.currentAccount}):r.a.createElement(ye,{index:a,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:e.props.onClick.bind(e,t),base:c,quote:l,final:0===a,currentAccount:e.props.currentAccount})});var A=s;A.sort(function(e,t){return h?e.getPrice()-t.getPrice():t.getPrice()-e.getPrice()}),C=A.map(function(t,a){if(!(a>100))return h?r.a.createElement(ve,{index:a,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:e.props.onClick.bind(e,t),base:c,quote:l,type:t.type,position:e.state.flip?"left":"right",currentAccount:e.props.currentAccount}):r.a.createElement(ye,{index:a,key:t.getPrice()+(t.isCall()?"_call":""),order:t,onClick:e.props.onClick.bind(e,t),base:c,quote:l,type:t.type,final:0===a,currentAccount:e.props.currentAccount})})}if(this.props.horizontal){try{if(document.getElementsByClassName("container-menu-header").length>0){var O=document.getElementsByClassName("container-menu-header")[0],P=O.className.toString();-1!==P.indexOf("left-cell-active")&&(O.className=P.replace(/left-cell-active/gi,""))}}catch(e){}g||E.splice(_,E.length),b||C.splice(_,C.length);var T=r.a.createElement("thead",null,r.a.createElement("tr",{key:"top-header",className:"top-header"},r.a.createElement("th",null,r.a.createElement(S.a,{className:(this.state.flip?"ask-total":"bid-total")+" header-sub-title",content:"exchange.price"})),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:d}))),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:m}))))),j=r.a.createElement("thead",null,r.a.createElement("tr",{key:"top-header",className:"top-header"},r.a.createElement("th",null,r.a.createElement(S.a,{className:(this.state.flip?"bid-total":"ask-total")+" header-sub-title",content:"exchange.price"})),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:m}))),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:d}))))),q=a(3);return r.a.createElement("div",{className:z()(this.props.wrapperClass,"grid-block orderbook no-padding small-vertical medium-horizontal align-spaced no-overflow small-12 xlarge-8")},r.a.createElement("div",{className:z()("small-12 medium-6 middle-content",this.state.flip?"order-1":"order-2")},r.a.createElement("div",{className:"exchange-bordered"},r.a.createElement("div",{className:"exchange-content-header ask","data-intro":q.translate("walkthrough.sell_orders")},r.a.createElement(S.a,{content:"exchange.asks"}),this.state.flip?r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("span",{onClick:this._flipBuySell.bind(this),style:{cursor:"pointer",fontSize:"1rem",marginLeft:"4px",position:"relative",top:"-2px"},className:"flip-arrow"}," ","⇆"),r.a.createElement("span",{className:"order-book-button-v",onClick:this.props.moveOrderBook},r.a.createElement(U.a,{name:"thumb-tack",title:"icons.thumb_tack",className:"icon-14px"}))):null,r.a.createElement("div",{style:{lineHeight:"16px"},className:"float-right header-sub-title"},r.a.createElement(S.a,{content:"exchange.total"}),r.a.createElement("span",null,": "),w.a.format_number(u,l.get("precision")),r.a.createElement("span",null," ","(",r.a.createElement(x.a,{name:m}),")"))),r.a.createElement("div",{style:{paddingRight:"0.6rem"}},r.a.createElement("table",{className:"table order-table table-hover fixed-table text-right"},this.state.flip?j:T)),r.a.createElement("div",{className:"grid-block",ref:"hor_asks",style:{paddingRight:"0.6rem",overflow:"hidden",maxHeight:210}},r.a.createElement("table",{style:{paddingBottom:5},className:"table order-table table-hover fixed-table text-right no-overflow"},r.a.createElement(N.a,{ref:"askTransition",className:"orderbook clickable",component:"tbody",transitionName:"newrow"},C)),50>_?r.a.createElement("div",{className:"orderbook-showall"},r.a.createElement("a",{onClick:this._onToggleShowAll.bind(this,"asks")},r.a.createElement(S.a,{content:b?"exchange.hide":"exchange.show_asks"}),b?null:r.a.createElement("span",null," ","(",50,")"))):null))),r.a.createElement("div",{className:z()("small-12 medium-6 middle-content",this.state.flip?"order-2":"order-1")},r.a.createElement("div",{className:"exchange-bordered"},r.a.createElement("div",{className:"exchange-content-header bid","data-intro":q.translate("walkthrough.buy_orders")},r.a.createElement(S.a,{content:"exchange.bids"}),this.state.flip?null:r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("span",{onClick:this._flipBuySell.bind(this),style:{cursor:"pointer",fontSize:"1rem",marginLeft:"4px",position:"relative",top:"-2px"},className:"flip-arrow"}," ","⇆"),r.a.createElement("span",{className:"order-book-button-v",onClick:this.props.moveOrderBook},r.a.createElement(U.a,{name:"thumb-tack",title:"icons.thumb_tack",className:"icon-14px"}))),r.a.createElement("div",{style:{lineHeight:"16px"},className:"float-right header-sub-title"},r.a.createElement(S.a,{content:"exchange.total"}),r.a.createElement("span",null,": "),w.a.format_number(p,c.get("precision")),r.a.createElement("span",null," ","(",r.a.createElement(x.a,{name:d}),")"))),r.a.createElement("div",{style:{paddingRight:"0.6rem"}},r.a.createElement("table",{className:"table order-table table-hover fixed-table text-right"},this.state.flip?j:T)),r.a.createElement("div",{className:"grid-block",ref:"hor_bids",style:{paddingRight:"0.6rem",overflow:"hidden"}},r.a.createElement("table",{style:{paddingBottom:5},className:"table order-table table-hover fixed-table text-right no-overflow"},r.a.createElement(N.a,{ref:"bidTransition",className:"orderbook clickable",component:"tbody",transitionName:"newrow"},E)),50>_?r.a.createElement("div",{className:"orderbook-showall"},r.a.createElement("a",{onClick:this._onToggleShowAll.bind(this,"bids")},r.a.createElement(S.a,{content:g?"exchange.hide":"exchange.show_bids"}),g?null:r.a.createElement("span",null," ","(",50,")"))):null))))}if(document.getElementsByClassName("container-menu-header").length>0){var I=document.getElementsByClassName("container-menu-header")[0];-1===I.className.indexOf("left-cell-active")&&(I.className+=" left-cell-active")}return r.a.createElement("div",{className:"left-order-book no-padding"},r.a.createElement("div",{className:"order-table-container exchange-sell-orders vertical-orderbook-up"},r.a.createElement(he.StickyTable,{className:"order-table table",ref:"vertical_sticky_table_up"},r.a.createElement("div",{className:"custom-sticky-header-wrap"},r.a.createElement("div",{className:"header-cell left vertical-table-cell-one custom-sticky-header"},r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{name:d,dataPlace:"bottom",dataClass:"test"}))),r.a.createElement("div",{className:"header-cell vertical-table-cell-two custom-sticky-header"},r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{name:m}))),r.a.createElement("div",{className:" header-cell right vertical-table-cell-three custom-sticky-header"},r.a.createElement(S.a,{className:"header-sub-title",content:"exchange.price"}))),r.a.createElement("div",{class:"custom-sticky-table-wrap"},r.a.createElement(N.a,{ref:"askTransition",className:"transition-container clickable",component:"div",transitionName:"newrow"},C.length>0?C:v||r.a.createElement("div",{className:"sticky-table-row"},r.a.createElement("td",{className:"cell no-orders padtop",colSpan:"3"},"No asks")))))),r.a.createElement("div",{className:"sticky-table-row exchange-sell-buy-orders",ref:"center_text"},v?r.a.createElement("td",{colSpan:3,className:"no-orders padtop"},r.a.createElement(S.a,{content:"exchange.no_orders"})):r.a.createElement("td",{className:"cell center-cell",colSpan:"3"},r.a.createElement("div",{className:"orderbook-latest-price"},r.a.createElement("div",{className:"text-center spread"},!!k&&r.a.createElement("span",{className:"left"},r.a.createElement(S.a,{className:"spread-label",content:"exchange.spread"})," ",r.a.createElement("span",{className:"spread-value"},k,"(",(100*(i._real_price/o._real_price-1)).toFixed(2),"%)")),"  ",!!this.props.latest&&r.a.createElement("span",{className:"right"},r.a.createElement(S.a,{className:"latest-label",content:"exchange.latest"})," ",r.a.createElement("span",{className:this.props.changeClass},r.a.createElement(R,{preFormattedPrice:this.props.latest}))))))),r.a.createElement("div",{className:"order-table-container exchange-buy-orders vertical-orderbook-down"},r.a.createElement(he.StickyTable,{className:"order-table table",ref:"vertical_sticky_table_down"},r.a.createElement("div",{className:"sticky-table-row top-header"},r.a.createElement("div",{className:"cell header-cell left"},r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{name:d}))),r.a.createElement("div",{className:"cell header-cell"},r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{name:m}))),r.a.createElement("div",{className:"cell header-cell right"},r.a.createElement(S.a,{className:"header-sub-title",content:"exchange.price"}))),r.a.createElement(N.a,{ref:"bidTransition",className:"transition-container clickable",component:"div",transitionName:"newrow"},E.length>0?E:v||r.a.createElement("div",{className:"sticky-table-row"},r.a.createElement("td",{className:"cell no-orders",colSpan:"3"},r.a.createElement(S.a,{content:"exchange.no_bids"})))))),r.a.createElement("div",{className:"v-align no-padding align-center grid-block footer shrink bottom-header pin"},r.a.createElement("div",{onClick:this.props.moveOrderBook},r.a.createElement(U.a,{name:"thumb-untack",title:"icons.thumb_untack",className:"icon-14px order-book-button-h"}))))}}]),t}();ke.defaultProps={bids:[],asks:[],orders:{}},ke.propTypes={bids:b.a.array.isRequired,asks:b.a.array.isRequired,orders:b.a.object.isRequired};var Ee=ke,we=a(6),Ce=a.n(we),Se=a(81),xe=a(163),Ae=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Oe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Ae(t,[{key:"componentWillMount",value:function(){this.props.block||xe.a.getBlock(this.props.block_number)}},{key:"shouldComponentUpdate",value:function(e){return e.block&&!this.props.block&&setTimeout(re.a.rebuild,1e3),e.block!==this.props.block}},{key:"render",value:function(){var e=this.props,t=e.block,a=e.tooltip,n=e.component;e.format;return t?r.a.createElement(n,{className:a?"tooltip":"","data-place":"right","data-tip":a?t.timestamp.toLocaleDateString():""},r.a.createElement("span",null,t.timestamp.toLocaleTimeString())):r.a.createElement(n)}}]),t}();Oe.defaultProps={format:-1!==O()().toLowerCase().indexOf("en-us")?"market_history_us":"market_history",tooltip:!1,component:"span"};var Ne=Oe=Object(G.connect)(Oe,{listenTo:function(){return[Se.a]},getProps:function(e){return{block:Se.a.getState().blocks.get(e.block_number)}}}),Pe=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Te=W.c.operations,je=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={activeTab:e.viewSettings.get("historyTab","history")},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Pe(t,[{key:"shouldComponentUpdate",value:function(e,t){return!Ce.a.is(e.history,this.props.history)||e.baseSymbol!==this.props.baseSymbol||e.quoteSymbol!==this.props.quoteSymbol||e.className!==this.props.className||t.activeTab!==this.state.activeTab||e.currentAccount!==this.props.currentAccount}},{key:"componentDidMount",value:function(){var e=this.refs.history;E.a.initialize(e)}},{key:"componentDidUpdate",value:function(){var e=this.refs.history;E.a.update(e)}},{key:"_changeTab",value:function(e){L.a.changeViewSetting({historyTab:e}),this.setState({activeTab:e});var t=this.refs.history;t.scrollTop=0,E.a.update(t),setTimeout(re.a.rebuild,1e3)}},{key:"render",value:function(){var e=this.props,t=e.history,a=e.myHistory,n=e.base,s=e.quote,o=e.baseSymbol,i=e.quoteSymbol,l=e.isNullAccount,c=this.state.activeTab,u=null;if(l&&(c="history"),"my_history"===c&&a&&a.size){var p=-1,m=n.get("id").split(".")[2]>s.get("id").split(".")[2];u=a.filter(function(e){return e.getIn(["op",0])===Te.fill_order}).filter(function(e){var t=s.get("id"),a=n.get("id"),r=e.getIn(["op",1,"pays","asset_id"]),o=e.getIn(["op",1,"receives","asset_id"]);return(t===r||t===o)&&(a===r||a===o)}).sort(function(e,t){return t.get("block_num")-e.get("block_num")}).map(function(e){var t=e.toJS().op[1];p++;var a=void 0,o=void 0,i=!1;t.pays.asset_id===n.get("id")?(a=n,o=s,i=!0):(a=s,o=n);var l=Q.a.parse_order_history(t,a,o,i,m),c=e.get("block_num");return r.a.createElement("tr",{key:"my_history_"+p},r.a.createElement("td",{className:l.className},r.a.createElement(R,{preFormattedPrice:l})),r.a.createElement("td",null,l.receives),r.a.createElement("td",null,l.pays),r.a.createElement(Ne,{component:"td",block_number:c,tooltip:!0}))}).toArray()}else if(t&&t.size){var d=0,h=-1,f=n.get("id").split(".")[2]>s.get("id").split(".")[2];u=this.props.history.filter(function(){return++d%2==0}).take(100).map(function(e){h++;var t=void 0,a=void 0,o=!1;e.pays.asset_id===n.get("id")?(t=n,a=s,o=!0):(t=s,a=n);var i=Q.a.parse_order_history(e,t,a,o,f);return r.a.createElement("tr",{key:"history_"+h},r.a.createElement("td",{className:i.className},r.a.createElement(R,{preFormattedPrice:i})),r.a.createElement("td",null,i.receives),r.a.createElement("td",null,i.pays),r.a.createElement("td",{"data-place":"right",className:"tooltip","data-tip":new Date(e.time).toLocaleDateString()},new Date(e.time).toLocaleTimeString()))}).toArray()}var b="mymarkets-header clickable",g=z()(b,{inactive:"my_history"===c}),_=z()(b,{inactive:"history"===c});return r.a.createElement("div",{className:this.props.className},r.a.createElement("div",{className:"exchange-bordered small-12",style:{height:266}},r.a.createElement("div",{style:this.props.headerStyle,className:"grid-block shrink left-orderbook-header bottom-header"},r.a.createElement("div",{className:z()(_,{disabled:l}),onClick:this._changeTab.bind(this,"my_history")},r.a.createElement(S.a,{content:"exchange.my_history"})),r.a.createElement("div",{className:g,onClick:this._changeTab.bind(this,"history")},r.a.createElement(S.a,{content:"exchange.history"}))),r.a.createElement("div",{className:"grid-block shrink left-orderbook-header market-right-padding-only"},r.a.createElement("table",{className:"table order-table text-right fixed-table market-right-padding"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement(S.a,{className:"header-sub-title",content:"exchange.price"})),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:i}))),r.a.createElement("th",null,r.a.createElement("span",{className:"header-sub-title"},r.a.createElement(x.a,{dataPlace:"top",name:o}))),r.a.createElement("th",null,r.a.createElement(S.a,{className:"header-sub-title",content:"explorer.block.date"})))))),r.a.createElement("div",{className:"table-container grid-block market-right-padding-only no-overflow",ref:"history",style:{maxHeight:336,overflow:"hidden"}},r.a.createElement("table",{className:"table order-table text-right fixed-table market-right-padding"},r.a.createElement(N.a,{component:"tbody",transitionName:"newrow"},u)))))}}]),t}();je.defaultProps={history:[]},je.propTypes={history:b.a.object.isRequired};var qe=Object(G.connect)(je,{listenTo:function(){return[l.a]},getProps:function(){return{viewSettings:l.a.getState().viewSettings}}}),Ie=a(339),Fe=a(31),Be=a(11),Me=a(17),Re=a(553),Le=a(273),De=a(94),ze=a(554),Ue=a.n(ze),We=a(42),He=a.n(We),Ve=(a(97),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}),Je=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Ge=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Je(t,[{key:"componentDidMount",value:function(){this.props.checkMarketFee&&this.props.checkMarketFee(!!document.querySelector(".market-fee"))}},{key:"shouldComponentUpdate",value:function(e){return e.amount!==this.props.amount||e.onBorrow!==this.props.onBorrow||e.total!==this.props.total||e.currentPrice!==this.props.currentPrice||e.price!==this.props.price||e.balance!==this.props.balance||e.account!==this.props.account||e.className!==this.props.className||!(!e.fee||!this.props.fee)&&e.fee.ne(this.props.fee)||e.isPredictionMarket!==this.props.isPredictionMarket||e.feeAsset!==this.props.feeAsset||e.isOpen!==this.props.isOpen||e.hasFeeBalance!==this.props.hasFeeBalance||e.expirationType!==this.props.expirationType||e.expirationCustomTime!==this.props.expirationCustomTime}},{key:"_addBalance",value:function(e){"bid"===this.props.type?this.props.totalChange({target:{value:e.getAmount({real:!0}).toString()}}):this.props.amountChange({target:{value:e.getAmount({real:!0}).toString()}})}},{key:"_setPrice",value:function(e){this.props.priceChange({target:{value:e.toString()}})}},{key:"_onDeposit",value:function(e){e.preventDefault(),this.refs.deposit_modal.show()}},{key:"_onBuy",value:function(e){e.preventDefault(),this.refs.bridge_modal.show()}},{key:"render",value:function(){var e=this,t=this.props,n=t.type,s=t.quote,o=t.base,i=t.amountChange,c=t.fee,u=t.isPredictionMarket,p=t.priceChange,m=t.onSubmit,d=t.balance,h=t.totalChange,f=t.balancePrecision,b=t.currentPrice,g=t.currentPriceObject,_=t.feeAsset,y=t.feeAssets,k=t.hasFeeBalance,E=t.backedCoin,C=void 0,A=void 0,O=void 0,N=this.props.isOpen?r.a.createElement("span",null,"▼"):r.a.createElement("span",null,"▲");this.props.amount&&(C=this.props.amount),this.props.price&&(A=this.props.price),this.props.total&&(O=this.props.total);var P=new H.a({amount:d?d.get("balance"):0,precision:f,asset_id:this.props.balanceId}),T=new H.a({amount:o.getIn(["options","max_market_fee"]),asset_id:o.get("asset_id"),precision:o.get("precision")}),j=new H.a({amount:s.getIn(["options","max_market_fee"]),asset_id:s.get("asset_id"),precision:s.get("precision")}),q=o.getIn(["options","market_fee_percent"])/100+"%",I=s.getIn(["options","market_fee_percent"])/100+"%",F=C?Math.min(j.getAmount({real:!0}),C*s.getIn(["options","market_fee_percent"])/1e4).toFixed(j.precision):0,B=C?Math.min(T.getAmount({real:!0}),O*o.getIn(["options","market_fee_percent"])/1e4).toFixed(T.precision):0,M=De.a.getFlagBooleans(o.getIn(["options","flags"]),o.has("bitasset_data_id")),L=De.a.getFlagBooleans(s.getIn(["options","flags"]),s.has("bitasset_data_id")),D=w.a.replaceName(this.props.base),W=D.name,V=D.prefix,J=M.charge_market_fee||L.charge_market_fee,G=M.charge_market_fee?r.a.createElement("div",{className:"grid-block no-padding buy-sell-row market-fee"},r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-label"},r.a.createElement(S.a,{content:"explorer.asset.summary.market_fee"}),": ",q),r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-input"},r.a.createElement("input",{disabled:!0,type:"text",id:"baseMarketFee",value:B,autoComplete:"off"})),r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-box"},r.a.createElement(x.a,{noTip:!0,name:o.get("symbol")}),r.a.createElement("span",{"data-tip":v.a.translate("tooltip.market_fee",{percent:o.getIn(["options","market_fee_percent"])/100,asset:(V||"")+W}),className:"inline-block tooltip"}," ",r.a.createElement(U.a,{style:{position:"relative",top:3},name:"question-circle",title:"icons.question_circle"})))):J?r.a.createElement("div",{className:"grid-block no-padding buy-sell-row "},r.a.createElement("div",{style:{visibility:"hidden"},className:"grid-block small-3 no-margin no-overflow buy-sell-label"},r.a.createElement(S.a,{content:"explorer.asset.summary.market_fee"}),":")):null,K=w.a.replaceName(this.props.quote),Q=K.name,Y=K.prefix,X=L.charge_market_fee?r.a.createElement("div",{className:"grid-block no-padding buy-sell-row market-fee"},r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-label"},r.a.createElement(S.a,{content:"explorer.asset.summary.market_fee"}),": ",I),r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-input"},r.a.createElement("input",{disabled:!0,type:"text",id:"quoteMarketFee",value:F,autoComplete:"off"})),r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-box"},r.a.createElement(x.a,{noTip:!0,name:s.get("symbol")}),r.a.createElement("span",{"data-tip":v.a.translate("tooltip.market_fee",{percent:s.getIn(["options","market_fee_percent"])/100,asset:(Y||"")+Q}),className:"inline-block tooltip"}," ",r.a.createElement(U.a,{style:{position:"relative",top:3},name:"question-circle",title:"icons.question-circle"})))):J?r.a.createElement("div",{className:"grid-block no-padding buy-sell-row"},r.a.createElement("div",{style:{visibility:"hidden"},className:"grid-block small-3 no-margin no-overflow buy-sell-label"},r.a.createElement(S.a,{content:"explorer.asset.summary.market_fee"}),":")):null,Z="bid"===n,$=Z&&X?X:!Z&&G?G:null,ee=Z?P.getAmount({real:!0})>=parseFloat(O):P.getAmount({real:!0})>=parseFloat(C),te=u?v.a.translate("exchange.short"):Z?v.a.translate("exchange.buy"):v.a.translate("exchange.sell"),ae=Z?v.a.translate("exchange.buy"):v.a.translate("exchange.sell"),ne=!u&&!(P.getAmount()>0&&ee),re=!(A>0),se=!(C>0),oe=ne||re||se,ie=z()("button buySellButton",n,{disabled:oe}),le=Z?o.get("symbol"):s.get("symbol"),ce=re?v.a.translate("exchange.invalid_price"):se?v.a.translate("exchange.invalid_amount"):ne?v.a.translate("exchange.no_balance"):null;y[1]&&"1.3.0"===y[1].getIn(["options","core_exchange_rate","quote","asset_id"])&&"1.3.0"===y[1].getIn(["options","core_exchange_rate","base","asset_id"])&&(_=y[0],y.splice(1,1));var ue=0,pe=y.map(function(e){var t=w.a.replaceName(e),a=t.name,n=t.prefix;return r.a.createElement("option",{key:e.get("id"),value:ue++},n,a)}),me=void 0;me=_.get("symbol")===le?P.clone(P.getAmount()-c.getAmount()):P;var de=w.a.replaceName(this.props[Z?"base":"quote"]),he=(de.name,de.prefix,a(3)),fe=null;"bid"==n&&(fe=he.translate("walkthrough.buy_form")),"ask"==n&&(fe=he.translate("walkthrough.sell_form"));var be=Object.keys(this.props.expirations).map(function(t,a){return r.a.createElement("option",{value:t,key:t},e.props.expirations[t].title)}),ge=l.a.getState().settings.get("themes"),_e=He()(),ye="LLC"===o.get("symbol")||"LLC"===s.get("symbol");return r.a.createElement("div",{className:this.props.className},r.a.createElement("div",{className:"exchange-bordered buy-sell-container"},r.a.createElement("div",{className:"exchange-content-header "+n,"data-intro":fe},r.a.createElement("span",null,r.a.createElement(Fe.a,{string:"exchange.buysell_formatter",noLink:!0,noTip:!1,keys:[{type:"asset",value:s.get("symbol"),arg:"asset"},{type:"translate",value:u?"exchange.short":Z?"exchange.buy":"exchange.sell",arg:"direction"}]})),this.props.onFlip?r.a.createElement("span",{onClick:this.props.onFlip,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇆"):"null",this.props.onTogglePosition?r.a.createElement("span",{onClick:this.props.onTogglePosition,style:{cursor:"pointer",fontSize:"1rem"},className:"flip-arrow"}," ","⇅"):"null",r.a.createElement("div",{onClick:this.props.onToggleOpen,className:"float-right clickable hide-for-xlarge",style:{paddingLeft:10}},N),r.a.createElement("div",{className:"ml-auto"},ye&&"LLC"!==this.props[Z?"base":"quote"].get("symbol")?r.a.createElement("div",{className:"float-right buy-sell-deposit"},r.a.createElement("a",{onClick:this.props.onShowModal},r.a.createElement(Fe.a,{string:"exchange.buysell_formatter",noLink:!0,noTip:!0,keys:[{type:"asset",value:this.props[Z?"quote":"base"].get("symbol"),arg:"asset"},{type:"translate",value:"exchange.buy",arg:"direction"}]}))):null,null,this.props.onBorrow?r.a.createElement("div",{className:"float-right buy-sell-deposit"},r.a.createElement("a",{onClick:this.props.onBorrow},r.a.createElement(Fe.a,{string:"exchange.buysell_formatter",noLink:!0,keys:[{type:"asset",value:this.props[Z?"base":"quote"].get("symbol"),arg:"asset"},{type:"translate",value:"exchange.borrow",arg:"direction"}]}))):null)),r.a.createElement("form",{className:(this.props.isOpen?"":"hide-container ")+"order-form",noValidate:!0},r.a.createElement("div",{className:"grid-block vertical no-overflow no-padding"},r.a.createElement("div",{className:"grid-block no-padding buy-sell-row"},r.a.createElement("div",{className:"grid-block small-3 no-margin no-overflow buy-sell-label"},r.a.createElement(S.a,{content:"exchange.price"})," ",r.a.createElement(x.a,{dataPlace:"right",name:s.get("symbol")}),":"),r.a.createElement("div",{className:"grid-block small-5 no-margin no-overflow buy-sell-input"},r.a.createElement(Le.b,{id:n+"Price",value:A,onChange:p,autoComplete:"off",placeholder:"0.0"})),r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-box"},r.a.createElement(x.a,{dataPlace:"right",name:o.get("symbol")}))),r.a.createElement("div",{className:"grid-block no-padding buy-sell-row"},r.a.createElement("div",{className:"grid-block small-3 no-margin no-overflow buy-sell-label"},r.a.createElement(S.a,{content:"transfer.amount"}),":"),r.a.createElement("div",{className:"grid-block small-5 no-margin no-overflow buy-sell-input"},r.a.createElement(Le.b,{id:n+"Amount",value:C,onChange:i,autoComplete:"off",placeholder:"0.0"})),r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-box"},r.a.createElement(x.a,{dataPlace:"right",name:s.get("symbol")}))),r.a.createElement("div",{className:"grid-block buy-sell-row bottom-row"},r.a.createElement("div",{className:"grid-block small-3 no-margin no-overflow buy-sell-label"},r.a.createElement(S.a,{content:"exchange.total"}),":"),r.a.createElement("div",{className:"grid-block small-5 no-margin no-overflow buy-sell-input"},r.a.createElement(Le.b,{id:n+"Total",value:O,onChange:h,autoComplete:"off",placeholder:"0.0"})),r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-box"},r.a.createElement(x.a,{dataPlace:"right",name:o.get("symbol")}))),r.a.createElement("div",{className:"grid-block no-padding buy-sell-row"},r.a.createElement("div",{className:"grid-block small-3 no-margin no-overflow buy-sell-label"},r.a.createElement(S.a,{content:"transfer.fee"}),":"),r.a.createElement("div",{className:"grid-block small-5 no-margin no-overflow buy-sell-input"},r.a.createElement("input",{className:k?"":"no-balance",disabled:!0,type:"text",id:n+"Fee",value:k?c.getAmount({real:!0}):v.a.translate("transfer.errors.insufficient"),autoComplete:"off"})),r.a.createElement("div",{className:"grid-block small-4 no-margin no-overflow buy-sell-box",style:{paddingLeft:1!==y.length?0:5}},r.a.createElement("select",{style:1===y.length?{background:"none"}:null,disabled:1===y.length,value:y.indexOf(this.props.feeAsset),className:"form-control"+(1!==y.length?" buysell-select":""),onChange:this.props.onChangeFeeAsset},pe))),$),r.a.createElement("div",null,r.a.createElement("div",{className:"grid-content clear-fix no-padding"},r.a.createElement("table",{className:"float-left"},r.a.createElement("tbody",null,r.a.createElement("tr",{className:"buy-sell-info"},r.a.createElement("td",null,r.a.createElement(S.a,{content:"exchange.balance"}),":"),r.a.createElement("td",{style:{paddingLeft:5,textAlign:"right"}},r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this._addBalance.bind(this,me)},w.a.format_number(P.getAmount({real:!0}),f)," ",r.a.createElement(x.a,{name:le})))),r.a.createElement("tr",{className:"buy-sell-info"},r.a.createElement("td",{style:{paddingTop:5}},Z?r.a.createElement(S.a,{content:"exchange.lowest_ask"}):r.a.createElement(S.a,{content:"exchange.highest_bid"}),": "),b?r.a.createElement("td",{style:{paddingLeft:5,textAlign:"right",paddingTop:5,verticalAlign:"bottom"}},r.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.props.setPrice.bind(this,n,g.sellPrice())},r.a.createElement(R,{price:b,quote:s,base:o})," ",r.a.createElement(x.a,{name:o.get("symbol")}),"/",r.a.createElement(x.a,{name:s.get("symbol")}))):null),r.a.createElement("tr",{className:"buy-sell-info"},r.a.createElement("td",{style:{paddingTop:5}},r.a.createElement(S.a,{content:"transaction.expiration"}),":"),r.a.createElement("td",{className:"expiration-datetime-picker"},r.a.createElement("select",{onChange:this.props.onExpirationTypeChange,value:this.props.expirationType},be),"SPECIFIC"===this.props.expirationType?r.a.createElement(Ue.a,{pickerPosition:"bottom center",wrapperClassName:ge,timePicker:!0,min:_e,inputFormat:"Do MMM YYYY hh:mm A",value:this.props.expirationCustomTime,onChange:this.props.onExpirationCustomChange}):null)))),ce?r.a.createElement("div",{className:"float-right","data-tip":ce,"data-place":"right"},r.a.createElement("input",{style:{margin:0},className:ie,type:"submit",onClick:m.bind(this,!0),value:te})):r.a.createElement("div",{className:"float-right","data-tip":""},r.a.createElement("input",{style:{margin:0},className:ie,type:"submit",onClick:m.bind(this,!0),value:te})),ce&&u?r.a.createElement("div",{style:{paddingRight:10},className:"float-right","data-tip":ce,"data-place":"right"},r.a.createElement("input",{style:{margin:0},className:ie,type:"submit",onClick:m.bind(this,!1),value:ae})):u?r.a.createElement("div",{style:{paddingRight:10},className:"float-right","data-tip":""},r.a.createElement("input",{style:{margin:0},className:ie,type:"submit",onClick:m.bind(this,!1),value:ae})):null)))),r.a.createElement(Re.a,Ve({ref:"deposit_modal",action:"deposit",fiatModal:!1,account:this.props.currentAccount.get("name"),sender:this.props.currentAccount.get("id"),asset:this.props[Z?"base":"quote"].get("id"),modalId:"simple_deposit_modal"+("bid"===n?"":"_ask"),balances:[this.props.balance]},E)))}}]),t}();Ge.propTypes={balance:Be.a.ChainObject,type:b.a.string,amountChange:b.a.func.isRequired,priceChange:b.a.func.isRequired,onSubmit:b.a.func.isRequired,onExpirationTypeChange:b.a.func.isRequired,onExpirationCustomChange:b.a.func.isRequired},Ge.defaultProps={type:"bid"};var Ke=Object(Me.a)(Ge),Qe=a(39),Ye=a(123),Xe=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Ze=new Date,$e=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={marketsList:"",issuersList:"",lookupQuote:null,filterByIssuerName:null},e.getAssetList=Object(h.a)(Ye.a.getAssetList.defer,150),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Xe(t,[{key:"_onSelectIssuer",value:function(e){this.setState({filterByIssuerName:"0"==e.target.value?null:e.target.value})}},{key:"_onInputName",value:function(e,t){var a=t.target.value.trim().toUpperCase(),n=!W.d.is_valid_symbol_error(a,!0);if(this.setState({inputValue:t.target.value.trim(),marketsList:"",issuersList:"",filterByIssuerName:null}),a&&a.length>=3&&!n)return this.setState({assetNameError:!0});this.setState({assetNameError:!1}),this._lookupAssets(a,e)}},{key:"_lookupAssets",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e||""===e){var n=new Date,r=e.toUpperCase();if(this.setState({lookupQuote:r}),this.state.lookupQuote!==r||a){if(r.length<1||n-Ze<=250)return!1;this.getAssetList(r,25,t)}}}},{key:"_changeMarketPickerFilter",value:function(e){this.setState({marketPickerTab:e,inputValue:"",marketsList:"",issuersList:"",filterByIssuerName:null})}},{key:"render",value:function(){var e=this,t=this.props,a=t.searchAssets,n=t.assetsLoading,s=t.marketPickerAsset,o=this.state,i=o.lookupQuote,l=o.marketPickerTab,c=o.filterByIssuerName,u=o.inputValue,p=this.props.baseAsset.get("symbol"),m=this.props.quoteAsset.get("symbol"),d=[],h=[],f=this.state.marketsList,b=this.state.issuersList,y=0;return a.size&&u&&u.length>2&&a.filter(function(e){try{if(e.options.description){var t=JSON.parse(e.options.description);if("visible"in t&&!t.visible)return!1}}catch(e){}return-1!==e.symbol.indexOf(i)&&e.symbol.length>=i.length}).forEach(function(t){if(!(y>100)){y++;var a=W.b.getObject(t.issuer,!1,!1);if(a){var n=e.props.baseAsset.get("symbol"),r=t.symbol+"_"+n;n===t.symbol||c&&c!=a.get("name")||("search"!=l||!t.symbol.startsWith(u))&&l&&"filter"!=l||d.push([r,{quote:t.symbol,base:n,issuer:a.get("name")}]),h.includes(a.get("name"))||h.push(a.get("name"))}}}),b=h.sort(function(e,t){return e>t?1:e<t?-1:0}).map(function(e){return r.a.createElement("option",{key:e,value:e},e)}),f=d.sort(function(e,t){return e[1].quote>t[1].quote?1:e[1].quote<t[1].quote?-1:0}).map(function(t){var a=e.props.quoteAsset.get("symbol")==s;return r.a.createElement("li",{key:t[0]},r.a.createElement(x.a,{name:t[1].quote}),r.a.createElement("span",{style:{float:"right"}},r.a.createElement(_.b,{onClick:function(){e.props.onToggleMarketPicker(null),g.a.switchMarket()},to:a?"/market/"+t[1].quote+"_"+p:"/market/"+m+"_"+t[1].quote},r.a.createElement(S.a,{content:"exchange.market_picker.use"}))))}),r.a.createElement("div",{className:"marketPicker"},r.a.createElement("div",{className:"marketPicker__header"},r.a.createElement("div",{className:"marketPicker__filterType"},r.a.createElement(S.a,{className:"marketPicker__filterHeader",component:"span",content:"exchange.market_picker.search_mode"}),r.a.createElement(U.a,{style:{marginLeft:5,cursor:"pointer"},className:this.state.marketPickerTab&&"filter"!=this.state.marketPickerTab?"":"blue-icon",size:"1_5x",onClick:this._changeMarketPickerFilter.bind(this,"filter"),name:"filter",title:"icons.filter"}),r.a.createElement(U.a,{style:{marginLeft:5,cursor:"pointer"},className:"search"==this.state.marketPickerTab?"blue-icon":"",size:"1_5x",onClick:this._changeMarketPickerFilter.bind(this,"search"),name:"zoom",title:"icons.zoom"})),r.a.createElement(S.a,{className:"marketPicker__title",component:"span",content:"exchange.market_picker.title"})),r.a.createElement("div",{className:"marketPicker__subHeader"},r.a.createElement(S.a,{content:"exchange.market_picker.sub_title"})," ",r.a.createElement(_.b,{to:"/asset/"+s,style:{cursor:"pointer",color:"lightblue !important"}},r.a.createElement(x.a,{name:s}),r.a.createElement(U.a,{className:"blue-icon",style:{marginLeft:5},name:"info-circle-o",title:"icons.info_circle_o"}))),r.a.createElement("hr",null),r.a.createElement("div",{id:"search",style:{display:"search"==l?"":"none"}},r.a.createElement("div",null,r.a.createElement("section",{className:"block-list no-border-bottom"},r.a.createElement("header",null,r.a.createElement(S.a,{component:"span",content:"exchange.market_picker.search_for_asset"})),r.a.createElement("input",{type:"text",value:u,onChange:this._onInputName.bind(this,!1),placeholder:v.a.translate("exchange.market_picker.search"),maxLength:"16",tabIndex:2})))),r.a.createElement("div",{id:"filter",style:{display:this.state.marketPickerTab&&"filter"!=this.state.marketPickerTab?"none":""}},r.a.createElement("div",null,r.a.createElement("section",{className:"block-list no-border-bottom"},r.a.createElement("header",null,r.a.createElement(S.a,{component:"span",content:"exchange.market_picker.find_by_asset"})),r.a.createElement("input",{type:"text",value:u,onChange:this._onInputName.bind(this,!0),placeholder:v.a.translate("exchange.market_picker.search"),maxLength:"16",tabIndex:2}))),r.a.createElement("div",null,r.a.createElement("section",{className:"block-list no-border-bottom"},r.a.createElement("header",null,r.a.createElement(S.a,{component:"span",content:"exchange.market_picker.filter_by_issuer"})),r.a.createElement("ul",null,r.a.createElement("li",{className:"with-dropdpwn"},r.a.createElement("select",{className:"settings-select",onChange:this._onSelectIssuer.bind(this),style:{border:0}},r.a.createElement("option",{key:"0",value:"0"},r.a.createElement(S.a,{content:"exchange.market_picker.show_all"})),b)))))),r.a.createElement("section",{className:"block-list no-border-bottom"},r.a.createElement(S.a,{component:"header",content:"exchange.market_picker.results",total_assets:d.length})),n&&d.length?r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(Qe.a,{type:"three-bounce"})):r.a.createElement("div",{className:"results"},r.a.createElement("ul",{style:{marginLeft:0}},f)))}}]),t}(),et=a(343),tt=a.n(et),at=a(292),nt=a.n(at),rt=a(237),st=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ot=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var lt=function e(t){it(this,e),this.name=t.ticker,this.ticker=t.ticker;var a=Object(rt.a)(t.quoteAsset),n=Object(rt.a)(t.baseAsset),r=a===n?a:a&&!n?a:!a&&n?n:a+" / "+n,s=w.a.replaceName(t.baseAsset),o=s.name,i=s.prefix,l=w.a.replaceName(t.quoteAsset),c=l.name,u=l.prefix;this.description=""+(u||"")+c+" / "+(i||"")+o+" "+(r?"("+r+")":""),this.type="bitcoin",this.session="24x7",this.timezone=nt.a.tz.guess(),this.data_status="streaming",this.supported_resolutions=t.resolutions,this.has_empty_bars=!0,this.pricescale=Math.pow(10,t.baseAsset.get("precision")),this.quoteAsset=t.quoteAsset,this.baseAsset=t.baseAsset,this.minmov=1,this.has_intraday=this.supported_resolutions.reduce(function(e,t){return e||!isNaN(parseInt(t,10))},!1),this.intraday_multipliers=this.supported_resolutions.filter(function(e){return!isNaN(parseInt(e,10))}),this.has_seconds=this.supported_resolutions.reduce(function(e,t){return e||-1!==t.indexOf("S")},!1),this.seconds_multipliers=this.supported_resolutions.filter(function(e){return-1!==e.indexOf("S")}),this.has_daily=this.supported_resolutions.reduce(function(e,t){return e||-1!==t.indexOf("D")},!1),this.has_daily=this.supported_resolutions.reduce(function(e,t){return e||-1!==t.indexOf("D")},!1)};function ct(e){return e.map(function(e){var t=e/60,a=t/60/24,n=a/7;if(t<1)return e+"S";if(a<1&&parseInt(t,10)===t)return t.toString();if(n<1){if(a>=1&&parseInt(a,10)===a)return 1===a?"D":a+"D"}else if(n>=1&&parseInt(n,10)===n)return n+"D";return null}).filter(function(e){return!!e})}var ut=function(){function e(){it(this,e)}return ot(e,[{key:"update",value:function(e){for(var t in e)switch(t){case"resolutions":this.supported_resolutions=ct(e.resolutions);break;case"onMarketChange":s.a.unsubscribe("market_change"),s.a.subscribe("market_change",e[t]);break;default:this[t]=e[t]}}},{key:"clearSubs",value:function(){s.a.clearSubs()}},{key:"onReady",value:function(e){var t=this;setTimeout(function(){e({exchanges:[{value:"OPEN.",name:"Openledger",desc:"Openledger Gateway"}],symbols_types:[],supported_resolutions:t.supported_resolutions,supports_marks:!1,supports_search:!1,supports_time:!0})},10)}},{key:"searchSymbols",value:function(e,t,a,n){console.log("searchSymbols",e,t,a),n([])}},{key:"resolveSymbol",value:function(e,t,a){var n=this,r=e.split("_"),s=st(r,2),o=s[0],i=s[1];Promise.all([Object(W.f)("getAsset",o),Object(W.f)("getAsset",i)]).then(function(a){var r=st(a,2),s=r[0],o=r[1];t(new lt({ticker:e,quoteAsset:s,baseAsset:o,resolutions:n.supported_resolutions}))}).catch(a)}},{key:"getBars",value:function(e,t,a,n,r,s,o){var i=this;a*=1e3,n*=1e3;var l,c=this._getHistory();if(this.latestBar=c[c.length-1],c=c.filter(function(e){return e.time>=a&&e.time<=n}),this.interval!==t){if(!o)return;var u="D"===(l=t)?86400:-1!==l.indexOf("W")?7*parseInt(l.replace("D",""),10)*24*60*60:-1!==l.indexOf("D")?24*parseInt(l.replace("D",""),10)*60*60:-1!==l.indexOf("S")?parseInt(l.replace("S",""),10):60*parseInt(l,10);return g.a.changeBucketSize(u),g.a.unSubscribeMarket(e.quoteAsset.get("id"),e.baseAsset.get("id")).then(function(){g.a.subscribeMarket(e.baseAsset,e.quoteAsset,u).then(function(){var e=i._getHistory();if(i.latestBar=e[e.length-1],e=e.filter(function(e){return e.time>=a&&e.time<=n}),i.interval=t,!e.length)return r(e,{noData:!0});r(e)})})}if(this.interval=t,!c.length)return r(c,{noData:!0});r(c)}},{key:"_getHistory",value:function(){return s.a.getState().priceData}},{key:"subscribeBars",value:function(e,t,a,n,r){var o=this;s.a.unsubscribe("subscribeBars"),r(),s.a.subscribe("subscribeBars",function(){var e=o._getHistory(),t=e.filter(function(e){return!o.latestBar||e.time>o.latestBar.time});if(t.length)t.forEach(function(e){a(e)}),o.latestBar=t[t.length-1];else{var n=!1;for(var r in o.latestBar)o.latestBar[r]!==e[e.length-1][r]&&(n=!0);n&&a(e[e.length-1])}})}},{key:"unsubscribeBars",value:function(){}},{key:"calculateHistoryDepth",value:function(e,t,a){}},{key:"getServerTime",value:function(e){e((new Date).getTime()/1e3)}}]),e}(),pt=["America/Argentina/Buenos_Aires","America/Bogota","America/Caracas","America/Chicago","America/El_Salvador","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Almaty","Asia/Ashkhabad","Asia/Bangkok","Asia/Dubai","Asia/Hong_Kong","Asia/Kathmandu","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Taipei","Asia/Tehran","Asia/Tokyo","Australia/ACT","Australia/Adelaide","Australia/Brisbane","Australia/Sydney","Europe/Athens","Europe/Berlin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Warsaw","Europe/Zurich","Pacific/Auckland","Pacific/Chatham","Pacific/Fakaofo","Pacific/Honolulu","US/Mountain"];var mt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var dt=a(831),ht=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),mt(t,[{key:"loadTradingView",value:function(e){var t=this,a=e.dataFeed,n=tt.a[e.theme];a&&(this.tvWidget||(a.update({resolutions:e.buckets,ticker:e.quoteSymbol+"_"+e.baseSymbol,interval:ct([e.bucketSize])[0]}),this.tvWidget=new dt.widget({fullscreen:!1,symbol:e.quoteSymbol+"_"+e.baseSymbol,interval:ct([e.bucketSize])[0],library_path:"/charting_library/",datafeed:a,container_id:"tv_chart",charts_storage_url:"http://saveload.tradingview.com",charts_storage_api_version:"1.1",client_id:"tradingview.com",user_id:"public_user_id",autosize:!0,locale:e.locale,timezone:function(){var e=nt.a.tz.guess();if(-1!==pt.indexOf(e))return e;for(var t=nt()().toISOString(),a=nt.a.tz(t,e).format(),n=0;n<pt.length;n++)if(nt.a.tz(t,pt[n]).format()===a)return pt[n];return console.log("No matching timezone found for "+e+", setting to default value of Europe/London"),"Europe/London"}(),toolbar_bg:n.bgColor,overrides:{"paneProperties.background":n.bgColor,"paneProperties.horzGridProperties.color":n.axisLineColor,"paneProperties.vertGridProperties.color":n.axisLineColor,"scalesProperties.lineColor":n.axisLineColor,"scalesProperties.textColor":n.textColor},theme:e.theme,custom_css_url:"custom-css.css",enabled_features:["study_templates"],disabled_features:["use_localstorage_for_settings","header_saveload","symbol_info","symbol_search_hot_key","border_around_the_chart","header_symbol_search","header_compare"],debug:!1,preset:this.props.mobile?"mobile":""}),this.tvWidget.onChartReady(function(){a.update({onMarketChange:t._setSymbol.bind(t)})})))}},{key:"componentWillReceiveProps",value:function(e){e.marketReady&&!this.props.dataFeed&&e.dataFeed&&loadTradingView(e)}},{key:"_setSymbol",value:function(e){this.tvWidget&&this.tvWidget.setSymbol(e,ct([this.props.bucketSize])[0])}},{key:"componentDidMount",value:function(){this.loadTradingView(this.props)}},{key:"componentWillUnmount",value:function(){this.props.dataFeed.clearSubs()}},{key:"shouldComponentUpdate",value:function(e){return e.chartHeight!==this.props.chartHeight||!this.tvWidget&&!!e.marketReady}},{key:"render",value:function(){return r.a.createElement("div",{className:"small-12"},r.a.createElement("div",{className:"exchange-bordered",style:{marginTop:10,marginBottom:10,height:this.props.chartHeight+"px"},id:"tv_chart"}))}}]),t}(),ft=a(242),bt=a(234),gt=a.n(bt),_t=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var yt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),_t(t,[{key:"shouldComponentUpdate",value:function(e){var t=!isNaN(e.feedPrice)&&e.feedPrice!==this.props.feedPrice;return Object(H.h)(e.orders,this.props.orders)||Object(H.h)(e.call_orders,this.props.call_orders)||t||e.feedPrice!==this.props.feedPrice||e.height!==this.props.height||e.leftOrderBook!==this.props.leftOrderBook||e.LCP!==this.props.LCP||e.showCallLimit!==this.props.showCallLimit||e.hasPrediction!==this.props.hasPrediction||e.feedPrice!==this.props.feedPrice||e.marketReady!==this.props.marketReady}},{key:"componentDidMount",value:function(){this.reflowChart(500)}},{key:"componentWillReceiveProps",value:function(e){this.refs.depthChart&&e.verticalOrderbook!==this.props.verticalOrderbook&&this.reflowChart(100)}},{key:"componentWillUpdate",value:function(){this.props.centerRef&&(this.tempScroll=this.props.centerRef.scrollTop)}},{key:"componentDidUpdate",value:function(){this.props.centerRef&&(this.props.centerRef.scrollTop=this.tempScroll)}},{key:"reflowChart",value:function(e){var t=this;setTimeout(function(){t.refs.depthChart&&t.refs.depthChart.chart.reflow()},e)}},{key:"_getThemeColors",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return tt.a[e.theme]}},{key:"render",value:function(){var e=this.props,t=e.flat_bids,a=e.flat_asks,n=e.flat_calls,s=e.flat_settles,o=e.totalBids,i=e.totalAsks,l=e.base,c=e.quote,u=e.feedPrice,p=this._getThemeColors(),m=p.primaryText,d=p.callColor,h=p.settleColor,f=p.settleFillColor,b=p.bidColor,g=p.bidFillColor,_=p.askColor,y=p.askFillColor,k=p.axisLineColor,E=w.a.replaceName(l),C=E.name,A=E.prefix,O=w.a.replaceName(c),N=O.name,P=O.prefix;C=(A||"")+C,N=(P||"")+N;var T=Object(ft.a)(t),j=Object(ft.a)(a),q=Object(ft.a)(n),I=Object(ft.a)(s),F={chart:{type:"area",backgroundColor:"rgba(255, 0, 0, 0)",spacing:[10,0,5,0]},title:{text:null},credits:{enabled:!1},legend:{enabled:!1},rangeSelector:{enabled:!1},navigator:{enabled:!1},scrollbar:{enabled:!1},dataGrouping:{enabled:!1},tooltip:{shared:!1,backgroundColor:"rgba(0, 0, 0, 0.75)",useHTML:!0,formatter:function(){return"\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>"+v.a.translate("exchange.price")+':</td>\n\t\t\t\t\t\t\t<td style="text-align: right">'+w.a.format_number(this.x,l.get("precision"))+" "+C+"/"+N+"</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>"+v.a.translate("exchange.quantity")+':</td>\n\t\t\t\t\t\t\t<td style="text-align: right">'+w.a.format_number(this.y,c.get("precision"))+" "+N+"</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t"},style:{color:"#FFFFFF"}},series:[],yAxis:{labels:{enabled:!0,style:{color:m}},opposite:!1,title:{text:null,style:{color:"#FFFFFF"}},gridLineWidth:1,gridLineColor:"rgba(196, 196, 196, 0.30)",gridZIndex:1,crosshair:{snap:!1},currentPriceIndicator:{enabled:!1}},xAxis:{labels:{style:{color:m}},ordinal:!1,lineColor:"#000000",title:{text:null},plotLines:[]},plotOptions:{area:{animation:!1,marker:{enabled:!1},series:{enableMouseTracking:!1}}}};if(T.length>0&&j.length>0){var B=(j[0][0]+T[T.length-1][0])/2;F.xAxis.min=.4*B,F.xAxis.max=1.6*B,F.xAxis.max<j[0][0]&&(F.xAxis.max=1.5*j[0][0]),F.xAxis.min>T[T.length-1][0]&&(F.xAxis.min=.5*T[T.length-1][0]);var M=0;T.forEach(function(e){e[0]>=F.xAxis.min&&(M=Math.max(e[1],M))}),j.forEach(function(e){e[0]<=F.xAxis.max&&(M=Math.max(e[1],M))}),F.yAxis.max=1.15*M}else T.length&&!j.length?(F.xAxis.min=.4*T[T.length-1][0],F.xAxis.max=1.6*T[T.length-1][0]):j.length&&!T.length&&(F.xAxis.min=0,F.xAxis.max=2*j[0][0]);if(this.props.hasPrediction&&(F.xAxis.min=-.05,F.xAxis.max=1.05),this.props.LCP&&F.xAxis.plotLines.push({color:k,id:"plot_line",dashStyle:"longdash",value:this.props.LCP,label:{text:v.a.translate("explorer.block.call_limit"),style:{color:m,fontWeight:"bold"}},width:2,zIndex:5}),u){var R=l.has("bitasset")?_:b;F.xAxis.plotLines.push({color:R,id:"plot_line",dashStyle:"solid",value:u,label:{text:v.a.translate("explorer.block.feed_price"),style:{color:m,fontWeight:"bold"}},width:2,zIndex:5}),q&&q.length&&F.series.push({name:"Call "+N,data:q,color:d})}return u&&I&&I.length&&F.series.push({name:"Settle "+N,data:I,color:h,fillColor:f}),T.length&&F.series.push({step:"right",name:"Bid "+N,data:T,color:b,fillColor:g}),j.length&&F.series.push({step:"left",name:"Ask "+N,data:j,color:_,fillColor:y}),this.props.height?F.chart.height=this.props.height:F.chart.height="400px",this.props.onClick&&(F.chart.events={click:this.props.onClick.bind(this)}),this.props.noFrame?r.a.createElement("div",{className:"grid-content no-overflow no-padding"},T.length||j.length||q.length?null:r.a.createElement("span",{className:"no-data"},r.a.createElement(S.a,{content:"exchange.no_data"})),this.props.noText?null:r.a.createElement("p",{className:"bid-total"},w.a.format_number(o,l.get("precision"))," ",C),this.props.noText?null:r.a.createElement("p",{className:"ask-total"},w.a.format_number(i,c.get("precision"))," ",N),T||j||q?r.a.createElement(gt.a,{config:F}):null):r.a.createElement("div",{className:"grid-content no-overflow no-padding middle-content"},r.a.createElement("div",{className:"exchange-bordered",style:{margin:10}},r.a.createElement("div",{className:"exchange-content-header"},this.props.noText?null:r.a.createElement("span",{className:"bid-total"},w.a.format_number(o,l.get("precision"))," ",r.a.createElement(x.a,{name:l.get("symbol")})),this.props.noText?null:r.a.createElement("span",{className:"ask-total float-right"},w.a.format_number(i,c.get("precision"))," ",r.a.createElement(x.a,{name:c.get("symbol")}))),T.length||j.length||q.length?null:r.a.createElement("span",{className:"no-data"},r.a.createElement(S.a,{content:"exchange.no_data"})),T||j||q?r.a.createElement(gt.a,{ref:"depthChart",config:F}):null))}}]),t}();yt.defaultProps={flat_bids:[],flat_asks:[],orders:{},noText:!1,noFrame:!0},yt.propTypes={flat_bids:b.a.array.isRequired,flat_asks:b.a.array.isRequired,orders:b.a.object.isRequired};var vt=yt,kt=a(559),Et=a(25),wt=a.n(Et),Ct=a(55),St=a(80),xt=a.n(St),At=a(18),Ot=a(78),Nt=a(77),Pt=a(96),Tt=a(13),jt=a(104),qt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function It(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ft(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Bt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Mt=function(e){function t(e){It(this,t);var a=Ft(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state=a._initialState(e),a}return Bt(t,r.a.Component),qt(t,[{key:"_initialState",value:function(e){var t=e?this._getCurrentPosition(e):{};if(t.collateral){var a=w.a.get_asset_amount(t.debt,e.quote_asset),n=w.a.get_asset_amount(t.collateral,e.backing_asset);return{short_amount:a?a.toString():null,collateral:n?n.toString():null,collateral_ratio:this._getCollateralRatio(a,n),errors:this._getInitialErrors(),isValid:!1,original_position:{debt:a,collateral:n}}}return{short_amount:0,collateral:0,collateral_ratio:this._getInitialCollateralRatio(e),errors:this._getInitialErrors(),isValid:!1,original_position:{debt:0,collateral:0}}}},{key:"componentDidMount",value:function(){var e=this._initialState(this.props);this.setState(e),this._setUpdatedPosition(e)}},{key:"shouldComponentUpdate",value:function(e,t){return!(w.a.are_equal_shallow(t,this.state)&&Ce.a.is(e.quote_asset,this.props.quote_asset)&&!e.backing_asset.get("symbol")!==this.props.backing_asset.get("symbol")&&Ce.a.is(e.account,this.props.account)&&Ce.a.is(e.call_orders,this.props.call_orders))}},{key:"componentWillReceiveProps",value:function(e){var t=this.state,a=t.short_amount,n=t.collateral,r=t.collateral_ratio;if(e.account!==this.props.account||e.hasCallOrders!==this.props.hasCallOrders||e.quote_asset.get("id")!==this.props.quote_asset.get("id")){var s=this._initialState(e),o=!1;(a||n||r)&&(s.short_amount=a,s.collateral=n,s.collateral_ratio=r,o=!0),this.setState(s),o&&this._validateFields(s)}}},{key:"_getInitialErrors",value:function(){return{collateral_balance:null,ratio_too_high:null}}},{key:"confirmClicked",value:function(e){e.preventDefault(),wt.a.publish(this.props.modalId,"close")}},{key:"_onBorrowChange",value:function(e){var t=this._getFeedPrice(),a=e.amount.replace(/,/g,""),n={short_amount:a,collateral:(this.state.collateral_ratio*(a/t)).toFixed(this.props.backing_asset.get("precision")),collateral_ratio:this.state.collateral_ratio};this.setState(n),this._validateFields(n),this._setUpdatedPosition(n)}},{key:"_onCollateralChange",value:function(e){var t=e.amount.replace(/,/g,""),a=this._getFeedPrice(),n=t/(this.state.short_amount/a),r=this._isPredictionMarket(this.props)?{short_amount:t,collateral:t,collateral_ratio:1}:{short_amount:this.state.short_amount,collateral:t,collateral_ratio:Object(kt.a)(n)?n:this._getInitialCollateralRatio(this.props)};this.setState(r),this._validateFields(r),this._setUpdatedPosition(r)}},{key:"_onRatioChange",value:function(e){var t=this._getFeedPrice(),a=e.target;new RegExp(/[[:digit:]]/).test(a.value)||(a.value=a.value.replace(/[^0-9.]/g,"")),"."==a.value.charAt(0)&&(a.value="0.");var n=a.value,r={short_amount:this.state.short_amount,collateral:(this.state.short_amount/t*n).toFixed(this.props.backing_asset.get("precision")),collateral_ratio:n};this.setState(r),this._validateFields(r),this._setUpdatedPosition(r)}},{key:"_maximizeCollateral",value:function(){var e=this.props?this._getCurrentPosition(this.props):{},t=0;e.collateral&&(t=w.a.get_asset_amount(e.collateral,this.props.backing_asset));var a=Math.floor(Math.min(this.props.backing_balance.get("balance")/w.a.get_asset_precision(this.props.backing_asset)+t-10,this.state.short_amount/this._getFeedPrice()*1e3));this._onCollateralChange(new Object({amount:a.toString()}))}},{key:"_maximizeDebt",value:function(){var e=this.props?this._getCurrentPosition(this.props):{},t=0;e.collateral&&(t=w.a.get_asset_amount(e.collateral,this.props.backing_asset));var a=this.props.backing_balance.get("balance")/w.a.get_asset_precision(this.props.backing_asset)+t-10,n={short_amount:a/this.state.collateral_ratio*this._getFeedPrice(),collateral:a,collateral_ratio:this.state.collateral_ratio};this.setState(n),this._validateFields(n),this._setUpdatedPosition(n)}},{key:"_payDebt",value:function(){var e=this.props?this._getCurrentPosition(this.props):{debt:0};if(!(e.debt<=0)){var t=w.a.get_asset_amount(Math.max(e.debt-this.props.bitasset_balance.get("balance"),0),this.props.quote_asset);this._onBorrowChange({amount:t.toString()})}}},{key:"_setUpdatedPosition",value:function(e){this.setState({newPosition:parseFloat(e.short_amount)/parseFloat(e.collateral)})}},{key:"_validateFields",value:function(e){var t=this._getInitialErrors(),a=this.state.original_position,n=this.props.backing_balance?this.props.backing_balance.toJS():{balance:0};parseFloat(e.collateral)-a.collateral>w.a.get_asset_amount(n.balance,this.props.backing_asset.toJS())&&(t.collateral_balance=v.a.translate("borrow.errors.collateral"));var r=e.short_amount>=0&&e.collateral>=0&&(e.short_amount!=a.debt||e.collateral!=a.collateral),s=this.props.quote_asset.getIn(["bitasset","current_feed","maintenance_collateral_ratio"])/1e3;parseFloat(e.collateral_ratio)<(this._isPredictionMarket(this.props)?1:s)?(t.below_maintenance=v.a.translate("borrow.errors.below",{mr:s}),r=!1):parseFloat(e.collateral_ratio)<(this._isPredictionMarket(this.props)?1:s+.5)&&(t.close_maintenance=v.a.translate("borrow.errors.close",{mr:s}),r=!0),this.setState({errors:t,isValid:r})}},{key:"_onSubmit",value:function(e){e.preventDefault();var t=w.a.get_asset_precision(this.props.quote_asset.get("precision")),a=w.a.get_asset_precision(this.props.backing_asset.get("precision")),n=this._getCurrentPosition(this.props),r=Pt.a.new_transaction();r.add_type_operation("call_order_update",{fee:{amount:0,asset_id:0},funding_account:this.props.account.get("id"),delta_collateral:{amount:parseInt(this.state.collateral*a-n.collateral,10),asset_id:this.props.backing_asset.get("id")},delta_debt:{amount:parseInt(this.state.short_amount*t-n.debt,10),asset_id:this.props.quote_asset.get("id")}}),Tt.a.process_transaction(r,null,!0).catch(function(e){}),wt.a.publish(this.props.modalId,"close")}},{key:"_getCurrentPosition",value:function(e){var t={collateral:null,debt:null};return e&&e.hasCallOrders&&e.call_orders&&(t=(t=e.call_orders.filter(function(e){return!!e}).find(function(t){return t.getIn(["call_price","quote","asset_id"])===e.quote_asset.get("id")}))?t.toJS():{collateral:null,debt:null}),t}},{key:"_getFeedPrice",value:function(){return this.props?this._isPredictionMarket(this.props)?1:1/w.a.get_asset_price(this.props.quote_asset.getIn(["bitasset","current_feed","settlement_price","quote","amount"]),this.props.backing_asset,this.props.quote_asset.getIn(["bitasset","current_feed","settlement_price","base","amount"]),this.props.quote_asset):1}},{key:"_getInitialCollateralRatio",value:function(e){return this._isPredictionMarket(e)?1:0}},{key:"_getCollateralRatio",value:function(e,t){return t/(e/this._getFeedPrice())}},{key:"_isPredictionMarket",value:function(e){return e.quote_asset.getIn(["bitasset","is_prediction_market"])}},{key:"render",value:function(){var e=this,t=this.props,a=t.quote_asset,n=t.bitasset_balance,s=t.backing_asset,o=t.backing_balance,i=this.state,l=i.short_amount,c=i.collateral,u=i.collateral_ratio,p=i.errors,m=i.isValid,d=w.a.get_asset_precision(this.props.quote_asset.get("precision")),h=w.a.get_asset_precision(this.props.backing_asset.get("precision"));u&&!isNaN(u)&&u>0&&u<1e3||(u=0),n=n?n.toJS():{balance:0,id:null},o=o?o.toJS():{balance:0,id:null};var f=z()("form-group",{"has-error":p.collateral_balance}),b=z()("form-group",{"has-error":p.below_maintenance},{"has-warning":p.close_maintenance}),g=z()("button btn large",{disabled:p.collateral_balance||!m},{outline:p.collateral_balance||!m},{inverted:m}),_=this._getCurrentPosition(this.props),y=o.id?W.b.getObject(o.id):null,k=(y?y.get("balance"):0)-parseInt(this.state.collateral*h-_.collateral,10),E=r.a.createElement("span",null,r.a.createElement("span",null,r.a.createElement(S.a,{component:"span",content:"transfer.available"}),":"," ",n.id?r.a.createElement(Nt.a,{balance:n.id}):r.a.createElement(At.a,{amount:0,asset:a.get("id")})),r.a.createElement("a",{onClick:this._payDebt.bind(this)},r.a.createElement(S.a,{content:"borrow.pay_max_debt"})),"|",0!=u?r.a.createElement("a",{onClick:this._maximizeDebt.bind(this)},r.a.createElement(S.a,{content:"borrow.use_max"})):r.a.createElement("span",{className:"disabled-link","data-place":"left","data-tip":v.a.translate("borrow.maximize_debt_set_ratio_slider")},r.a.createElement(S.a,{content:"borrow.use_max"}))),C=r.a.createElement("span",null,r.a.createElement("span",null,r.a.createElement(S.a,{component:"span",content:"transfer.available"}),":"," ",o.id?r.a.createElement(At.a,{amount:k,asset:s.get("id")}):r.a.createElement(At.a,{amount:0,asset:s.get("id")})),r.a.createElement("a",{onClick:this._maximizeCollateral.bind(this)},r.a.createElement(S.a,{content:"borrow.use_max"}))),x=this._getFeedPrice(),A=this.props.quote_asset.getIn(["bitasset","current_feed","maintenance_collateral_ratio"])/1e3,O=(this.props.quote_asset.getIn(["bitasset","current_feed","maximum_short_squeeze_ratio"]),this._isPredictionMarket(this.props));return!O&&isNaN(x)?r.a.createElement("div",null,r.a.createElement("form",{className:"grid-container text-center no-overflow",noValidate:!0},r.a.createElement(S.a,{component:"h3",content:"borrow.no_valid",asset_symbol:a.get("symbol")})),r.a.createElement("div",{className:"grid-content button-group text-center no-overflow"},r.a.createElement(xt.a,{close:this.props.modalId},r.a.createElement("div",{className:" button btn large outline"},r.a.createElement(S.a,{content:"account.perm.cancel"}))))):r.a.createElement("div",null,r.a.createElement("form",{className:"grid-container small-10 small-offset-1 no-overflow",noValidate:!0},r.a.createElement(S.a,{component:"h3",content:"borrow.title",asset_symbol:a.get("symbol")}),r.a.createElement("div",{style:{textAlign:"left"}},this.props.hide_help?null:r.a.createElement(jt.a,{path:"components/"+(O?"BorrowModalPrediction":"BorrowModal"),debt:a.get("symbol"),collateral:s.get("symbol"),borrower:this.props.account.get("name"),mr:A}),O?null:r.a.createElement("div",{style:{paddingBottom:"1rem"}},r.a.createElement("div",{className:"borrow-price-feeds"},r.a.createElement("span",{className:"borrow-price-label"},r.a.createElement(S.a,{content:"transaction.feed_price"}),": "),r.a.createElement(K.a,{noPopOver:!0,quote_amount:a.getIn(["bitasset","current_feed","settlement_price","base","amount"]),quote_asset:a.getIn(["bitasset","current_feed","settlement_price","base","asset_id"]),base_asset:a.getIn(["bitasset","current_feed","settlement_price","quote","asset_id"]),base_amount:a.getIn(["bitasset","current_feed","settlement_price","quote","amount"])})),r.a.createElement("b",null),r.a.createElement("div",{className:"borrow-price-final "+(p.below_maintenance?"has-error":p.close_maintenance?"has-warning":"")},r.a.createElement("span",{className:"borrow-price-label"},r.a.createElement(S.a,{content:"exchange.your_price"}),": "),this.state.newPosition?r.a.createElement(K.a,{noPopOver:!0,quote_amount:A*this.state.short_amount*d,quote_asset:a.get("id"),base_asset:s.get("id"),base_amount:this.state.collateral*h}):null)),r.a.createElement("div",{className:"form-group"},r.a.createElement(Ot.a,{label:"transaction.borrow_amount",amount:l.toString(),onChange:this._onBorrowChange.bind(this),asset:a.get("id"),assets:[a.get("id")],display_balance:E,placeholder:"0.0",tabIndex:1})),r.a.createElement("div",{className:f},r.a.createElement(Ot.a,{label:"transaction.collateral",amount:c.toString(),onChange:this._onCollateralChange.bind(this),asset:s.get("id"),assets:[s.get("id")],display_balance:C,placeholder:"0.0",tabIndex:1}),p.collateral_balance?r.a.createElement("div",{className:"float-left",style:{paddingTop:5}},p.collateral_balance):null),O?null:r.a.createElement("div",null,r.a.createElement("div",{className:b,style:{marginBottom:"1.5rem"}},r.a.createElement(S.a,{component:"label",content:"borrow.coll_ratio"}),r.a.createElement("span",null,r.a.createElement("input",{value:0==u?null:u,onChange:this._onRatioChange.bind(this),type:"text",style:{width:"12%",float:"right",marginTop:-10}}),r.a.createElement("input",{style:{width:"85%"},min:"0",max:"6",step:"0.01",onChange:this._onRatioChange.bind(this),value:u,type:"range"})),p.below_maintenance||p.close_maintenance?r.a.createElement("div",{style:{height:"1em",maxWidth:"85%"},className:"float-left"},p.below_maintenance,p.close_maintenance):null)),r.a.createElement("div",{className:"no-padding grid-content button-group no-overflow"},r.a.createElement("div",{onClick:this._onSubmit.bind(this),className:g},r.a.createElement(S.a,{content:"borrow.adjust"})),r.a.createElement("div",{onClick:function(t){t.preventDefault(),e.setState(e._initialState(e.props))},className:"outline btn large"},r.a.createElement(S.a,{content:"wallet.reset"}))))))}}]),t}();Mt.propTypes={quote_asset:Be.a.ChainAsset.isRequired,bitasset_balance:Be.a.ChainObject,backing_asset:Be.a.ChainAsset.isRequired,backing_balance:Be.a.ChainObject,call_orders:Be.a.ChainObjectsList,hasCallOrders:b.a.bool},Mt=Object(Me.a)(Mt);var Rt=function(e){function t(){It(this,t);var e=Ft(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={smallScreen:!1,open:!1},e}return Bt(t,r.a.Component),qt(t,[{key:"show",value:function(){var e=this;this.setState({open:!0},function(){wt.a.publish(e.props.modalId,"open")})}},{key:"onClose",value:function(){this.setState({open:!1})}},{key:"componentWillMount",value:function(){this.setState({smallScreen:window.innerHeight<=800})}},{key:"render",value:function(){var e=this.props,t=e.quote_asset,a=e.backing_asset,n=e.account,s=n.get("balances").toJS(),o=void 0,i=void 0;if(s)for(var l in s)l===a&&(o=s[l]),l===t&&(i=s[l]);return this.state.open?r.a.createElement(Ct.a,{id:this.props.modalId,overlay:!0,onClose:this.onClose.bind(this),ref:this.props.modalId,overlayClose:!0},r.a.createElement("div",{className:"grid-block vertical"},r.a.createElement(Mt,{quote_asset:t,call_orders:n.get("call_orders",Object(we.List)()).toList(),hasCallOrders:n.get("call_orders")&&n.get("call_orders").size>0,modalId:this.props.modalId,bitasset_balance:i,backing_balance:o,backing_asset:a,hide_help:this.state.smallScreen,account:n}))):null}}]),t}(),Lt=a(27),Dt=a(560),zt=a.n(Dt),Ut=a(176),Wt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Ht=W.c.operations,Vt=Object.keys(Ht),Jt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Wt(t,[{key:"componentWillReceiveProps",value:function(e){if(e.account&&e.account.size&&this.props.account&&this.props.account.get("history")){var t=this.props.account.get("history")&&this.props.account.get("history").first()?this.props.account.get("history").first().toJS():null,a=e.account.get("history")&&e.account.get("history").first()?e.account.get("history").first().toJS():null;a&&t&&"fill_order"===Vt[a.op[0]]&&(!t&&a.id||a.id!==t.id)&&(wt.a.publish("account-notify","open"),setTimeout(function(){wt.a.publish("account-notify","close")},5e3))}}},{key:"shouldComponentUpdate",value:function(e){return!(!e.account||!this.props.account)&&(!Ce.a.is(e.account.get("history"),this.props.account.get("history"))||!Ce.a.is(e.account,this.props.account))}},{key:"render",value:function(){var e=this.props.account;if(!e)return r.a.createElement("div",null);var t=void 0,a=void 0;return this.props.account.get("history")&&this.props.account.get("history").size&&(t=this.props.account.get("history").first().toJS())&&(a=r.a.createElement(Ut.a,{key:t.id,op:t.op,result:t.result,block:t.block_num,current:e.get("id"),hideDate:!0,hideFee:!0,isMarketPage:this.props.isMarketPage})),t?r.a.createElement(zt.a.Static,{id:"account-notify",title:null,image:"",wrapperElement:"div"},r.a.createElement("table",{className:"table"},r.a.createElement("tbody",null,a))):r.a.createElement("div",null)}}]),t}();Jt.propTypes={account:Be.a.ChainAccount.isRequired};var Gt=Jt=Object(Me.a)(Jt),Kt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Qt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Kt(t,[{key:"render",value:function(){return r.a.createElement(d.a,{stores:[o.a],inject:{account:function(){return o.a.getState().currentAccount}}},r.a.createElement(Gt,{isMarketPage:this.props.isMarketPage}))}}]),t}(),Yt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Xt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Yt(t,[{key:"show",value:function(){var e="modal_confirm_"+this.props.type;wt.a.publish(e,"open")}},{key:"_onForce",value:function(e,t){var a="modal_confirm_"+this.props.type;t.preventDefault(),wt.a.publish(a,"close"),e&&this.props.onForce()}},{key:"render",value:function(){var e=this.props,t=e.type,a=e.diff,n=e.hasOrders;return r.a.createElement(Ct.a,{id:"modal_confirm_"+t,overlay:!0},r.a.createElement(S.a,{component:"h3",content:"transaction.confirm"}),r.a.createElement("div",{className:"grid-block vertical"},n?r.a.createElement(S.a,{content:"exchange.confirm_"+t,diff:w.a.format_number(a,2)}):r.a.createElement(S.a,{content:"exchange.confirm_no_orders_"+t}),r.a.createElement("div",{className:"button-group",style:{paddingTop:"2rem"}},r.a.createElement("input",{onClick:this._onForce.bind(this,!0),className:"button btn large inverted",type:"submit",value:"Yes"}),r.a.createElement("input",{onClick:this._onForce.bind(this,!1),className:"button btn large outline",type:"submit",value:"No"}))))}}]),t}(),Zt=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var $t=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={change:null,curMarket:null,marketChange:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Zt(t,[{key:"shouldComponentUpdate",value:function(e){return!(!e.volume2||e.volume2===this.props.volume2)||(e.price!==this.props.price||e.ready!==this.props.ready)}},{key:"componentWillReceiveProps",value:function(e){var t={change:0},a=e.market,n=this.state.curMarket!==a,r=null!=this.state.curMarket&&n;t.marketChange=r,t.curMarket=a,t.prevAsset=this.state.marketAsset,e.ready&&this.props.ready&&(t.change=parseFloat(e.price)-parseFloat(this.props.price)),this.setState(t)}},{key:"componentDidUpdate",value:function(){re.a.rebuild()}},{key:"render",value:function(){var e=this.props,t=e.base,a=e.quote,n=e.price,s=e.content,o=e.ready,i=e.volume,l=e.toolTip,c=e.ignoreColorChange,u=this.state,p=u.change,m=null;!u.marketChange&&p&&null!==p&&!0!==c&&(m=p>0?"pulsate green":"pulsate red");var d=i?w.a.format_volume(n):w.a.price_text(n,a,t);return r.a.createElement("li",{className:z()("stressed-stat",this.props.className,m),onClick:this.props.onClick,"data-place":"bottom","data-tip":l},r.a.createElement("span",null,r.a.createElement("span",{className:"value stat-primary"},o?d:0," "),r.a.createElement("span",{className:"symbol-text"},r.a.createElement(x.a,{name:t.get("symbol")}))),s?r.a.createElement("div",{className:"stat-text"},r.a.createElement(S.a,{content:s})):null)}}]),t}(),ea=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},ta=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function aa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function na(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ra(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var sa=function(e){function t(){return aa(this,t),na(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return ra(t,r.a.Component),ta(t,[{key:"_getFeedPrice",value:function(){return this.props?1/w.a.get_asset_price(this.props.debtAsset.getIn(["bitasset","current_feed","settlement_price","quote","amount"]),this.props.collateralAsset,this.props.debtAsset.getIn(["bitasset","current_feed","settlement_price","base","amount"]),this.props.debtAsset):1}},{key:"_getCollateralRatio",value:function(){var e=this.props.object.toJS();return w.a.get_asset_amount(e.collateral,this.props.collateralAsset)/(w.a.get_asset_amount(e.debt,this.props.debtAsset)/this._getFeedPrice())}},{key:"_getMR",value:function(){return this.props.debtAsset.getIn(["bitasset","current_feed","maintenance_collateral_ratio"])/1e3}},{key:"_getStatusClass",value:function(){var e=this._getCollateralRatio(),t=this._getMR();return isNaN(e)?null:e<t?"danger":e<t+.5?"warning":""}},{key:"_getCRTip",value:function(){var e=this._getStatusClass(),t=this._getMR();return e&&""!==e?"danger"===e?v.a.translate("tooltip.cr_danger",{mr:t}):"warning"===e?v.a.translate("tooltip.cr_warning",{mr:t}):null:null}},{key:"render",value:function(){var e=this.props.object.toJS(),t=this._getCollateralRatio(),a=(w.a.get_asset_amount(e.debt,this.props.debtAsset),this._getStatusClass());return r.a.createElement("li",{className:z()("stressed-stat",this.props.className),onClick:this.props.onClick,"data-place":"bottom","data-tip":this._getCRTip()},r.a.createElement("span",null,r.a.createElement("span",{className:z()("value stat-primary",a)},w.a.format_number(t,2))),r.a.createElement("div",{className:"stat-text"},r.a.createElement(S.a,{content:"header.collateral_ratio"})))}}]),t}();sa.propTypes={debtAsset:Be.a.ChainAsset.isRequired,collateralAsset:Be.a.ChainAsset.isRequired},sa=Object(Me.a)(sa);var oa=function(e){function t(){return aa(this,t),na(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return ra(t,r.a.Component),ta(t,[{key:"render",value:function(){var e=this.props,t=e.object,a=e.account,n=t.getIn(["call_price","quote","asset_id"]),s=t.getIn(["call_price","base","asset_id"]);return r.a.createElement(sa,ea({debtAsset:n,collateralAsset:s,account:a},this.props))}}]),t}();oa.propTypes={object:Be.a.ChainObject.isRequired};var ia=oa=Object(Me.a)(oa),la=a(91),ca=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var ua=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={volumeShowQuote:!0,chartHeight:e.chartHeight},a.setChartHeight=a.setChartHeight.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),ca(t,[{key:"shouldComponentUpdate",value:function(e){return!!e.marketReady}},{key:"_addMarket",value:function(e,t){var a=e+"_"+t;this.props.starredMarkets.has(a)?L.a.removeStarMarket(e,t):L.a.addStarMarket(e,t)}},{key:"changeVolumeBase",value:function(){this.setState({volumeShowQuote:!this.state.volumeShowQuote})}},{key:"marketPicker",value:function(e){var t=this.state.selectedMarketPickerAsset;t=t&&t==e?null:e,this.setState({selectedMarketPickerAsset:t}),this.props.onToggleMarketPicker(t)}},{key:"setChartHeight",value:function(){this.props.onChangeChartHeight({value:this.state.chartHeight})}},{key:"componentDidMount",value:function(){var e=this;document.delayedExecution.add("ExchangeHeader_updateMargin",function(){e.updateMargin()},100)}},{key:"componentWillReceiveProps",value:function(e){var t=this;document.delayedExecution.add("ExchangeHeader_updateMargin",function(){t.updateMargin()},100)}},{key:"updateMargin",value:function(){function e(e){var t=0,a=document.getElementsByClassName(e);for(var n in a){var r=a[n].offsetWidth;r>t&&(t=r)}return t}var t=["vertical-table-cell-one","vertical-table-cell-two","vertical-table-cell-three"],a=0;for(var n in t)a+=e(t[n]);if(a>0)try{document.getElementsByClassName("container-menu-header")[0].style.marginLeft=a+"px"}catch(e){}try{var r="exchange_header_style",s="@media only screen and (min-width: 1000px) { body.localcoin .exchange-layout .grid-block.shrink.no-padding.overflow-visible.top-bar.left-cell-active { width: calc(100% - "+(a+e("right-column"))+"px); }}";if(document.getElementById(r)){document.getElementById(r).innerHTML=s}else{var o=document.createElement("style");o.id=r,o.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(o)}}catch(e){}}},{key:"render",value:function(){var e=this,t=this.props,n=t.quoteAsset,s=t.baseAsset,o=t.starredMarkets,i=t.hasPrediction,l=t.feedPrice,c=t.showCallLimit,u=t.lowestCallPrice,p=t.marketReady,m=t.latestPrice,d=t.marketStats,h=t.showDepthChart,f=t.account,b=s.get("symbol"),y=n.get("symbol"),k=y+"_"+b,E=o.has(k)?"gold-star":"grey-star",w=d.get("change"),C=0===parseFloat(w)?"":parseFloat(w)<0?"negative":"positive",A=d.get("volumeBase"),O=d.get("volumeQuote"),N=w>0?"+"+w:w,P=this.state.volumeShowQuote?O:A,T=this.state.volumeShowQuote?n:s,j=!1,q=n.get("id"),I=s.get("id"),F="1.3.0"===q?I:"1.3.0"===I?q:null,B=F?W.b.getAsset(F):null,M="",R=null;if(!!B&&!!B.get("bitasset")){if(f.toJS&&f.has("call_orders"))for(var L=f.get("call_orders").toJS(),D=0;D<L.length;D++){var z=L[D];if(W.b.getObject(z).getIn(["call_price","quote","asset_id"])===F){M=z,j=!0;break}}var H="1.3.0"==s.get("id")?n:"1.3.0"==n.get("id")?s:null;if(H&&l){var V=H.getIn(["bitasset","options"]).toJS().force_settlement_offset_percent;R="1.3.0"==s.get("id")?l.toReal()/(1+V/1e4):l.toReal()*(1+V/1e4)}}var J=a(3),G=!!this.state.selectedMarketPickerAsset&&this.state.selectedMarketPickerAsset==y,K=!!this.state.selectedMarketPickerAsset&&this.state.selectedMarketPickerAsset==b,Q=[{key:"depth_chart",label:v.a.translate("exchange.order_depth")},{key:"price_chart",label:v.a.translate("exchange.price_history")}];return r.a.createElement("div",{className:"grid-block shrink no-padding overflow-visible top-bar container-menu-header"},r.a.createElement("div",{className:"grid-block overflow-visible"},r.a.createElement("div",{className:"grid-block shrink"},r.a.createElement("div",{className:"change-pair",style:{padding:"5px"}},i?r.a.createElement("a",{className:"market-symbol"},r.a.createElement("span",null,y+" : "+b)):r.a.createElement("div",{className:"pair-switcher-block",style:{padding:"0 5px",fontSize:"18px",marginTop:"1px"}},r.a.createElement(_.b,{onClick:function(){e._addMarket(e.props.quoteAsset.get("symbol"),e.props.baseAsset.get("symbol"))},"data-intro":J.translate("walkthrough.favourite_button")},r.a.createElement(U.a,{className:E,name:"fi-star",title:"icons.fi_star.market"})),r.a.createElement("span",{onClick:this.marketPicker.bind(this,y),style:{cursor:"pointer",color:G?"#2196f3":""}},r.a.createElement(x.a,{name:y,replace:!0,noTip:!0})),r.a.createElement(_.b,{onClick:function(){g.a.switchMarket()},to:"/market/"+b+"_"+y,"data-intro":J.translate("walkthrough.switch_button")},r.a.createElement(U.a,{className:"shuffle",name:"shuffle",title:"icons.shuffle"})),r.a.createElement("span",{onClick:this.marketPicker.bind(this,b),style:{cursor:"pointer",color:K?"#2196f3":""}},r.a.createElement(x.a,{name:b,replace:!0,noTip:!0}))))),r.a.createElement("div",{className:"grid-block vertical",style:{overflow:"visible"}},r.a.createElement("div",{className:"grid-block wrap market-stats-container"},r.a.createElement("ul",{className:"market-stats stats top-stats"},m?r.a.createElement($t,{ignoreColorChange:!0,ready:p,price:m.full,quote:n,base:s,market:k,content:"exchange.latest"}):null,r.a.createElement("li",{className:"hide-order-1 stressed-stat daily_change "+C},r.a.createElement("span",null,r.a.createElement("b",{className:"value"},p?N:0),r.a.createElement("span",null," %")),r.a.createElement(S.a,{component:"div",className:"stat-text",content:"account.hour_24"})),A>=0?r.a.createElement($t,{ignoreColorChange:!0,onClick:this.changeVolumeBase.bind(this),ready:p,decimals:0,volume:!0,price:P,className:"hide-order-2 clickable",base:T,market:k,content:"exchange.volume_24"}):null,!i&&l?r.a.createElement($t,{ignoreColorChange:!0,toolTip:v.a.translate("tooltip.feed_price"),ready:p,className:"hide-order-3",price:l.toReal(),quote:n,base:s,market:k,content:"exchange.feed_price"}):null,!i&&l?r.a.createElement($t,{ignoreColorChange:!0,toolTip:v.a.translate("tooltip.settle_price"),ready:p,className:"hide-order-4",price:R,quote:n,base:s,market:k,content:"exchange.settle"}):null,j?r.a.createElement(ia,{object:M,account:f}):null,u&&c?r.a.createElement($t,{toolTip:v.a.translate("tooltip.call_limit"),ready:p,className:"hide-order-5 is-call",price:u,quote:n,base:s,market:k,content:"explorer.block.call_limit"}):null,l&&c?r.a.createElement($t,{toolTip:v.a.translate("tooltip.margin_price"),ready:p,className:"hide-order-6 is-call",price:l.getSqueezePrice({real:!0}),quote:n,base:s,market:k,content:"exchange.squeeze"}):null),r.a.createElement("ul",{className:"market-stats stats top-stats"},r.a.createElement("li",{className:"stressed-stat input clickable",style:{padding:"16px"},onClick:function(){wt.a.publish("chart_options","open")}},r.a.createElement(S.a,{content:"exchange.chart_modal"})))))),r.a.createElement(Ct.a,{id:"chart_options",overlay:!0,modalHeader:"exchange.chart_modal",noLogo:!0},r.a.createElement("section",{className:"block-list no-border-bottom"},r.a.createElement("header",null,r.a.createElement(S.a,{content:"exchange.chart_type"}),":"),r.a.createElement("ul",null,r.a.createElement("li",{className:"with-dropdown"},r.a.createElement(la.a,{options:Q,selected:Q.find(function(e){return e.key===(h?"depth_chart":"price_chart")}),onChange:function(t){e.props.onToggleCharts()}})))),r.a.createElement("section",{className:"block-list no-border-bottom"},r.a.createElement("header",null,r.a.createElement(S.a,{content:"exchange.chart_height"}),":"),r.a.createElement("label",null,r.a.createElement("span",{className:"inline-label"},r.a.createElement("input",{onKeyDown:function(t){13===t.keyCode&&e.setChartHeight()},type:"number",value:this.state.chartHeight,onChange:function(t){return e.setState({chartHeight:t.target.value})}}),r.a.createElement("button",{className:"btn large inverted no-margin",onClick:this.setChartHeight},"Set"))))))}}]),t}(),pa=a(19),ma=a(51),da=a(276),ha=a.n(da),fa=a(377),ba=a(106),ga=a.n(ba),_a=a(37),ya=a(23),va=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ka=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Ea=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function wa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ca=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),document.querySelector("#content > div")&&document.querySelector("#content > div").classList.add("exchange-layout");var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a._createAccountLink=null,a.EXPIRATIONS={HOUR:{title:"1 hour",get:function(){return He()().add(1,"hour").valueOf()}},"12HOURS":{title:"12 hours",get:function(){return He()().add(12,"hour").valueOf()}},"24HOURS":{title:"24 hours",get:function(){return He()().add(1,"day").valueOf()}},"7DAYS":{title:"7 days",get:function(){return He()().add(7,"day").valueOf()}},MONTH:{title:"30 days",get:function(){return He()().add(30,"day").valueOf()}},YEAR:{title:"1 year",get:function(){return He()().add(1,"year").valueOf()}},SPECIFIC:{title:"Specific",get:function(e){return a.state.expirationCustomTime[e].valueOf()}}},a._checkMarketFee=function(e){a.setState({isMarketFee:e})},a.state=ka({},a._initialState(e),{expirationType:{bid:e.exchange.getIn(["lastExpiration","bid"])||"YEAR",ask:e.exchange.getIn(["lastExpiration","ask"])||"YEAR"},expirationCustomTime:{bid:He()().add(1,"day"),ask:He()().add(1,"day")},isBridgeModalVisible:!1,isMarketFee:!1,isMarketPage:!0}),a._getWindowSize=Object(h.a)(a._getWindowSize.bind(a),150),a._checkFeeStatus=a._checkFeeStatus.bind(a),a._handleExpirationChange=a._handleExpirationChange.bind(a),a._handleCustomExpirationChange=a._handleCustomExpirationChange.bind(a),a.onShowModal=a.onShowModal.bind(a),a.psInit=!0,a._toggleSwitch=a._toggleSwitch.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Ea(t,[{key:"onShowModal",value:function(){var e=this;e.isUnauthorizedUser()||(e.props.lockedWalletState?Tt.a.isLocked()?_a.a.unlock().then(function(){ya.a.tryToSetCurrentAccount(),e.setState({isBridgeModalVisible:!0})}).catch(function(){}):_a.a.lock():this.setState({isBridgeModalVisible:!1},function(){e.setState({isBridgeModalVisible:!0})}))}},{key:"isUnauthorizedUser",value:function(e){return(void 0===e||0!==e.indexOf("/market/"))&&(!(this.props.currentAccount&&!this._createAccountLink)&&(this.props.router.push("/create-account/wallet"),!0))}},{key:"_onNavigate",value:function(e,t){t.preventDefault(),"/"!==e&&"/settings/general"!==e&&this.isUnauthorizedUser(e)||("/accounts"==e&&L.a.changeViewSetting({dashboardEntry:"accounts"}),this.context.router.push(e))}},{key:"_handleExpirationChange",value:function(e,t){var a=ka({},this.state.expirationType,wa({},e,t.target.value));"SPECIFIC"!==t.target.value&&L.a.setExchangeLastExpiration(ka({},this.props.exchange.has("lastExpiration")&&this.props.exchange.get("lastExpiration").toJS()||{},wa({},e,t.target.value))),this.setState({expirationType:a})}},{key:"_handleCustomExpirationChange",value:function(e,t){var a=ka({},this.state.expirationCustomTime,wa({},e,t));this.setState({expirationCustomTime:a})}},{key:"_initialState",value:function(e){var t=e.viewSettings,a={forSaleText:"",toReceiveText:"",priceText:"",for_sale:new H.a({asset_id:e.baseAsset.get("id"),precision:e.baseAsset.get("precision")}),to_receive:new H.a({asset_id:e.quoteAsset.get("id"),precision:e.quoteAsset.get("precision")})};a.price=new H.f({base:a.for_sale,quote:a.to_receive});var n={forSaleText:"",toReceiveText:"",priceText:"",for_sale:new H.a({asset_id:e.quoteAsset.get("id"),precision:e.quoteAsset.get("precision")}),to_receive:new H.a({asset_id:e.baseAsset.get("id"),precision:e.baseAsset.get("precision")})};return n.price=new H.f({base:n.for_sale,quote:n.to_receive}),{history:[],buySellOpen:t.get("buySellOpen",!0),bid:a,ask:n,flipBuySell:t.get("flipBuySell",!1),favorite:!1,showDepthChart:t.get("showDepthChart",!1),leftOrderBook:t.get("leftOrderBook",!1),buyDiff:!1,sellDiff:!1,buySellTop:t.get("buySellTop",!0),buyFeeAssetIdx:t.get("buyFeeAssetIdx",0),sellFeeAssetIdx:t.get("sellFeeAssetIdx",0),feeStatus:{},height:window.innerHeight,width:window.innerWidth,chartHeight:t.get("chartHeight",400),currentPeriod:t.get("currentPeriod",7776e3)}}},{key:"_getLastMarketKey",value:function(){var e=pa.Apis.instance().chain_id;return"lastMarket"+(e?"_"+e.substr(0,8):"")}},{key:"componentWillMount",value:function(){this._checkFeeStatus()}},{key:"componentDidMount",value:function(){L.a.changeViewSetting.defer(wa({},this._getLastMarketKey(),this.props.quoteAsset.get("symbol")+"_"+this.props.baseAsset.get("symbol"))),window.addEventListener("resize",this._getWindowSize,{capture:!1,passive:!0}),this._toggleSwitch()}},{key:"shouldComponentUpdate",value:function(e){return!(!e.marketReady&&!this.props.marketReady)}},{key:"_checkFeeStatus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[this.props.coreAsset,this.props.baseAsset,this.props.quoteAsset],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.currentAccount,n={},r=[];t.forEach(function(e){r.push(Object(ma.b)({accountID:a.get("id"),feeID:e.get("id"),type:"limit_order_create"}))}),Promise.all(r).then(function(a){t.forEach(function(e,t){n[e.get("id")]=a[t]}),w.a.are_equal_shallow(e.state.feeStatus,n)||e.setState({feeStatus:n})}).catch(function(t){console.log("checkFeeStatusAsync error",t),e.setState({feeStatus:{}})})}},{key:"_getWindowSize",value:function(){var e=window,t=e.innerHeight,a=e.innerWidth;if(t!==this.state.height||a!==this.state.width){this.setState({height:t,width:a});var n=this.refs.center;n&&E.a.update(n)}}},{key:"componentDidUpdate",value:function(e,t){if(this._initPsContainer(),!this.props.exchange.get("tutorialShown")&&e.coreAsset&&t.feeStatus&&!this.tutorialShown){this.tutorialShown=!0;var a=this.props.settings.get("themes");ha.a.introJs().setOptions({tooltipClass:a,highlightClass:a,showBullets:!1,hideNext:!0,hidePrev:!0,nextLabel:v.a.translate("walkthrough.next_label"),prevLabel:v.a.translate("walkthrough.prev_label"),skipLabel:v.a.translate("walkthrough.skip_label"),doneLabel:v.a.translate("walkthrough.done_label")}).start(),L.a.setExchangeTutorialShown.defer(!0)}this._toggleSwitch()}},{key:"_initPsContainer",value:function(){if(this.refs.center&&this.psInit){var e=this.refs.center;e&&(E.a.initialize(e),this.psInit=!1)}}},{key:"componentWillReceiveProps",value:function(e){if(this._initPsContainer(),e.quoteAsset===this.props.quoteAsset&&e.baseAsset===this.props.baseAsset&&e.currentAccount===this.props.currentAccount||this._checkFeeStatus([e.coreAsset,e.baseAsset,e.quoteAsset],e.currentAccount),e.quoteAsset.get("symbol")!==this.props.quoteAsset.get("symbol")||e.baseAsset.get("symbol")!==this.props.baseAsset.get("symbol"))return this.setState(this._initialState(e)),L.a.changeViewSetting(wa({},this._getLastMarketKey(),e.quoteAsset.get("symbol")+"_"+e.baseAsset.get("symbol")));this._toggleSwitch()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._getWindowSize)}},{key:"_getFeeAssets",value:function(e,t,a){var n=this,r=this.props.currentAccount,s=this.state.feeStatus;function o(e,t){-1===e.indexOf(t)&&e.push(t)}var i=[a,e===a?t:e];o(i,e),o(i,t);var l=[a,t===a?e:t];o(l,e),o(l,t);var c={};function u(e,t,n){var r=void 0;return(e=e.filter(function(e){return!!t[e.get("id")]&&(a=e.get("id"),s[a]&&s[a].hasPoolBalance&&function(e){return s[e]&&s[e].hasBalance}(e.get("id")));var a})).length?r=e[Math.min(e.length-1,n)]:(r=a,e.push(a)),{assets:e,asset:r}}r.get("balances",[]).filter(function(a,n){return["1.3.0",e.get("id"),t.get("id")].indexOf(n)>=0}).forEach(function(e,t){var a=W.b.getObject(e);c[t]={balance:a?parseInt(a.get("balance"),10):0,fee:n._getFee(W.b.getAsset(t))}});var p=u(i,c,this.state.sellFeeAssetIdx),m=p.assets,d=p.asset,h=u(l,c,this.state.buyFeeAssetIdx),f=h.assets,b=h.asset;return{sellFeeAsset:d,sellFeeAssets:m,sellFee:this._getFee(d),buyFeeAsset:b,buyFeeAssets:f,buyFee:this._getFee(b)}}},{key:"_getFee",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.coreAsset;return this.state.feeStatus[e.get("id")]&&this.state.feeStatus[e.get("id")].fee}},{key:"_verifyFee",value:function(e,t,a,n){var r=this._getFee();return"1.3.0"===e.asset_id?r.getAmount()<=n?"1.3.0":null:(t.asset_id===e.asset_id?e.getAmount()+t.getAmount():t.getAmount())<=a?e.asset_id:r.getAmount()<=n&&"1.3.0"!==e.asset_id?"1.3.0":null}},{key:"_createLimitOrderConfirm",value:function(e,t,a,n,r,s){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];arguments[7].preventDefault();var i=this.props.marketData,l=i.highestBid,c=i.lowestAsk,u=this.state["sell"===s?"ask":"bid"];a=u.for_sale.clone(a?parseInt(W.b.getObject(a).toJS().balance,10):0),n=new H.a({amount:n?parseInt(W.b.getObject(n).toJS().balance,10):0});var p=this._getFee(r),m=this._verifyFee(p,u.for_sale,a.getAmount(),n.getAmount());if(!m)return Lt.a.addNotification({message:"Insufficient funds to pay fees",level:"error"});if("buy"===s&&c){var d=this.state.bid.price.toReal()/c.getPrice();if(d>1.2)return this.refs.buy.show(),this.setState({buyDiff:d})}else if("sell"===s&&l){var h=1/(this.state.ask.price.toReal()/l.getPrice());if(h>1.2)return this.refs.sell.show(),this.setState({sellDiff:h})}var f=t.getIn(["bitasset","is_prediction_market"]);return u.for_sale.gt(a)&&!f?Lt.a.addNotification({message:"Insufficient funds to place order, you need at least "+u.for_sale.getAmount({real:!0})+" "+t.get("symbol"),level:"error"}):u.for_sale.getAmount()>0&&u.to_receive.getAmount()>0?"sell"===s&&f&&o?this._createPredictionShort(m):void this._createLimitOrder(s,m):Lt.a.addNotification({message:"Please enter a valid amount and price",level:"error"})}},{key:"_createLimitOrder",value:function(e,t){var a="sell"===e?"ask":"bid",n=this.state[a],r=null;r="SPECIFIC"===this.state.expirationType[a]?this.EXPIRATIONS[this.state.expirationType[a]].get(a):this.EXPIRATIONS[this.state.expirationType[a]].get();var s=new H.e({for_sale:n.for_sale,expiration:new Date(r||!1),to_receive:n.to_receive,seller:this.props.currentAccount.get("id"),fee:{asset_id:t,amount:0}}),o=Q.a.getMarketName(this.props.baseAsset,this.props.quoteAsset),i=o.marketName,l=o.first,c=this.props.marketDirections.get(i);if(c&&l.get("id")!==this.props.baseAsset.get("id")||!c&&l.get("id")!==this.props.baseAsset.get("id")){var u={};u[i]=!c,L.a.changeMarketDirection(u)}return console.log("order:",JSON.stringify(s.toObject())),g.a.createLimitOrder2(s).then(function(e){e.error&&"wallet locked"!==e.error.message&&Lt.a.addNotification({message:"Unknown error. Failed to place order for "+n.to_receive.getAmount({real:!0})+" "+n.to_receive.asset_id,level:"error"})}).catch(function(e){console.log("order failed:",e)})}},{key:"_createPredictionShort",value:function(e){var t=this.state.ask,a=new H.e({for_sale:t.for_sale,to_receive:t.to_receive,seller:this.props.currentAccount.get("id"),fee:{asset_id:e,amount:0}});Promise.all([Object(W.f)("getAsset",this.props.quoteAsset.getIn(["bitasset","options","short_backing_asset"]))]).then(function(e){var t=va(e,1)[0],n=new H.a({amount:a.amount_for_sale.getAmount(),asset_id:t.get("id"),precision:t.get("precision")});g.a.createPredictionShort(a,n).then(function(e){e.error&&"wallet locked"!==e.error.message&&Lt.a.addNotification({message:"Unknown error. Failed to place order for "+buyAssetAmount+" "+buyAsset.symbol,level:"error"})})})}},{key:"_forceBuy",value:function(e,t,a,n){var r=this.state["sell"===e?"ask":"bid"];a=r.for_sale.clone(a?parseInt(W.b.getObject(a).get("balance"),10):0),n=new H.a({amount:n?parseInt(W.b.getObject(n).toJS().balance,10):0});var s=this._getFee(t),o=this._verifyFee(s,r.for_sale,a.getAmount(),n.getAmount());o?this._createLimitOrder(e,o):console.error("Unable to pay fees, aborting limit order creation")}},{key:"_forceSell",value:function(e,t,a,n){var r=this.state["sell"===e?"ask":"bid"];a=r.for_sale.clone(a?parseInt(W.b.getObject(a).get("balance"),10):0),n=new H.a({amount:n?parseInt(W.b.getObject(n).toJS().balance,10):0});var s=this._getFee(t),o=this._verifyFee(s,r.for_sale,a.getAmount(),n.getAmount());o?this._createLimitOrder(e,o):console.error("Unable to pay fees, aborting limit order creation")}},{key:"_cancelLimitOrder",value:function(e,t){t.preventDefault();var a=this.props.currentAccount;g.a.cancelLimitOrder(a.get("id"),e)}},{key:"_changeZoomPeriod",value:function(e,t){t.preventDefault(),e!==this.state.currentPeriod&&(this.setState({currentPeriod:e}),L.a.changeViewSetting({currentPeriod:e}))}},{key:"_depthChartClick",value:function(e,t,a){a.preventDefault();var n=this.state,r=n.bid,s=n.ask;r.price=new H.f({base:this.state.bid.for_sale,quote:this.state.bid.to_receive,real:a.xAxis[0].value}),r.priceText=r.price.toReal(),s.price=new H.f({base:this.state.ask.to_receive,quote:this.state.ask.for_sale,real:a.xAxis[0].value}),s.priceText=s.price.toReal();var o={bid:r,ask:s,depthLine:r.price.toReal()};this._setForSale(r,!0)||this._setReceive(r,!0),this._setReceive(s)||this._setForSale(s),this._setPriceText(r,!0),this._setPriceText(s,!1),this.setState(o)}},{key:"_flipBuySell",value:function(){this.setState({flipBuySell:!this.state.flipBuySell}),L.a.changeViewSetting({flipBuySell:!this.state.flipBuySell})}},{key:"_toggleOpenBuySell",value:function(){L.a.changeViewSetting({buySellOpen:!this.state.buySellOpen}),this.setState({buySellOpen:!this.state.buySellOpen})}},{key:"_toggleCharts",value:function(){L.a.changeViewSetting({showDepthChart:!this.state.showDepthChart}),this.setState({showDepthChart:!this.state.showDepthChart})}},{key:"_toggleMarketPicker",value:function(e){var t=!!e;this.setState({showMarketPicker:t,marketPickerAsset:e})}},{key:"resetHeaderMargin",value:function(){try{document.getElementsByClassName("container-menu-header")[0].style.marginLeft=0}catch(e){}}},{key:"_moveOrderBook",value:function(){document.fastLoader.show();var e=this;document.delayedExecution.add("_moveOrderBook",function(){e.state.leftOrderBook&&e.resetHeaderMargin(),L.a.changeViewSetting({leftOrderBook:!e.state.leftOrderBook}),e.setState({leftOrderBook:!e.state.leftOrderBook})},100)}},{key:"_currentPriceClick",value:function(e,t){var a="bid"===e,n=this.state[e];n.price=t[a?"invert":"clone"](),n.priceText=n.price.toReal(),a?this._setForSale(n,a)||this._setReceive(n,a):this._setReceive(n,a)||this._setForSale(n,a),this.forceUpdate()}},{key:"_orderbookClick",value:function(e){var t=e.isBid(),a=e.totalToReceive({noCache:!0}),n=a.times(e.sellPrice()),r=new H.f({base:t?n:a,quote:t?a:n}),s=this.state[t?"bid":"ask"];s.price=r,s.priceText=r.toReal();var o=wa({},t?"ask":"bid",{for_sale:a,forSaleText:a.getAmount({real:!0}),to_receive:n,toReceiveText:n.getAmount({real:!0}),price:r,priceText:r.toReal()});t?this._setForSale(s,t)||this._setReceive(s,t):this._setReceive(s,t)||this._setForSale(s,t),this.setState(o)}},{key:"_borrowQuote",value:function(){this.refs.borrowQuote.show()}},{key:"_borrowBase",value:function(){this.refs.borrowBase.show()}},{key:"_getSettlementInfo",value:function(){var e=this.props,t=e.lowestCallPrice,a=e.feedPrice,n=e.quoteAsset,r=!1;return a&&(r=a.inverted?t<=a.toReal():t>=a.toReal()),!(!r||!t||n.getIn(["bitasset","is_prediction_market"]))}},{key:"onChangeFeeAsset",value:function(e,t){t.preventDefault(),"buy"===e?(this.setState({buyFeeAssetIdx:t.target.value}),L.a.changeViewSetting({buyFeeAssetIdx:t.target.value})):(this.setState({sellFeeAssetIdx:t.target.value}),L.a.changeViewSetting({sellFeeAssetIdx:t.target.value}))}},{key:"onChangeChartHeight",value:function(e){var t=e.value,a=e.increase,n=t||this.state.chartHeight+(a?20:-20);this.setState({chartHeight:n}),L.a.changeViewSetting({chartHeight:n})}},{key:"_toggleBuySellPosition",value:function(){this.setState({buySellTop:!this.state.buySellTop}),L.a.changeViewSetting({buySellTop:!this.state.buySellTop})}},{key:"_setReceive",value:function(e,t){return!(!e.price.isValid()||!e.for_sale.hasAmount())&&(e.to_receive=e.for_sale.times(e.price),e.toReceiveText=e.to_receive.getAmount({real:!0}).toString(),!0)}},{key:"_setForSale",value:function(e,t){return!(!e.price.isValid()||!e.to_receive.hasAmount())&&(e.for_sale=e.to_receive.times(e.price,!0),e.forSaleText=e.for_sale.getAmount({real:!0}).toString(),!0)}},{key:"_setPrice",value:function(e){return!(!e.for_sale.hasAmount()||!e.to_receive.hasAmount())&&(e.price=new H.f({base:e.for_sale,quote:e.to_receive}),e.priceText=e.price.toReal().toString(),!0)}},{key:"_setPriceText",value:function(e,t){var a=e[t?"for_sale":"to_receive"],n=e[t?"to_receive":"for_sale"];a.hasAmount()&&n.hasAmount()&&(e.priceText=new H.f({base:a,quote:n}).toReal().toString())}},{key:"_onInputPrice",value:function(e,t){var a=this.state[e],n="bid"===e;a.price=new H.f({base:a[n?"for_sale":"to_receive"],quote:a[n?"to_receive":"for_sale"],real:parseFloat(t.target.value)||0}),n?this._setForSale(a,n)||this._setReceive(a,n):this._setReceive(a,n)||this._setForSale(a,n),a.priceText=t.target.value,this.forceUpdate()}},{key:"_onInputSell",value:function(e,t,a){var n=this.state[e];n.for_sale.setAmount({real:parseFloat(a.target.value)||0}),n.price.isValid()?this._setReceive(n,t):this._setPrice(n),n.forSaleText=a.target.value,this._setPriceText(n,"bid"===e),this.forceUpdate()}},{key:"_onInputReceive",value:function(e,t,a){var n=this.state[e];n.to_receive.setAmount({real:parseFloat(a.target.value)||0}),n.price.isValid()?this._setForSale(n,t):this._setPrice(n),n.toReceiveText=a.target.value,this._setPriceText(n,"bid"===e),this.forceUpdate()}},{key:"isMarketFrozen",value:function(){var e=this.props,t=e.baseAsset,a=e.quoteAsset,n=t.getIn(["options","whitelist_markets"]).toJS(),r=a.getIn(["options","whitelist_markets"]).toJS(),s=t.getIn(["options","blacklist_markets"]).toJS(),o=a.getIn(["options","blacklist_markets"]).toJS();return r.length&&-1===r.indexOf(t.get("id"))?{isFrozen:!0,frozenAsset:a.get("symbol")}:n.length&&-1===n.indexOf(a.get("id"))?{isFrozen:!0,frozenAsset:t.get("symbol")}:o.length&&-1!==o.indexOf(t.get("id"))?{isFrozen:!0,frozenAsset:a.get("symbol")}:s.length&&-1!==s.indexOf(a.get("id"))?{isFrozen:!0,frozenAsset:t.get("symbol")}:{isFrozen:!1}}},{key:"_toggleMiniChart",value:function(){L.a.changeViewSetting({miniDepthChart:!this.props.miniDepthChart})}},{key:"_toggleSwitch",value:function(){var e=document.querySelector(".grid-block.no-overflow.wrap.shrink");e&&(this.state.buySellTop?e.classList.remove("switch"):e.classList.add("switch"))}},{key:"render",value:function(){var e=this.props,t=e.currentAccount,a=e.marketLimitOrders,n=e.marketCallOrders,s=e.marketData,i=e.activeMarketHistory,l=e.invertedCalls,c=e.starredMarkets,u=e.quoteAsset,p=e.baseAsset,m=e.lowestCallPrice,d=e.marketStats,h=e.marketReady,f=e.marketSettleOrders,b=e.bucketSize,g=e.totals,_=e.feedPrice,y=e.buckets,v=e.coreAsset,k=s.combinedBids,E=s.combinedAsks,w=s.lowestAsk,C=s.highestBid,x=s.flatBids,A=s.flatAsks,O=s.flatCalls,N=s.flatSettles,P=this.state,T=P.bid,j=P.ask,q=P.leftOrderBook,I=P.showDepthChart,F=P.chartHeight,B=P.buyDiff,M=P.sellDiff,R=P.width,L=P.buySellTop,D=P.isMarketFee,W=this.isMarketFrozen(),H=W.isFrozen,V=W.frozenAsset,J=null,G=null,K=null,Y=null,X=null,Z=null,$=void 0,ee=void 0,te=!1,ae=void 0,ne=void 0,re=this.props.viewSettings.get("showVolumeChart",!0);this.props.viewSettings.get("enableChartClamp",!0);if(u.size&&p.size&&t.size){if(G=u,ee=(J=p).get("symbol"),$=G.get("symbol"),K=t.get("balances").toJS())for(var se in K)se===G.get("id")&&(Y=K[se]),se===J.get("id")&&(X=K[se]),"1.3.0"===se&&(Z=K[se]);te=this._getSettlementInfo()}var oe=!!u.get("bitasset_data_id"),ie=!!p.get("bitasset_data_id"),le=w&&C?w.getPrice()-C.getPrice():0;if(i.size){var ce=i.take(3),ue=ce.first(),pe=ce.last(),me=void 0,he=void 0,fe=!1;ue.pays.asset_id===J.get("id")?(me=J,he=G,fe=!0):(me=G,he=J);var be=J.get("id").split(".")[2]>G.get("id").split(".")[2];if(ae=Q.a.parse_order_history(ue,me,he,fe,be),fe=!1,pe){pe.pays.asset_id===J.get("id")?(me=J,he=G,fe=!0):(me=G,he=J);var ge=Q.a.parse_order_history(pe,me,he,fe,be);ne=ae.full===ge.full?"":ae.full-ge.full>0?"change-up":"change-down"}}if(!v||!Object.keys(this.state.feeStatus).length)return null;var _e=this._getFeeAssets(G,J,v),ye=_e.sellFeeAsset,ve=_e.sellFeeAssets,ke=_e.sellFee,we=_e.buyFeeAsset,Ce=_e.buyFeeAssets,Se=_e.buyFee,xe=J.getIn(["bitasset","is_prediction_market"])||G.getIn(["bitasset","is_prediction_market"]),Ae=null;xe&&(Ae=u.getIn(["options","description"]),Ae=De.a.parseDescription(Ae).main);var Oe=!1;R<1e3&&(Oe=!0,q=!1);var Ne=q?2:1,Pe=(Math.max(this.state.height>1100?F:F-125,300),this.state.expirationType),Te=this.state.expirationCustomTime,je=0===o.a.getMyAccounts().length?r.a.createElement(ga.a.Button,{title:"",setActiveState:function(){}},r.a.createElement("a",{className:"button create-account",onClick:this._onNavigate.bind(this,"/create-account"),style:{padding:"1rem",border:"none"}},r.a.createElement(U.a,{className:"icon-14px",name:"user",title:"icons.user.create_account"})," ",r.a.createElement(S.a,{content:"header.create_account"}))):null;this._createAccountLink=je;var Fe=H?null:r.a.createElement(Ke,{onShowModal:this.onShowModal,onBorrow:ie?this._borrowBase.bind(this):null,currentAccount:t,backedCoin:this.props.backedCoins.find(function(e){return e.symbol===J.get("symbol")}),currentBridges:this.props.bridgeCoins.get(J.get("symbol"))||null,smallScreen:Oe,isOpen:this.state.buySellOpen,onToggleOpen:this._toggleOpenBuySell.bind(this),className:z()("small-12 no-padding",q||Oe?"medium-6":"medium-6 xlarge-4",this.state.flipBuySell?"order-"+(L?2:5*Ne)+" sell-form":"order-"+(L?1:4*Ne)+" buy-form"),type:"bid",expirationType:Pe.bid,expirations:this.EXPIRATIONS,expirationCustomTime:Te.bid,onExpirationTypeChange:this._handleExpirationChange.bind(this,"bid"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"bid"),amount:T.toReceiveText,price:T.priceText,total:T.forSaleText,quote:G,base:J,amountChange:this._onInputReceive.bind(this,"bid",!0),priceChange:this._onInputPrice.bind(this,"bid"),setPrice:this._currentPriceClick.bind(this),totalChange:this._onInputSell.bind(this,"bid",!1),balance:X,balanceId:J.get("id"),onSubmit:this._createLimitOrderConfirm.bind(this,G,J,X,Z,we,"buy"),balancePrecision:J.get("precision"),quotePrecision:G.get("precision"),totalPrecision:J.get("precision"),currentPrice:w.getPrice(),currentPriceObject:w,account:t.get("name"),fee:Se,hasFeeBalance:this.state.feeStatus[Se.asset_id].hasBalance,feeAssets:Ce,feeAsset:we,onChangeFeeAsset:this.onChangeFeeAsset.bind(this,"buy"),isPredictionMarket:J.getIn(["bitasset","is_prediction_market"]),onFlip:this.state._flipBuySell?null:this._flipBuySell.bind(this),onTogglePosition:this.state._toggleBuySellPosition?null:this._toggleBuySellPosition.bind(this),checkMarketFee:this._checkMarketFee.bind(this)}),Be=H?null:r.a.createElement(Ke,{onShowModal:this.onShowModal,onBorrow:oe?this._borrowQuote.bind(this):null,currentAccount:t,backedCoin:this.props.backedCoins.find(function(e){return e.symbol===G.get("symbol")}),currentBridges:this.props.bridgeCoins.get(G.get("symbol"))||null,smallScreen:Oe,isOpen:this.state.buySellOpen,onToggleOpen:this._toggleOpenBuySell.bind(this),className:z()("small-12 no-padding",q||Oe?"medium-6":"medium-6 xlarge-4",this.state.flipBuySell?"order-"+(L?1:4*Ne)+" buy-form":"order-"+(L?2:5*Ne)+" sell-form"),type:"ask",amount:j.forSaleText,price:j.priceText,total:j.toReceiveText,quote:G,base:J,expirationType:Pe.ask,expirations:this.EXPIRATIONS,expirationCustomTime:Te.ask,onExpirationTypeChange:this._handleExpirationChange.bind(this,"ask"),onExpirationCustomChange:this._handleCustomExpirationChange.bind(this,"ask"),amountChange:this._onInputSell.bind(this,"ask",!1),priceChange:this._onInputPrice.bind(this,"ask"),setPrice:this._currentPriceClick.bind(this),totalChange:this._onInputReceive.bind(this,"ask",!0),balance:Y,balanceId:G.get("id"),onSubmit:this._createLimitOrderConfirm.bind(this,J,G,Y,Z,ye,"sell"),balancePrecision:G.get("precision"),quotePrecision:G.get("precision"),totalPrecision:J.get("precision"),currentPrice:C.getPrice(),currentPriceObject:C,account:t.get("name"),fee:ke,hasFeeBalance:this.state.feeStatus[ke.asset_id].hasBalance,feeAssets:ve,feeAsset:ye,onChangeFeeAsset:this.onChangeFeeAsset.bind(this,"sell"),isPredictionMarket:G.getIn(["bitasset","is_prediction_market"]),onFlip:this.state._flipBuySell?null:this._flipBuySell.bind(this),onTogglePosition:this.state._toggleBuySellPosition?null:this._toggleBuySellPosition.bind(this),checkMarketFee:this._checkMarketFee.bind(this)}),Me=r.a.createElement(Ee,{latest:ae,changeClass:ne,orders:a,calls:n,invertedCalls:l,combinedBids:k,combinedAsks:E,highestBid:C,lowestAsk:w,totalBids:g.bid,totalAsks:g.ask,base:J,quote:G,baseSymbol:ee,quoteSymbol:$,onClick:this._orderbookClick.bind(this),horizontal:!q,moveOrderBook:this._moveOrderBook.bind(this),flipOrderBook:!0,marketReady:h,wrapperClass:"order-"+(L?3:1)+" xlarge-order-"+(L?4:1),currentAccount:this.props.currentAccount.get("id")}),Re=r.a.createElement(qe,{className:z()(Oe||q?"":"medium-6 xlarge-4","no-padding no-overflow small-12 medium-6 order-3 xlarge-order-3 my-trades"),headerStyle:{paddingTop:0},history:i,currentAccount:t,myHistory:t.get("history"),base:J,quote:G,baseSymbol:ee,quoteSymbol:$}),Le=a.size>0&&J&&G?r.a.createElement(de,{smallScreen:this.props.smallScreen,className:z()(Oe||q?"":"medium-6 xlarge-4","open-orders small-12 medium-6 no-padding align-spaced ps-container order-6"),key:"open_orders",orders:a,settleOrders:f,currentAccount:t,base:J,quote:G,baseSymbol:ee,quoteSymbol:$,activeTab:this.props.viewSettings.get("ordersTab"),onCancel:this._cancelLimitOrder.bind(this),flipMyOrders:this.props.viewSettings.get("flipMyOrders"),feedPrice:this.props.feedPrice}):null;return r.a.createElement("div",{className:"grid-block vertical"},this.state.isBridgeModalVisible?r.a.createElement(fa.a,{account:this.props.currentAccount}):null,this.props.marketReady?null:r.a.createElement(Qe.a,null),r.a.createElement(ua,{account:this.props.currentAccount,quoteAsset:u,baseAsset:p,hasPrediction:xe,starredMarkets:c,lowestAsk:w,highestBid:C,lowestCallPrice:m,showCallLimit:te,feedPrice:_,marketReady:h,latestPrice:ae,showDepthChart:I,marketStats:d,onToggleCharts:this._toggleCharts.bind(this),onToggleMarketPicker:this._toggleMarketPicker.bind(this),showVolumeChart:re,chartHeight:F,onChangeChartHeight:this.onChangeChartHeight.bind(this)}),r.a.createElement("div",{className:"grid-block page-layout market-layout"},this.state.showMarketPicker?r.a.createElement($e,ka({marketPickerAsset:this.state.marketPickerAsset,onToggleMarketPicker:this._toggleMarketPicker.bind(this)},this.props)):null,r.a.createElement(Qt,{isMarketPage:this.state.isMarketPage}),q?r.a.createElement("div",{className:"grid-block left-column shrink no-overflow"},Me):null,r.a.createElement("div",{style:{paddingTop:0},className:z()("grid-block main-content vertical no-overflow")},r.a.createElement("div",{className:"grid-block vertical no-padding ps-container",id:"CenterContent",ref:"center"},I?r.a.createElement("div",{className:"grid-block vertical no-padding shrink"},r.a.createElement(vt,{marketReady:h,orders:a,showCallLimit:te,call_orders:n,flat_asks:A,flat_bids:x,flat_calls:te?O:[],flat_settles:this.props.settings.get("showSettles")&&N,settles:f,invertedCalls:l,totalBids:g.bid,totalAsks:g.ask,base:J,quote:G,height:this.state.height>1100?F:F-150,onClick:this._depthChartClick.bind(this,J,G),feedPrice:!xe&&_&&_.toReal(),spread:le,LCP:te?m:null,leftOrderBook:q,hasPrediction:xe,noFrame:!1,verticalOrderbook:q,theme:this.props.settings.get("themes"),centerRef:this.refs.center})):r.a.createElement("div",{className:"grid-block shrink no-overflow",id:"market-charts"},r.a.createElement(ht,{locale:this.props.locale,dataFeed:this.props.dataFeed,baseSymbol:ee,quoteSymbol:$,leftOrderBook:q,marketReady:h,theme:this.props.settings.get("themes"),buckets:y,bucketSize:b,currentPeriod:this.state.currentPeriod,chartHeight:this.state.height>1100?F:F-150,mobile:R<800})),r.a.createElement("div",{className:"grid-block no-overflow wrap shrink"},r.a.createElement("div",{className:"market-row stable-height "+(D?"is-fee":"")},xe?r.a.createElement("div",{className:"small-12 no-overflow",style:{margin:"0 10px",lineHeight:"1.2rem"}},r.a.createElement("p",null,Ae)):null,H?r.a.createElement("div",{className:"error small-12 no-overflow",style:{margin:"0 10px",lineHeight:"1.2rem"}},r.a.createElement(S.a,{content:"exchange.market_frozen",asset:V,component:"p"})):null,Fe,Be,q?null:L?Re:Le),r.a.createElement("div",{className:"market-row "+(D?"is-fee-neighbor":"")},q?null:Me,r.a.createElement(Xt,{type:"buy",ref:"buy",onForce:this._forceBuy.bind(this,"buy",we,X,Z),diff:B,hasOrders:E.length>0}),r.a.createElement(Xt,{type:"sell",ref:"sell",onForce:this._forceSell.bind(this,"sell",ye,Y,Z),diff:M,hasOrders:k.length>0}),q?Re:null,q?Le:null,q?null:L?Le:Re)))),r.a.createElement("div",{className:"grid-block shrink right-column no-overflow vertical show-for-medium",style:{paddingTop:0,minWidth:358,maxWidth:400}},r.a.createElement("div",{className:"grid-block no-padding no-margin vertical"},r.a.createElement(Ie.a,{className:"left-order-book no-padding no-overflow",headerStyle:{paddingTop:0},columns:[{name:"star",index:1},{name:"market",index:2},{name:"vol",index:3},{name:"price",index:4},{name:"change",index:5}],findColumns:[{name:"market",index:1},{name:"issuer",index:2},{name:"vol",index:3},{name:"add",index:4}],current:$+"_"+ee})),r.a.createElement("div",{className:"grid-block no-margin vertical shrink"},r.a.createElement("div",{onClick:this._toggleMiniChart.bind(this),className:"exchange-content-header clickable",style:{textAlign:"left",paddingRight:10}},this.props.miniDepthChart?r.a.createElement("span",null,"▼"):r.a.createElement("span",null,"▲")),this.props.miniDepthChart?r.a.createElement(vt,{marketReady:h,orders:a,showCallLimit:te,call_orders:n,flat_asks:A,flat_bids:x,flat_calls:te?O:[],flat_settles:this.props.settings.get("showSettles")&&N,settles:f,invertedCalls:l,totalBids:g.bid,totalAsks:g.ask,base:J,quote:G,height:200,onClick:this._depthChartClick.bind(this,J,G),settlementPrice:!xe&&_&&_.toReal(),spread:le,LCP:te?m:null,leftOrderBook:q,hasPrediction:xe,noText:!0,theme:this.props.settings.get("themes")}):null)),oe?r.a.createElement(Rt,{ref:"borrowQuote",modalId:"borrow_modal_quote_"+u.get("id"),quote_asset:u.get("id"),backing_asset:u.getIn(["bitasset","options","short_backing_asset"]),account:t}):null,ie?r.a.createElement(Rt,{ref:"borrowBase",modalId:"borrow_modal_base_"+p.get("id"),quote_asset:p.get("id"),backing_asset:p.getIn(["bitasset","options","short_backing_asset"]),account:t}):null))}}]),t}();Ca.propTypes={marketCallOrders:b.a.object.isRequired,activeMarketHistory:b.a.object.isRequired,viewSettings:b.a.object.isRequired,priceData:b.a.array.isRequired,volumeData:b.a.array.isRequired},Ca.defaultProps={marketCallOrders:[],activeMarketHistory:{},viewSettings:{},priceData:[],volumeData:[]};var Sa=Ca,xa=a(312),Aa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Oa=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function Na(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pa(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Ta(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ja=function(e){function t(){return Na(this,t),Pa(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Ta(t,r.a.Component),Oa(t,[{key:"render",value:function(){var e=this.props.params.marketID.toUpperCase().split("_");return e[0]===e[1]?r.a.createElement(xa.default,{subtitle:"market_not_found_subtitle"}):r.a.createElement(d.a,{stores:[s.a,o.a,l.a,p.a,u.a],inject:{locale:function(){return u.a.getState().currentLocale},lockedWalletState:function(){return p.a.getState().locked},marketLimitOrders:function(){return s.a.getState().marketLimitOrders},marketCallOrders:function(){return s.a.getState().marketCallOrders},invertedCalls:function(){return s.a.getState().invertedCalls},marketSettleOrders:function(){return s.a.getState().marketSettleOrders},marketData:function(){return s.a.getState().marketData},totals:function(){return s.a.getState().totals},priceData:function(){return s.a.getState().priceData},volumeData:function(){return s.a.getState().volumeData},activeMarketHistory:function(){return s.a.getState().activeMarketHistory},bucketSize:function(){return s.a.getState().bucketSize},buckets:function(){return s.a.getState().buckets},lowestCallPrice:function(){return s.a.getState().lowestCallPrice},feedPrice:function(){return s.a.getState().feedPrice},currentAccount:function(){return o.a.getState().currentAccount},myActiveAccounts:function(){return o.a.getState().myActiveAccounts},viewSettings:function(){return l.a.getState().viewSettings},settings:function(){return l.a.getState().settings},exchange:function(){return l.a.getState().exchange},starredMarkets:function(){return l.a.getState().starredMarkets},marketDirections:function(){return l.a.getState().marketDirections},marketStats:function(){return s.a.getState().marketStats},marketReady:function(){return s.a.getState().marketReady},backedCoins:function(){return c.a.getState().backedCoins.get("OPEN",[])},bridgeCoins:function(){return c.a.getState().bridgeCoins},searchAssets:function(){return i.a.getState().assets},assetsLoading:function(){return i.a.getState().assetsLoading},miniDepthChart:function(){return l.a.getState().viewSettings.get("miniDepthChart",!0)},dataFeed:function(){return new ut}}},r.a.createElement(La,{router:this.props.router,quoteAsset:e[0],baseAsset:e[1]}))}}]),t}(),qa=Object(W.e)(),Ia=void 0,Fa=void 0,Ba=void 0,Ma=void 0,Ra=void 0,La=function(e){function t(){Na(this,t);var e=Pa(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={sub:null},e._subToMarket=e._subToMarket.bind(e),e}return Ta(t,r.a.Component),Oa(t,[{key:"componentWillMount",value:function(){var e=this;null!==this.props.quoteAsset&&null!==this.props.baseAsset&&(this.props.quoteAsset.toJS&&this.props.baseAsset.toJS&&this._subToMarket(this.props),qa.on("cancel-order",Fa=g.a.cancelLimitOrderSuccess),qa.on("close-call",Ia=g.a.closeCallOrderSuccess),qa.on("call-order-update",Ba=function(t){var a=t.call_price.base.asset_id,n=t.call_price.quote.asset_id,r=e.props.baseAsset.get("id"),s=e.props.quoteAsset.get("id");a!==r&&a!==s||n!==r&&n!==s||g.a.callOrderUpdate(t)}),qa.on("bitasset-update",Ma=g.a.feedUpdate),qa.on("settle-order-update",Ra=function(t){var a=market_utils.isMarketAsset(e.props.quoteAsset,e.props.baseAsset),n=a.isMarketAsset,r=a.marketAsset;n&&r.id===t.balance.asset_id&&g.a.settleOrderUpdate(r.id)}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(null!==e.quoteAsset&&null!==e.baseAsset){if(e.baseAsset&&e.baseAsset.getIn(["bitasset","is_prediction_market"])&&this.props.router.push("/market/"+e.baseAsset.get("symbol")+"_"+e.quoteAsset.get("symbol")),e.quoteAsset&&e.baseAsset&&!this.state.sub)return this._subToMarket(e);if(e.quoteAsset.get("symbol")!==this.props.quoteAsset.get("symbol")||e.baseAsset.get("symbol")!==this.props.baseAsset.get("symbol")){var a=this.state.sub.split("_");g.a.unSubscribeMarket(a[0],a[1]).then(function(){t._subToMarket(e)})}}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.quoteAsset,a=e.baseAsset;null!==t&&null!==a&&(g.a.unSubscribeMarket(t.get("id"),a.get("id")),qa&&(qa.off("cancel-order",Fa),qa.off("close-call",Ia),qa.off("call-order-update",Ba),qa.off("bitasset-update",Ma),qa.off("settle-order-update",Ra)))}},{key:"_subToMarket",value:function(e,t){var a=e.quoteAsset,n=e.baseAsset,r=e.bucketSize;t&&(r=t),a.get("id")&&n.get("id")&&(g.a.subscribeMarket.defer(n,a,r),this.setState({sub:a.get("id")+"_"+n.get("id")}))}},{key:"render",value:function(){return null===this.props.quoteAsset||null===this.props.baseAsset?r.a.createElement(xa.default,{subtitle:"market_not_found_subtitle"}):r.a.createElement(Sa,Aa({},this.props,{sub:this.state.sub,subToMarket:this._subToMarket}))}}]),t}();La.propTypes={currentAccount:Be.a.ChainAccount.isRequired,quoteAsset:Be.a.ChainAsset.isRequired,baseAsset:Be.a.ChainAsset.isRequired,coreAsset:Be.a.ChainAsset.isRequired},La.defaultProps={currentAccount:"1.2.3",coreAsset:"1.3.0"},La=Object(Me.a)(La,{show_loader:!0});t.default=ja},831:function(e,t,a){!function(e){"use strict";function t(e,a){var r=n({},e);for(var s in a)"object"!=typeof e[s]||null===e[s]||Array.isArray(e[s])?void 0!==a[s]&&(r[s]=a[s]):r[s]=t(e[s],a[s]);return r}function a(){return"1.12 (internal id 7580da73 @ 2018-05-14 05:13:04.428607)"}var n=Object.assign||function(e){for(var t,a=arguments,n=1,r=arguments.length;n<r;n++)for(var s in t=a[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},r={mobile:{disabled_features:["left_toolbar","header_widget","timeframes_toolbar","edit_buttons_in_legend","context_menus","control_bar","border_around_the_chart"],enabled_features:[]}},s={width:800,height:500,symbol:"AA",interval:"D",timezone:"UTC",container_id:"",library_path:"",locale:"en",widgetbar:{details:!1,watchlist:!1,watchlist_settings:{default_symbols:[]}},overrides:{"mainSeriesProperties.showCountdown":!1},studies_overrides:{},brokerConfig:{configFlags:{}},fullscreen:!1,autosize:!1,disabled_features:[],enabled_features:[],debug:!1,logo:{},time_frames:[{text:"5y",resolution:"W"},{text:"1y",resolution:"W"},{text:"6m",resolution:"120"},{text:"3m",resolution:"60"},{text:"1m",resolution:"30"},{text:"5d",resolution:"5"},{text:"1d",resolution:"1"}],client_id:"0",user_id:"0",charts_storage_api_version:"1.0",favorites:{intervals:[],chartTypes:[]}},o=function(){function e(e){if(this._id="tradingview_"+(1048576*(1+Math.random())|0).toString(16).substring(1),this._ready=!1,this._readyHandlers=[],this._onWindowResize=this._autoResizeChart.bind(this),!e.datafeed)throw new Error("Datafeed is not defined");if(this._options=t(s,e),e.preset){var a=r[e.preset];a?(void 0!==this._options.disabled_features?this._options.disabled_features=this._options.disabled_features.concat(a.disabled_features):this._options.disabled_features=a.disabled_features,void 0!==this._options.enabled_features?this._options.enabled_features=this._options.enabled_features.concat(a.enabled_features):this._options.enabled_features=a.enabled_features):console.warn("Unknown preset: `"+e.preset+"`")}this._create()}return e.prototype.onChartReady=function(e){this._ready?e.call(this):this._readyHandlers.push(e)},e.prototype.onGrayedObjectClicked=function(e){this._innerAPI().onGrayedObjectClicked(e)},e.prototype.onShortcut=function(e,t){this._innerWindow().createShortcutAction(e,t)},e.prototype.subscribe=function(e,t){this._innerAPI().subscribe(e,t)},e.prototype.unsubscribe=function(e,t){this._innerAPI().unsubscribe(e,t)},e.prototype.chart=function(e){return this._innerAPI().chart(e)},e.prototype.setLanguage=function(e){this.remove(),this._options.locale=e,this._create()},e.prototype.setSymbol=function(e,t,a){this._innerAPI().changeSymbol(e,t+"",a)},e.prototype.remove=function(){window.removeEventListener("resize",this._onWindowResize),this._readyHandlers.splice(0,this._readyHandlers.length),delete window[this._id];var e=this._getIFrameElement();e.contentWindow.destroyChart(),e.parentNode&&e.parentNode.removeChild(e)},e.prototype.closePopupsAndDialogs=function(){this._innerAPI().closePopupsAndDialogs()},e.prototype.selectLineTool=function(e){this._innerAPI().selectLineTool(e)},e.prototype.selectedLineTool=function(){return this._innerAPI().selectedLineTool()},e.prototype.save=function(e){this._innerAPI().saveChart(e)},e.prototype.load=function(e,t){this._innerAPI().loadChart({json:e,extendedData:t})},e.prototype.getSavedCharts=function(e){this._innerAPI().getSavedCharts(e)},e.prototype.loadChartFromServer=function(e){this._innerAPI().loadChartFromServer(e)},e.prototype.saveChartToServer=function(e,t,a,n){this._innerAPI().saveChartToServer(e,t,a,n)},e.prototype.removeChartFromServer=function(e,t){this._innerAPI().removeChartFromServer(e,t)},e.prototype.onContextMenu=function(e){this._innerAPI().onContextMenu(e)},e.prototype.createButton=function(e){return this._innerWindow().createButton(e)},e.prototype.showNoticeDialog=function(e){this._innerAPI().showNoticeDialog(e)},e.prototype.showConfirmDialog=function(e){this._innerAPI().showConfirmDialog(e)},e.prototype.showLoadChartDialog=function(){this._innerAPI().showLoadChartDialog()},e.prototype.showSaveAsChartDialog=function(){this._innerAPI().showSaveAsChartDialog()},e.prototype.symbolInterval=function(){return this._innerAPI().getSymbolInterval()},e.prototype.mainSeriesPriceFormatter=function(){return this._innerAPI().mainSeriesPriceFormatter()},e.prototype.getIntervals=function(){return this._innerAPI().getIntervals()},e.prototype.getStudiesList=function(){return this._innerAPI().getStudiesList()},e.prototype.addCustomCSSFile=function(e){this._innerWindow().addCustomCSSFile(e)},e.prototype.applyOverrides=function(e){this._options=t(this._options,{overrides:e}),this._innerWindow().applyOverrides(e)},e.prototype.applyStudiesOverrides=function(e){this._innerWindow().applyStudiesOverrides(e)},e.prototype.watchList=function(){return this._innerAPI().watchlist()},e.prototype.activeChart=function(){return this._innerAPI().activeChart()},e.prototype.chartsCount=function(){return this._innerAPI().chartsCount()},e.prototype.layout=function(){return this._innerAPI().layout()},e.prototype.setLayout=function(e){this._innerAPI().setLayout(e)},e.prototype._getIFrameElement=function(){var e=document.getElementById(this._id);if(null===e)throw new Error("There is no such iframe");return e},e.prototype._innerAPI=function(){return this._getIFrameElement().contentWindow.tradingViewApi},e.prototype._innerWindow=function(){return this._getIFrameElement().contentWindow},e.prototype._autoResizeChart=function(){this._options.fullscreen&&(this._getIFrameElement().style.height=window.innerHeight+"px")},e.prototype._create=function(){var e=this,t=this._render(),a=document.getElementById(this._options.container_id);if(null===a)throw new Error("There is no such element - #"+this._options.container_id);a.innerHTML=t;var n=this._getIFrameElement();(this._options.autosize||this._options.fullscreen)&&(n.style.width="100%",this._options.fullscreen||(n.style.height="100%")),window.addEventListener("resize",this._onWindowResize),this._onWindowResize();var r=function(){n.removeEventListener("load",r,!1),n.contentWindow.widgetReady(function(){e._ready=!0;for(var t=0,a=e._readyHandlers;t<a.length;t++)a[t].call(e);n.contentWindow.initializationFinished()})};n.addEventListener("load",r,!1)},e.prototype._render=function(){var e=window;e[this._id]={datafeed:this._options.datafeed,customFormatters:this._options.customFormatters,brokerFactory:this._options.brokerFactory,overrides:this._options.overrides,studiesOverrides:this._options.studies_overrides,disabledFeatures:this._options.disabled_features,enabledFeatures:this._options.enabled_features,brokerConfig:this._options.brokerConfig,restConfig:this._options.restConfig,favorites:this._options.favorites,logo:this._options.logo,numeric_formatting:this._options.numeric_formatting,rss_news_feed:this._options.rss_news_feed,newsProvider:this._options.news_provider,loadLastChart:this._options.load_last_chart,saveLoadAdapter:this._options.save_load_adapter,loading_screen:this._options.loading_screen,settingsAdapter:this._options.settings_adapter},this._options.saved_data&&(e[this._id].chartContent={json:this._options.saved_data});var t=(this._options.library_path||"")+"static/tv-chart.7580da73a91e1354cb09.html#localserver=1&symbol="+encodeURIComponent(this._options.symbol)+"&interval="+encodeURIComponent(this._options.interval)+(this._options.timeframe?"&timeframe="+encodeURIComponent(this._options.timeframe):"")+(this._options.toolbar_bg?"&toolbarbg="+this._options.toolbar_bg.replace("#",""):"")+(this._options.studies_access?"&studiesAccess="+encodeURIComponent(JSON.stringify(this._options.studies_access)):"")+"&widgetbar="+encodeURIComponent(JSON.stringify(this._options.widgetbar))+(this._options.drawings_access?"&drawingsAccess="+encodeURIComponent(JSON.stringify(this._options.drawings_access)):"")+"&timeFrames="+encodeURIComponent(JSON.stringify(this._options.time_frames))+"&locale="+encodeURIComponent(this._options.locale)+"&uid="+encodeURIComponent(this._id)+"&clientId="+encodeURIComponent(String(this._options.client_id))+"&userId="+encodeURIComponent(String(this._options.user_id))+(this._options.charts_storage_url?"&chartsStorageUrl="+encodeURIComponent(this._options.charts_storage_url):"")+(this._options.charts_storage_api_version?"&chartsStorageVer="+encodeURIComponent(this._options.charts_storage_api_version):"")+(this._options.indicators_file_name?"&indicatorsFile="+encodeURIComponent(this._options.indicators_file_name):"")+(this._options.custom_css_url?"&customCSS="+encodeURIComponent(this._options.custom_css_url):"")+(this._options.auto_save_delay?"&autoSaveDelay="+encodeURIComponent(String(this._options.auto_save_delay)):"")+"&debug="+this._options.debug+(this._options.snapshot_url?"&snapshotUrl="+encodeURIComponent(this._options.snapshot_url):"")+(this._options.timezone?"&timezone="+encodeURIComponent(this._options.timezone):"")+(this._options.study_count_limit?"&studyCountLimit="+encodeURIComponent(String(this._options.study_count_limit)):"")+(this._options.symbol_search_request_delay?"&ssreqdelay="+encodeURIComponent(String(this._options.symbol_search_request_delay)):"");return'<iframe id="'+this._id+'" name="'+this._id+'"  src="'+t+'"'+(this._options.autosize||this._options.fullscreen?"":' width="'+this._options.width+'" height="'+this._options.height+'"')+' frameborder="0" allowTransparency="true" scrolling="no" allowfullscreen style="display:block;"></iframe>'},e}();window.TradingView=window.TradingView||{},window.TradingView.version=a,e.version=a,e.onready=function(e){window.addEventListener("DOMContentLoaded",e,!1)},e.widget=o,Object.defineProperty(e,"__esModule",{value:!0})}(t)}}]);